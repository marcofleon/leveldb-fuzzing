
Coverage Difference Summary
==========================

Found differences in 49 files, total of 1803 lines differ


/root/leveldb-fuzzing/leveldb-subtree/db/builder.cc:
  27 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/db_impl.cc:
  250 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/db_impl.h:
  2 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/dbformat.cc:
  27 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/dbformat.h:
  13 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/filename.cc:
  26 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/log_reader.cc:
  54 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/log_writer.cc:
  25 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/memtable.cc:
  5 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/memtable.h:
  4 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/skiplist.h:
  58 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/table_cache.cc:
  20 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/version_edit.cc:
  54 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/version_edit.h:
  7 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/version_set.cc:
  385 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/version_set.h:
  5 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/db/write_batch.cc:
  22 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/include/leveldb/iterator.h:
  3 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/include/leveldb/slice.h:
  20 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/include/leveldb/status.h:
  8 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/port/port_stdcxx.h:
  1 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/table/block.cc:
  59 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/table/block_builder.cc:
  26 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/table/filter_block.cc:
  27 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/table/format.cc:
  36 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/table/iterator.cc:
  10 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/table/iterator_wrapper.h:
  22 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/table/merger.cc:
  31 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/table/table.cc:
  54 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/table/table_builder.cc:
  67 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/table/two_level_iterator.cc:
  35 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/arena.cc:
  20 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/arena.h:
  5 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/bloom.cc:
  12 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/cache.cc:
  60 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/coding.cc:
  38 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/coding.h:
  14 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/comparator.cc:
  21 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/crc32c.cc:
  52 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/crc32c.h:
  3 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/env.cc:
  3 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/env_posix.cc:
  119 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/hash.cc:
  14 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/logging.cc:
  16 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/mutexlock.h:
  1 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/no_destructor.h:
  1 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/posix_logger.h:
  24 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/random.h:
  8 lines with coverage differences

/root/leveldb-fuzzing/leveldb-subtree/util/status.cc:
  9 lines with coverage differences

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/builder.cc ===
Lines with coverage differences:

Lines with different hit counts: 18, 22, 24, 29, 30, 31, 33, 37, 39, 41, 44, 45, 47, 48, 50, 51, 53, 56, 57, 58, 64, 66, 69, 70, 71, 72, 75

Detailed differences with context:
============================================================
    13           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"leveldb/iterator.h"[39;00m
    14           : 
    15           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
    16           : 
    17           : Status[38;5;250m [39mBuildTable([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mdbname,[38;5;250m [39mEnv[38;5;241m*[39m[38;5;250m [39menv,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mOptions[38;5;241m&[39m[38;5;250m [39moptions,
[91mâ†’   18 [1727 â†’ 1726]:[0m [91m[38;5;250m                  [39mTableCache[38;5;241m*[39m[38;5;250m [39mtable_cache,[38;5;250m [39mIterator[38;5;241m*[39m[38;5;250m [39miter,[38;5;250m [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mmeta)[38;5;250m [39m{[0m
    19           : [38;5;250m  [39mStatus[38;5;250m [39ms;
    20           : [38;5;250m  [39mmeta[38;5;241m-[39m[38;5;241m>[39mfile_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
    21           : [38;5;250m  [39miter[38;5;241m-[39m[38;5;241m>[39mSeekToFirst();
[91mâ†’   22 [1727 â†’ 1726]:[0m [91m[0m
    23           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mfname[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mTableFileName(dbname,[38;5;250m [39mmeta[38;5;241m-[39m[38;5;241m>[39mnumber);
[91mâ†’   24 [1446 â†’ 1445]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(iter[38;5;241m-[39m[38;5;241m>[39mValid())[38;5;250m [39m{[0m
    25           : [38;5;250m    [39mWritableFile[38;5;241m*[39m[38;5;250m [39mfile;
    26           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39menv[38;5;241m-[39m[38;5;241m>[39mNewWritableFile(fname,[38;5;250m [39m[38;5;241m&[39mfile);
    27           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39ms.ok())[38;5;250m [39m{
    28           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
[91mâ†’   29 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   30 [1446 â†’ 1445]:[0m [91m[0m
[91mâ†’   31 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39mTableBuilder[38;5;241m*[39m[38;5;250m [39mbuilder[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mTableBuilder(options,[38;5;250m [39mfile);[0m
    32           : [38;5;250m    [39mmeta[38;5;241m-[39m[38;5;241m>[39msmallest.DecodeFrom(iter[38;5;241m-[39m[38;5;241m>[39mkey());
[91mâ†’   33 [2049 â†’ 2029]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m(;[38;5;250m [39miter[38;5;241m-[39m[38;5;241m>[39mValid();[38;5;250m [39miter[38;5;241m-[39m[38;5;241m>[39mNext())[38;5;250m [39m{[0m
    34           : [38;5;250m      [39mSlice[38;5;250m [39mkey[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39miter[38;5;241m-[39m[38;5;241m>[39mkey();
    35           : [38;5;250m      [39mmeta[38;5;241m-[39m[38;5;241m>[39mlargest.DecodeFrom(key);
    36           : [38;5;250m      [39mbuilder[38;5;241m-[39m[38;5;241m>[39mAdd(key,[38;5;250m [39miter[38;5;241m-[39m[38;5;241m>[39mvalue());
[91mâ†’   37 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m}[0m
    38           : 
[91mâ†’   39 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Finish and check for builder errors[39;00m[0m
    40           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbuilder[38;5;241m-[39m[38;5;241m>[39mFinish();
[91mâ†’   41 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
    42           : [38;5;250m      [39mmeta[38;5;241m-[39m[38;5;241m>[39mfile_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbuilder[38;5;241m-[39m[38;5;241m>[39mFileSize();
    43           : [38;5;250m      [39massert(meta[38;5;241m-[39m[38;5;241m>[39mfile_size[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);
[91mâ†’   44 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   45 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mbuilder;[0m
    46           : 
[91mâ†’   47 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Finish and check for file errors[39;00m[0m
[91mâ†’   48 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
    49           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfile[38;5;241m-[39m[38;5;241m>[39mSync();
[91mâ†’   50 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   51 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
    52           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfile[38;5;241m-[39m[38;5;241m>[39mClose();
[91mâ†’   53 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m}[0m
    54           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mfile;
    55           : [38;5;250m    [39mfile[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’   56 [1446 â†’ 1445]:[0m [91m[0m
[91mâ†’   57 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
[91mâ†’   58 [1446 â†’ 1445]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Verify that the table is usable[39;00m[0m
    59           : [38;5;250m      [39mIterator[38;5;241m*[39m[38;5;250m [39mit[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mtable_cache[38;5;241m-[39m[38;5;241m>[39mNewIterator(ReadOptions(),[38;5;250m [39mmeta[38;5;241m-[39m[38;5;241m>[39mnumber,
    60           : [38;5;250m                                              [39mmeta[38;5;241m-[39m[38;5;241m>[39mfile_size);
    61           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mit[38;5;241m-[39m[38;5;241m>[39mstatus();
    62           : [38;5;250m      [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mit;
    63           : [38;5;250m    [39m}
[91mâ†’   64 [1727 â†’ 1726]:[0m [91m[38;5;250m  [39m}[0m
    65           : 
[91mâ†’   66 [1727 â†’ 1726]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Check for input iterator errors[39;00m[0m
    67           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39miter[38;5;241m-[39m[38;5;241m>[39mstatus().ok())[38;5;250m [39m{
    68           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39miter[38;5;241m-[39m[38;5;241m>[39mstatus();
[91mâ†’   69 [1727 â†’ 1726]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   70 [1727 â†’ 1726]:[0m [91m[0m
[91mâ†’   71 [1446 â†’ 1445]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mmeta[38;5;241m-[39m[38;5;241m>[39mfile_size[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
[91mâ†’   72 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Keep it[39;00m[0m
    73           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
    74           : [38;5;250m    [39menv[38;5;241m-[39m[38;5;241m>[39mDeleteFile(fname);
[91mâ†’   75 [1727 â†’ 1726]:[0m [91m[38;5;250m  [39m}[0m
    76           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
    77           : }
    78           : 
    79           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/db_impl.cc ===
Lines with coverage differences:

Lines with different hit counts: 157, 214, 215, 216, 220, 223, 225, 226, 228, 230, 232, 233, 235, 241, 242, 245, 246, 247, 249, 251, 254, 262, 263, 264, 266, 268, 269, 271, 273, 276, 277, 278, 282, 283, 284, 286, 348, 361, 366, 370, 371, 374, 383, 394, 396, 399, 406, 408, 409, 413, 417, 422, 428, 433, 434, 435, 436, 439, 444, 445, 447, 449, 450, 451, 461, 462, 463, 464, 467, 487, 488, 496, 497, 502, 511, 518, 526, 528, 531, 533, 536, 537, 545, 547, 549, 550, 555, 558, 560, 561, 565, 566, 567, 568, 575, 650, 652, 655, 658, 660, 661, 662, 663, 666, 667, 668, 669, 672, 675, 679, 681, 682, 683, 686, 688, 689, 693, 698, 700, 701, 704, 705, 706, 721, 723, 724, 744, 747, 749, 753, 754, 755, 756, 757, 758, 759, 762, 763, 776, 779, 785, 787, 788, 789, 792, 796, 797, 798, 799, 812, 815, 817, 822, 823, 824, 825, 826, 827, 828, 830, 831, 833, 837, 844, 845, 847, 848, 850, 853, 854, 855, 860, 865, 870, 877, 884, 888, 891, 896, 898, 899, 900, 904, 905, 908, 910, 917, 918, 929, 930, 932, 938, 940, 941, 947, 948, 949, 950, 951, 955, 956, 957, 958, 960, 961, 971, 972, 984, 985, 986, 987, 991, 992, 993, 995, 999, 1000, 1001, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1014, 1017, 1018, 1020, 1023, 1026, 1027, 1029, 1030, 1031, 1033, 1034, 1037, 1038, 1040, 1041, 1043, 1083, 1326, 1331, 1343, 1347, 1349, 1378

Detailed differences with context:
============================================================
   152           : 
   153           : DBImpl[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mDBImpl()[38;5;250m [39m{
   154           : [38;5;250m  [39m[38;5;66;03m// Wait for background work to finish.[39;00m
   155           : [38;5;250m  [39mmutex_.Lock();
   156           : [38;5;250m  [39mshutting_down_.store([38;5;28mtrue[39m,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmemory_order_release);
[91mâ†’  157 [232 â†’ 229]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(background_compaction_scheduled_)[38;5;250m [39m{[0m
   158           : [38;5;250m    [39mbackground_work_finished_signal_.Wait();
   159           : [38;5;250m  [39m}
   160           : [38;5;250m  [39mmutex_.Unlock();
   161           : 
   162           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(db_lock_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{

........................................

   209           : [38;5;250m    [39menv_[38;5;241m-[39m[38;5;241m>[39mDeleteFile(manifest);
   210           : [38;5;250m  [39m}
   211           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
   212           : }
   213           : 
[91mâ†’  214 [993 â†’ 995]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDBImpl::MaybeIgnoreError[39m(Status[38;5;241m*[39m[38;5;250m [39ms)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’  215 [993 â†’ 995]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s[38;5;241m-[39m[38;5;241m>[39mok()[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39moptions_.paranoid_checks)[38;5;250m [39m{[0m
[91mâ†’  216 [993 â†’ 995]:[0m [91m[38;5;250m    [39m[38;5;66;03m// No change needed[39;00m[0m
   217           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   218           : [38;5;250m    [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mIgnoring error %s[39m[38;5;124m"[39m,[38;5;250m [39ms[38;5;241m-[39m[38;5;241m>[39mToString().c_str());
   219           : [38;5;250m    [39m[38;5;241m*[39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
[91mâ†’  220 [993 â†’ 995]:[0m [91m[38;5;250m  [39m}[0m
   221           : }
   222           : 
[91mâ†’  223 [3177 â†’ 3171]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDBImpl::DeleteObsoleteFiles[39m()[38;5;250m [39m{[0m
   224           : [38;5;250m  [39mmutex_.AssertHeld();
[91mâ†’  225 [3177 â†’ 3171]:[0m [91m[0m
[91mâ†’  226 [ 34 â†’  30]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mbg_error_.ok())[38;5;250m [39m{[0m
   227           : [38;5;250m    [39m[38;5;66;03m// After a background error, we don't know whether a new version may[39;00m
[91mâ†’  228 [ 34 â†’  30]:[0m [91m[38;5;250m    [39m[38;5;66;03m// or may not have been committed, so we cannot safely garbage collect.[39;00m[0m
   229           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m;
[91mâ†’  230 [3143 â†’ 3141]:[0m [91m[38;5;250m  [39m}[0m
   231           : 
[91mâ†’  232 [3143 â†’ 3141]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Make a set of all of the live files[39;00m[0m
[91mâ†’  233 [3143 â†’ 3141]:[0m [91m[38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mset[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m[38;5;250m [39mlive[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mpending_outputs_;[0m
   234           : [38;5;250m  [39mversions_[38;5;241m-[39m[38;5;241m>[39mAddLiveFiles([38;5;241m&[39mlive);
[91mâ†’  235 [3143 â†’ 3141]:[0m [91m[0m
   236           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m>[39m[38;5;250m [39mfilenames;
   237           : [38;5;250m  [39menv_[38;5;241m-[39m[38;5;241m>[39mGetChildren(dbname_,[38;5;250m [39m[38;5;241m&[39mfilenames);[38;5;250m  [39m[38;5;66;03m// Ignoring errors on purpose[39;00m
   238           : [38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39mnumber;
   239           : [38;5;250m  [39mFileType[38;5;250m [39mtype;
   240           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m>[39m[38;5;250m [39mfiles_to_delete;
[91mâ†’  241 [30330 â†’ 30315]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mfilenames)[38;5;250m [39m{[0m
[91mâ†’  242 [24044 â†’ 24033]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(ParseFileName(filename,[38;5;250m [39m[38;5;241m&[39mnumber,[38;5;250m [39m[38;5;241m&[39mtype))[38;5;250m [39m{[0m
   243           : [38;5;250m      [39m[38;5;125mbool[39m[38;5;250m [39mkeep[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   244           : [38;5;250m      [39m[38;5;28;01mswitch[39;00m[38;5;250m [39m(type)[38;5;250m [39m{
[91mâ†’  245 [4978 â†’ 4975]:[0m [91m[38;5;250m        [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkLogFile[39m:[0m
[91mâ†’  246 [4978 â†’ 4975]:[0m [91m[38;5;250m          [39mkeep[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m((number[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mLogNumber())[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[0m
[91mâ†’  247 [4978 â†’ 4975]:[0m [91m[38;5;250m                  [39m(number[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mPrevLogNumber()));[0m
   248           : [38;5;250m          [39m[38;5;28;01mbreak[39;00m;
[91mâ†’  249 [4978 â†’ 4976]:[0m [91m[38;5;250m        [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkDescriptorFile[39m:[0m
   250           : [38;5;250m          [39m[38;5;66;03m// Keep my manifest file, and any newer incarnations'[39;00m
[91mâ†’  251 [4978 â†’ 4976]:[0m [91m[38;5;250m          [39m[38;5;66;03m// (in case there is a race that allows other incarnations)[39;00m[0m
   252           : [38;5;250m          [39mkeep[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(number[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mManifestFileNumber());
   253           : [38;5;250m          [39m[38;5;28;01mbreak[39;00m;
[91mâ†’  254 [3657 â†’ 3656]:[0m [91m[38;5;250m        [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkTableFile[39m:[0m
   255           : [38;5;250m          [39mkeep[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(live.find(number)[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mlive.end());
   256           : [38;5;250m          [39m[38;5;28;01mbreak[39;00m;
   257           : [38;5;250m        [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkTempFile[39m:
   258           : [38;5;250m          [39m[38;5;66;03m// Any temp files that are currently being written to must[39;00m
   259           : [38;5;250m          [39m[38;5;66;03m// be recorded in pending_outputs_, which is inserted into "live"[39;00m
   260           : [38;5;250m          [39mkeep[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(live.find(number)[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mlive.end());
   261           : [38;5;250m          [39m[38;5;28;01mbreak[39;00m;
[91mâ†’  262 [3143 â†’ 3141]:[0m [91m[38;5;250m        [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkCurrentFile[39m:[0m
[91mâ†’  263 [6286 â†’ 6282]:[0m [91m[38;5;250m        [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkDBLockFile[39m:[0m
[91mâ†’  264 [10431 â†’ 10426]:[0m [91m[38;5;250m        [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkInfoLogFile[39m:[0m
   265           : [38;5;250m          [39mkeep[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  266 [24044 â†’ 24033]:[0m [91m[38;5;250m          [39m[38;5;28;01mbreak[39;00m;[0m
   267           : [38;5;250m      [39m}
[91mâ†’  268 [24044 â†’ 24033]:[0m [91m[0m
[91mâ†’  269 [4223 â†’ 4225]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mkeep)[38;5;250m [39m{[0m
   270           : [38;5;250m        [39mfiles_to_delete.push_back(std[38;5;241m:[39m[38;5;241m:[39mmove(filename));
[91mâ†’  271 [553 â†’ 556]:[0m [91m[38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(type[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mkTableFile)[38;5;250m [39m{[0m
   272           : [38;5;250m          [39mtable_cache_[38;5;241m-[39m[38;5;241m>[39mEvict(number);
[91mâ†’  273 [4223 â†’ 4225]:[0m [91m[38;5;250m        [39m}[0m
   274           : [38;5;250m        [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mDelete type=%d #%lld[39m[38;5;130;01m\n[39;00m[38;5;124m"[39m,[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mint[39m[38;5;241m>[39m(type),
   275           : [38;5;250m            [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125munsigned[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;241m>[39m(number));
[91mâ†’  276 [24044 â†’ 24033]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  277 [30330 â†’ 30315]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  278 [3143 â†’ 3141]:[0m [91m[38;5;250m  [39m}[0m
   279           : 
   280           : [38;5;250m  [39m[38;5;66;03m// While deleting all files unblock other threads. All files being deleted[39;00m
   281           : [38;5;250m  [39m[38;5;66;03m// have unique names which will not collide with newly created files and[39;00m
[91mâ†’  282 [3143 â†’ 3141]:[0m [91m[38;5;250m  [39m[38;5;66;03m// are therefore safe to delete while allowing other threads to proceed.[39;00m[0m
[91mâ†’  283 [3143 â†’ 3141]:[0m [91m[38;5;250m  [39mmutex_.Unlock();[0m
[91mâ†’  284 [4223 â†’ 4225]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mfiles_to_delete)[38;5;250m [39m{[0m
   285           : [38;5;250m    [39menv_[38;5;241m-[39m[38;5;241m>[39mDeleteFile(dbname_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124m/[39m[38;5;124m"[39m[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mfilename);
[91mâ†’  286 [3143 â†’ 3141]:[0m [91m[38;5;250m  [39m}[0m
   287           : [38;5;250m  [39mmutex_.Lock();
   288           : }
   289           : 
   290           : Status[38;5;250m [39m[38;5;21mDBImpl::Recover[39m(VersionEdit[38;5;241m*[39m[38;5;250m [39medit,[38;5;250m [39m[38;5;125mbool[39m[38;5;241m*[39m[38;5;250m [39msave_manifest)[38;5;250m [39m{
   291           : [38;5;250m  [39mmutex_.AssertHeld();

........................................

   343           : [38;5;250m  [39mFileType[38;5;250m [39mtype;
   344           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m[38;5;250m [39mlogs;
   345           : [38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfilenames.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{
   346           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(ParseFileName(filenames[i],[38;5;250m [39m[38;5;241m&[39mnumber,[38;5;250m [39m[38;5;241m&[39mtype))[38;5;250m [39m{
   347           : [38;5;250m      [39mexpected.erase(number);
[91mâ†’  348 [849 â†’ 851]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(type[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mkLogFile[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m((number[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mmin_log)[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39m(number[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mprev_log)))[0m
   349           : [38;5;250m        [39mlogs.push_back(number);
   350           : [38;5;250m    [39m}
   351           : [38;5;250m  [39m}
   352           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mexpected.empty())[38;5;250m [39m{
   353           : [38;5;250m    [39m[38;5;125mchar[39m[38;5;250m [39mbuf[[38;5;241m50[39m];

........................................

   356           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption(buf,[38;5;250m [39mTableFileName(dbname_,[38;5;250m [39m[38;5;241m*[39m(expected.begin())));
   357           : [38;5;250m  [39m}
   358           : 
   359           : [38;5;250m  [39m[38;5;66;03m// Recover in the order in which the logs were generated[39;00m
   360           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39msort(logs.begin(),[38;5;250m [39mlogs.end());
[91mâ†’  361 [849 â†’ 851]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mlogs.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   362           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mRecoverLogFile(logs[i],[38;5;250m [39m(i[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mlogs.size()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m),[38;5;250m [39msave_manifest,[38;5;250m [39medit,
   363           : [38;5;250m                       [39m[38;5;241m&[39mmax_sequence);
   364           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39ms.ok())[38;5;250m [39m{
   365           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
[91mâ†’  366 [849 â†’ 851]:[0m [91m[38;5;250m    [39m}[0m
   367           : 
   368           : [38;5;250m    [39m[38;5;66;03m// The previous incarnation may not have written any MANIFEST[39;00m
   369           : [38;5;250m    [39m[38;5;66;03m// records after allocating this log number.  So we manually[39;00m
[91mâ†’  370 [849 â†’ 851]:[0m [91m[38;5;250m    [39m[38;5;66;03m// update the file number allocation counter in VersionSet.[39;00m[0m
[91mâ†’  371 [849 â†’ 851]:[0m [91m[38;5;250m    [39mversions_[38;5;241m-[39m[38;5;241m>[39mMarkFileNumberUsed(logs[i]);[0m
   372           : [38;5;250m  [39m}
   373           : 
[91mâ†’  374 [459 â†’ 463]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(versions_[38;5;241m-[39m[38;5;241m>[39mLastSequence()[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mmax_sequence)[38;5;250m [39m{[0m
   375           : [38;5;250m    [39mversions_[38;5;241m-[39m[38;5;241m>[39mSetLastSequence(max_sequence);
   376           : [38;5;250m  [39m}
   377           : 
   378           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
   379           : }
   380           : 
   381           : Status[38;5;250m [39mDBImpl[38;5;241m:[39m[38;5;241m:[39mRecoverLogFile([38;5;125muint64_t[39m[38;5;250m [39mlog_number,[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39mlast_log,
   382           : [38;5;250m                              [39m[38;5;125mbool[39m[38;5;241m*[39m[38;5;250m [39msave_manifest,[38;5;250m [39mVersionEdit[38;5;241m*[39m[38;5;250m [39medit,
[91mâ†’  383 [849 â†’ 851]:[0m [91m[38;5;250m                              [39mSequenceNumber[38;5;241m*[39m[38;5;250m [39mmax_sequence)[38;5;250m [39m{[0m
   384           : [38;5;250m  [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;21;01mLogReporter[39;00m[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;250m [39mlog[38;5;241m:[39m[38;5;241m:[39mReader[38;5;241m:[39m[38;5;241m:[39mReporter[38;5;250m [39m{
   385           : [38;5;250m    [39mEnv[38;5;241m*[39m[38;5;250m [39menv;
   386           : [38;5;250m    [39mLogger[38;5;241m*[39m[38;5;250m [39minfo_log;
   387           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mfname;
   388           : [38;5;250m    [39mStatus[38;5;241m*[39m[38;5;250m [39mstatus;[38;5;250m  [39m[38;5;66;03m// null if options_.paranoid_checks==false[39;00m

........................................

   389           : [38;5;250m    [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mCorruption[39m([38;5;125msize_t[39m[38;5;250m [39mbytes,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mStatus[38;5;241m&[39m[38;5;250m [39ms)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   390           : [38;5;250m      [39mLog(info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124m%s%s: dropping %d bytes; %s[39m[38;5;124m"[39m,
   391           : [38;5;250m          [39m([38;5;28;01mthis[39;00m[38;5;241m-[39m[38;5;241m>[39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124m(ignoring error) [39m[38;5;124m"[39m[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124m"[39m),[38;5;250m [39mfname,
   392           : [38;5;250m          [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mint[39m[38;5;241m>[39m(bytes),[38;5;250m [39ms.ToString().c_str());
   393           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;28;01mthis[39;00m[38;5;241m-[39m[38;5;241m>[39mstatus[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m[38;5;28;01mthis[39;00m[38;5;241m-[39m[38;5;241m>[39mstatus[38;5;241m-[39m[38;5;241m>[39mok())[38;5;250m [39m[38;5;241m*[39m[38;5;28;01mthis[39;00m[38;5;241m-[39m[38;5;241m>[39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39ms;
[91mâ†’  394 [849 â†’ 851]:[0m [91m[38;5;250m    [39m}[0m
   395           : [38;5;250m  [39m};
[91mâ†’  396 [849 â†’ 851]:[0m [91m[0m
   397           : [38;5;250m  [39mmutex_.AssertHeld();
   398           : 
[91mâ†’  399 [849 â†’ 851]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Open the log file[39;00m[0m
   400           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mfname[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mLogFileName(dbname_,[38;5;250m [39mlog_number);
   401           : [38;5;250m  [39mSequentialFile[38;5;241m*[39m[38;5;250m [39mfile;
   402           : [38;5;250m  [39mStatus[38;5;250m [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39menv_[38;5;241m-[39m[38;5;241m>[39mNewSequentialFile(fname,[38;5;250m [39m[38;5;241m&[39mfile);
   403           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   404           : [38;5;250m    [39mMaybeIgnoreError([38;5;241m&[39mstatus);
   405           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
[91mâ†’  406 [849 â†’ 851]:[0m [91m[38;5;250m  [39m}[0m
   407           : 
[91mâ†’  408 [849 â†’ 851]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Create the log reader.[39;00m[0m
[91mâ†’  409 [849 â†’ 851]:[0m [91m[38;5;250m  [39mLogReporter[38;5;250m [39mreporter;[0m
   410           : [38;5;250m  [39mreporter.env[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39menv_;
   411           : [38;5;250m  [39mreporter.info_log[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39moptions_.info_log;
   412           : [38;5;250m  [39mreporter.fname[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfname.c_str();
[91mâ†’  413 [849 â†’ 851]:[0m [91m[38;5;250m  [39mreporter.status[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(options_.paranoid_checks[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39m[38;5;241m&[39mstatus[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);[0m
   414           : [38;5;250m  [39m[38;5;66;03m// We intentionally make log::Reader do checksumming even if[39;00m
   415           : [38;5;250m  [39m[38;5;66;03m// paranoid_checks==false so that corruptions cause entire commits[39;00m
   416           : [38;5;250m  [39m[38;5;66;03m// to be skipped instead of propagating bad information (like overly[39;00m
[91mâ†’  417 [849 â†’ 851]:[0m [91m[38;5;250m  [39m[38;5;66;03m// large sequence numbers).[39;00m[0m
   418           : [38;5;250m  [39mlog[38;5;241m:[39m[38;5;241m:[39mReader[38;5;250m [39m[38;5;21mreader[39m(file,[38;5;250m [39m[38;5;241m&[39mreporter,[38;5;250m [39m[38;5;28mtrue[39m[38;5;250m [39m[38;5;66;03m/*checksum*/[39;00m,[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;66;03m/*initial_offset*/[39;00m);
   419           : [38;5;250m  [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mRecovering log #%llu[39m[38;5;124m"[39m,
   420           : [38;5;250m      [39m([38;5;125munsigned[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m)log_number);
   421           : 
[91mâ†’  422 [849 â†’ 851]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Read all the records and add to a memtable[39;00m[0m
   423           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mscratch;
   424           : [38;5;250m  [39mSlice[38;5;250m [39mrecord;
   425           : [38;5;250m  [39mWriteBatch[38;5;250m [39mbatch;
   426           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mcompactions[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
   427           : [38;5;250m  [39mMemTable[38;5;241m*[39m[38;5;250m [39mmem[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’  428 [993 â†’ 995]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(reader.ReadRecord([38;5;241m&[39mrecord,[38;5;250m [39m[38;5;241m&[39mscratch)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mstatus.ok())[38;5;250m [39m{[0m
   429           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(record.size()[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m12[39m)[38;5;250m [39m{
   430           : [38;5;250m      [39mreporter.Corruption(record.size(),
   431           : [38;5;250m                          [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mlog record too small[39m[38;5;124m"[39m,[38;5;250m [39mfname));
   432           : [38;5;250m      [39m[38;5;28;01mcontinue[39;00m;
[91mâ†’  433 [993 â†’ 995]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  434 [993 â†’ 995]:[0m [91m[38;5;250m    [39mWriteBatchInternal[38;5;241m:[39m[38;5;241m:[39mSetContents([38;5;241m&[39mbatch,[38;5;250m [39mrecord);[0m
[91mâ†’  435 [993 â†’ 995]:[0m [91m[0m
[91mâ†’  436 [639 â†’ 641]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(mem[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   437           : [38;5;250m      [39mmem[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mMemTable(internal_comparator_);
   438           : [38;5;250m      [39mmem[38;5;241m-[39m[38;5;241m>[39mRef();
[91mâ†’  439 [993 â†’ 995]:[0m [91m[38;5;250m    [39m}[0m
   440           : [38;5;250m    [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mWriteBatchInternal[38;5;241m:[39m[38;5;241m:[39mInsertInto([38;5;241m&[39mbatch,[38;5;250m [39mmem);
   441           : [38;5;250m    [39mMaybeIgnoreError([38;5;241m&[39mstatus);
   442           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   443           : [38;5;250m      [39m[38;5;28;01mbreak[39;00m;
[91mâ†’  444 [993 â†’ 995]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  445 [993 â†’ 995]:[0m [91m[38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSequenceNumber[38;5;250m [39mlast_seq[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mWriteBatchInternal[38;5;241m:[39m[38;5;241m:[39mSequence([38;5;241m&[39mbatch)[38;5;250m [39m[38;5;241m+[39m[0m
   446           : [38;5;250m                                    [39mWriteBatchInternal[38;5;241m:[39m[38;5;241m:[39mCount([38;5;241m&[39mbatch)[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m;
[91mâ†’  447 [930 â†’ 932]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(last_seq[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m*[39mmax_sequence)[38;5;250m [39m{[0m
   448           : [38;5;250m      [39m[38;5;241m*[39mmax_sequence[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlast_seq;
[91mâ†’  449 [993 â†’ 995]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  450 [993 â†’ 995]:[0m [91m[0m
[91mâ†’  451 [224 â†’ 226]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(mem[38;5;241m-[39m[38;5;241m>[39mApproximateMemoryUsage()[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39moptions_.write_buffer_size)[38;5;250m [39m{[0m
   452           : [38;5;250m      [39mcompactions[38;5;241m+[39m[38;5;241m+[39m;
   453           : [38;5;250m      [39m[38;5;241m*[39msave_manifest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   454           : [38;5;250m      [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mWriteLevel0Table(mem,[38;5;250m [39medit,[38;5;250m [39m[38;5;28;01mnullptr[39;00m);
   455           : [38;5;250m      [39mmem[38;5;241m-[39m[38;5;241m>[39mUnref();
   456           : [38;5;250m      [39mmem[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
   457           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   458           : [38;5;250m        [39m[38;5;66;03m// Reflect errors immediately so that conditions like full[39;00m
   459           : [38;5;250m        [39m[38;5;66;03m// file-systems cause the DB::Open() to fail.[39;00m
   460           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
[91mâ†’  461 [224 â†’ 226]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  462 [993 â†’ 995]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  463 [849 â†’ 851]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  464 [849 â†’ 851]:[0m [91m[0m
   465           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mfile;
   466           : 
[91mâ†’  467 [849 â†’ 851]:[0m [91m[38;5;250m  [39m[38;5;66;03m// See if we should keep reusing the last log file.[39;00m[0m
   468           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(status.ok()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39moptions_.reuse_logs[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mlast_log[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mcompactions[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   469           : [38;5;250m    [39massert(logfile_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);
   470           : [38;5;250m    [39massert(log_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);
   471           : [38;5;250m    [39massert(mem_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);
   472           : [38;5;250m    [39m[38;5;125muint64_t[39m[38;5;250m [39mlfile_size;

........................................

   482           : [38;5;250m        [39m[38;5;66;03m// mem can be nullptr if lognum exists but was empty.[39;00m
   483           : [38;5;250m        [39mmem_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mMemTable(internal_comparator_);
   484           : [38;5;250m        [39mmem_[38;5;241m-[39m[38;5;241m>[39mRef();
   485           : [38;5;250m      [39m}
   486           : [38;5;250m    [39m}
[91mâ†’  487 [849 â†’ 851]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  488 [849 â†’ 851]:[0m [91m[0m
   489           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(mem[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
   490           : [38;5;250m    [39m[38;5;66;03m// mem did not get reused; compact it.[39;00m
   491           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(status.ok())[38;5;250m [39m{
   492           : [38;5;250m      [39m[38;5;241m*[39msave_manifest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   493           : [38;5;250m      [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mWriteLevel0Table(mem,[38;5;250m [39medit,[38;5;250m [39m[38;5;28;01mnullptr[39;00m);
   494           : [38;5;250m    [39m}
   495           : [38;5;250m    [39mmem[38;5;241m-[39m[38;5;241m>[39mUnref();
[91mâ†’  496 [849 â†’ 851]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  497 [849 â†’ 851]:[0m [91m[0m
   498           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
   499           : }
   500           : 
   501           : Status[38;5;250m [39mDBImpl[38;5;241m:[39m[38;5;241m:[39mWriteLevel0Table(MemTable[38;5;241m*[39m[38;5;250m [39mmem,[38;5;250m [39mVersionEdit[38;5;241m*[39m[38;5;250m [39medit,
[91mâ†’  502 [1727 â†’ 1726]:[0m [91m[38;5;250m                                [39mVersion[38;5;241m*[39m[38;5;250m [39mbase)[38;5;250m [39m{[0m
   503           : [38;5;250m  [39mmutex_.AssertHeld();
   504           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mstart_micros[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39menv_[38;5;241m-[39m[38;5;241m>[39mNowMicros();
   505           : [38;5;250m  [39mFileMetaData[38;5;250m [39mmeta;
   506           : [38;5;250m  [39mmeta.number[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mNewFileNumber();
   507           : [38;5;250m  [39mpending_outputs_.insert(meta.number);
   508           : [38;5;250m  [39mIterator[38;5;241m*[39m[38;5;250m [39miter[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmem[38;5;241m-[39m[38;5;241m>[39mNewIterator();
   509           : [38;5;250m  [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mLevel-0 table #%llu: started[39m[38;5;124m"[39m,
   510           : [38;5;250m      [39m([38;5;125munsigned[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m)meta.number);
[91mâ†’  511 [1727 â†’ 1726]:[0m [91m[0m
   512           : [38;5;250m  [39mStatus[38;5;250m [39ms;
   513           : [38;5;250m  [39m{
   514           : [38;5;250m    [39mmutex_.Unlock();
   515           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mBuildTable(dbname_,[38;5;250m [39menv_,[38;5;250m [39moptions_,[38;5;250m [39mtable_cache_,[38;5;250m [39miter,[38;5;250m [39m[38;5;241m&[39mmeta);
   516           : [38;5;250m    [39mmutex_.Lock();
   517           : [38;5;250m  [39m}
[91mâ†’  518 [1727 â†’ 1726]:[0m [91m[0m
   519           : [38;5;250m  [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mLevel-0 table #%llu: %lld bytes %s[39m[38;5;124m"[39m,
   520           : [38;5;250m      [39m([38;5;125munsigned[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m)meta.number,[38;5;250m [39m([38;5;125munsigned[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m)meta.file_size,
   521           : [38;5;250m      [39ms.ToString().c_str());
   522           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39miter;
   523           : [38;5;250m  [39mpending_outputs_.erase(meta.number);
   524           : 
   525           : [38;5;250m  [39m[38;5;66;03m// Note that if file_size is zero, the file has been deleted and[39;00m
[91mâ†’  526 [1727 â†’ 1726]:[0m [91m[38;5;250m  [39m[38;5;66;03m// should not be added to the manifest.[39;00m[0m
   527           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’  528 [1446 â†’ 1445]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mmeta.file_size[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   529           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;250m [39mmin_user_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmeta.smallest.user_key();
   530           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;250m [39mmax_user_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmeta.largest.user_key();
[91mâ†’  531 [828 â†’ 825]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(base[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   532           : [38;5;250m      [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbase[38;5;241m-[39m[38;5;241m>[39mPickLevelForMemTableOutput(min_user_key,[38;5;250m [39mmax_user_key);
[91mâ†’  533 [1446 â†’ 1445]:[0m [91m[38;5;250m    [39m}[0m
   534           : [38;5;250m    [39medit[38;5;241m-[39m[38;5;241m>[39mAddFile(level,[38;5;250m [39mmeta.number,[38;5;250m [39mmeta.file_size,[38;5;250m [39mmeta.smallest,
   535           : [38;5;250m                  [39mmeta.largest);
[91mâ†’  536 [1727 â†’ 1726]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  537 [1727 â†’ 1726]:[0m [91m[0m
   538           : [38;5;250m  [39mCompactionStats[38;5;250m [39mstats;
   539           : [38;5;250m  [39mstats.micros[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39menv_[38;5;241m-[39m[38;5;241m>[39mNowMicros()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mstart_micros;
   540           : [38;5;250m  [39mstats.bytes_written[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmeta.file_size;
   541           : [38;5;250m  [39mstats_[level].Add(stats);
   542           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
   543           : }
   544           : 
[91mâ†’  545 [1088 â†’ 1085]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDBImpl::CompactMemTable[39m()[38;5;250m [39m{[0m
   546           : [38;5;250m  [39mmutex_.AssertHeld();
[91mâ†’  547 [1088 â†’ 1085]:[0m [91m[38;5;250m  [39massert(imm_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);[0m
   548           : 
[91mâ†’  549 [1088 â†’ 1085]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Save the contents of the memtable as a new Table[39;00m[0m
[91mâ†’  550 [1088 â†’ 1085]:[0m [91m[38;5;250m  [39mVersionEdit[38;5;250m [39medit;[0m
   551           : [38;5;250m  [39mVersion[38;5;241m*[39m[38;5;250m [39mbase[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mcurrent();
   552           : [38;5;250m  [39mbase[38;5;241m-[39m[38;5;241m>[39mRef();
   553           : [38;5;250m  [39mStatus[38;5;250m [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mWriteLevel0Table(imm_,[38;5;250m [39m[38;5;241m&[39medit,[38;5;250m [39mbase);
   554           : [38;5;250m  [39mbase[38;5;241m-[39m[38;5;241m>[39mUnref();
[91mâ†’  555 [1088 â†’ 1085]:[0m [91m[0m
   556           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mshutting_down_.load(std[38;5;241m:[39m[38;5;241m:[39mmemory_order_acquire))[38;5;250m [39m{
   557           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mIOError([38;5;124m"[39m[38;5;124mDeleting DB during memtable compaction[39m[38;5;124m"[39m);
[91mâ†’  558 [1088 â†’ 1085]:[0m [91m[38;5;250m  [39m}[0m
   559           : 
[91mâ†’  560 [1088 â†’ 1085]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Replace immutable memtable with the generated Table[39;00m[0m
[91mâ†’  561 [986 â†’ 983]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   562           : [38;5;250m    [39medit.SetPrevLogNumber([38;5;241m0[39m);
   563           : [38;5;250m    [39medit.SetLogNumber(logfile_number_);[38;5;250m  [39m[38;5;66;03m// Earlier logs no longer needed[39;00m
   564           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mLogAndApply([38;5;241m&[39medit,[38;5;250m [39m[38;5;241m&[39mmutex_);
[91mâ†’  565 [1088 â†’ 1085]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  566 [1088 â†’ 1085]:[0m [91m[0m
[91mâ†’  567 [986 â†’ 983]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
[91mâ†’  568 [986 â†’ 983]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Commit to the new state[39;00m[0m
   569           : [38;5;250m    [39mimm_[38;5;241m-[39m[38;5;241m>[39mUnref();
   570           : [38;5;250m    [39mimm_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
   571           : [38;5;250m    [39mhas_imm_.store([38;5;28mfalse[39m,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmemory_order_release);
   572           : [38;5;250m    [39mDeleteObsoleteFiles();
   573           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   574           : [38;5;250m    [39mRecordBackgroundError(s);
[91mâ†’  575 [1088 â†’ 1085]:[0m [91m[38;5;250m  [39m}[0m
   576           : }
   577           : 
   578           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDBImpl::CompactRange[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39mbegin,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39mend)[38;5;250m [39m{
   579           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mmax_level_with_files[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;
   580           : [38;5;250m  [39m{

........................................

   645           : [38;5;250m    [39m}
   646           : [38;5;250m  [39m}
   647           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
   648           : }
   649           : 
[91mâ†’  650 [170 â†’ 162]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDBImpl::RecordBackgroundError[39m([38;5;28;01mconst[39;00m[38;5;250m [39mStatus[38;5;241m&[39m[38;5;250m [39ms)[38;5;250m [39m{[0m
   651           : [38;5;250m  [39mmutex_.AssertHeld();
[91mâ†’  652 [136 â†’ 132]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(bg_error_.ok())[38;5;250m [39m{[0m
   653           : [38;5;250m    [39mbg_error_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39ms;
   654           : [38;5;250m    [39mbackground_work_finished_signal_.SignalAll();
[91mâ†’  655 [170 â†’ 162]:[0m [91m[38;5;250m  [39m}[0m
   656           : }
   657           : 
[91mâ†’  658 [6766 â†’ 6762]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDBImpl::MaybeScheduleCompaction[39m()[38;5;250m [39m{[0m
   659           : [38;5;250m  [39mmutex_.AssertHeld();
[91mâ†’  660 [110 â†’ 100]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(background_compaction_scheduled_)[38;5;250m [39m{[0m
[91mâ†’  661 [110 â†’ 100]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Already scheduled[39;00m[0m
[91mâ†’  662 [232 â†’ 229]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(shutting_down_.load(std[38;5;241m:[39m[38;5;241m:[39mmemory_order_acquire))[38;5;250m [39m{[0m
[91mâ†’  663 [232 â†’ 229]:[0m [91m[38;5;250m    [39m[38;5;66;03m// DB is being deleted; no more background compactions[39;00m[0m
   664           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mbg_error_.ok())[38;5;250m [39m{
   665           : [38;5;250m    [39m[38;5;66;03m// Already got an error; no more changes[39;00m
[91mâ†’  666 [6424 â†’ 6433]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(imm_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mmanual_compaction_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’  667 [3915 â†’ 3928]:[0m [91m[38;5;250m             [39m[38;5;241m![39mversions_[38;5;241m-[39m[38;5;241m>[39mNeedsCompaction())[38;5;250m [39m{[0m
[91mâ†’  668 [3915 â†’ 3928]:[0m [91m[38;5;250m    [39m[38;5;66;03m// No work to be done[39;00m[0m
[91mâ†’  669 [2509 â†’ 2505]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   670           : [38;5;250m    [39mbackground_compaction_scheduled_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   671           : [38;5;250m    [39menv_[38;5;241m-[39m[38;5;241m>[39mSchedule([38;5;241m&[39mDBImpl[38;5;241m:[39m[38;5;241m:[39mBGWork,[38;5;250m [39m[38;5;28;01mthis[39;00m);
[91mâ†’  672 [6766 â†’ 6762]:[0m [91m[38;5;250m  [39m}[0m
   673           : }
   674           : 
[91mâ†’  675 [2509 â†’ 2505]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDBImpl::BGWork[39m([38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mdb)[38;5;250m [39m{[0m
   676           : [38;5;250m  [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mDBImpl[38;5;241m*[39m[38;5;241m>[39m(db)[38;5;241m-[39m[38;5;241m>[39mBackgroundCall();
   677           : }
   678           : 
[91mâ†’  679 [2509 â†’ 2505]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDBImpl::BackgroundCall[39m()[38;5;250m [39m{[0m
   680           : [38;5;250m  [39mMutexLock[38;5;250m [39m[38;5;21ml[39m([38;5;241m&[39mmutex_);
[91mâ†’  681 [2509 â†’ 2505]:[0m [91m[38;5;250m  [39massert(background_compaction_scheduled_);[0m
[91mâ†’  682 [ 88 â†’  90]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(shutting_down_.load(std[38;5;241m:[39m[38;5;241m:[39mmemory_order_acquire))[38;5;250m [39m{[0m
[91mâ†’  683 [ 88 â†’  90]:[0m [91m[38;5;250m    [39m[38;5;66;03m// No more background work when shutting down.[39;00m[0m
   684           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mbg_error_.ok())[38;5;250m [39m{
   685           : [38;5;250m    [39m[38;5;66;03m// No more background work after a background error.[39;00m
[91mâ†’  686 [2421 â†’ 2415]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   687           : [38;5;250m    [39mBackgroundCompaction();
[91mâ†’  688 [2509 â†’ 2505]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  689 [2509 â†’ 2505]:[0m [91m[0m
   690           : [38;5;250m  [39mbackground_compaction_scheduled_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
   691           : 
   692           : [38;5;250m  [39m[38;5;66;03m// Previous compaction may have produced too many files in a level,[39;00m
[91mâ†’  693 [2509 â†’ 2505]:[0m [91m[38;5;250m  [39m[38;5;66;03m// so reschedule another compaction if needed.[39;00m[0m
   694           : [38;5;250m  [39mMaybeScheduleCompaction();
   695           : [38;5;250m  [39mbackground_work_finished_signal_.SignalAll();
   696           : }
   697           : 
[91mâ†’  698 [2421 â†’ 2415]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDBImpl::BackgroundCompaction[39m()[38;5;250m [39m{[0m
   699           : [38;5;250m  [39mmutex_.AssertHeld();
[91mâ†’  700 [2421 â†’ 2415]:[0m [91m[0m
[91mâ†’  701 [1067 â†’ 1064]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(imm_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   702           : [38;5;250m    [39mCompactMemTable();
   703           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m;
[91mâ†’  704 [1354 â†’ 1351]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  705 [1354 â†’ 1351]:[0m [91m[0m
[91mâ†’  706 [1354 â†’ 1351]:[0m [91m[38;5;250m  [39mCompaction[38;5;241m*[39m[38;5;250m [39mc;[0m
   707           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39mis_manual[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(manual_compaction_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);
   708           : [38;5;250m  [39mInternalKey[38;5;250m [39mmanual_end;
   709           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(is_manual)[38;5;250m [39m{
   710           : [38;5;250m    [39mManualCompaction[38;5;241m*[39m[38;5;250m [39mm[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmanual_compaction_;
   711           : [38;5;250m    [39mc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mCompactRange(m[38;5;241m-[39m[38;5;241m>[39mlevel,[38;5;250m [39mm[38;5;241m-[39m[38;5;241m>[39mbegin,[38;5;250m [39mm[38;5;241m-[39m[38;5;241m>[39mend);

........................................

   716           : [38;5;250m    [39mLog(options_.info_log,
   717           : [38;5;250m        [39m[38;5;124m"[39m[38;5;124mManual compaction at level-%d from %s .. %s; will stop at %s[39m[38;5;130;01m\n[39;00m[38;5;124m"[39m,
   718           : [38;5;250m        [39mm[38;5;241m-[39m[38;5;241m>[39mlevel,[38;5;250m [39m(m[38;5;241m-[39m[38;5;241m>[39mbegin[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39mm[38;5;241m-[39m[38;5;241m>[39mbegin[38;5;241m-[39m[38;5;241m>[39mDebugString().c_str()[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124m(begin)[39m[38;5;124m"[39m),
   719           : [38;5;250m        [39m(m[38;5;241m-[39m[38;5;241m>[39mend[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39mm[38;5;241m-[39m[38;5;241m>[39mend[38;5;241m-[39m[38;5;241m>[39mDebugString().c_str()[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124m(end)[39m[38;5;124m"[39m),
   720           : [38;5;250m        [39m(m[38;5;241m-[39m[38;5;241m>[39mdone[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124m(end)[39m[38;5;124m"[39m[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mmanual_end.DebugString().c_str()));
[91mâ†’  721 [112 â†’ 109]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   722           : [38;5;250m    [39mc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mPickCompaction();
[91mâ†’  723 [1354 â†’ 1351]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  724 [1354 â†’ 1351]:[0m [91m[0m
   725           : [38;5;250m  [39mStatus[38;5;250m [39mstatus;
   726           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(c[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
   727           : [38;5;250m    [39m[38;5;66;03m// Nothing to do[39;00m
   728           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mis_manual[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mc[38;5;241m-[39m[38;5;241m>[39mIsTrivialMove())[38;5;250m [39m{
   729           : [38;5;250m    [39m[38;5;66;03m// Move file to next level[39;00m

........................................

   739           : [38;5;250m    [39mVersionSet[38;5;241m:[39m[38;5;241m:[39mLevelSummaryStorage[38;5;250m [39mtmp;
   740           : [38;5;250m    [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mMoved #%lld to level-%d %lld bytes %s: %s[39m[38;5;130;01m\n[39;00m[38;5;124m"[39m,
   741           : [38;5;250m        [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125munsigned[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;241m>[39m(f[38;5;241m-[39m[38;5;241m>[39mnumber),[38;5;250m [39mc[38;5;241m-[39m[38;5;241m>[39mlevel()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m,
   742           : [38;5;250m        [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125munsigned[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;241m>[39m(f[38;5;241m-[39m[38;5;241m>[39mfile_size),
   743           : [38;5;250m        [39mstatus.ToString().c_str(),[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mLevelSummary([38;5;241m&[39mtmp));
[91mâ†’  744 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   745           : [38;5;250m    [39mCompactionState[38;5;241m*[39m[38;5;250m [39mcompact[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mCompactionState(c);
   746           : [38;5;250m    [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mDoCompactionWork(compact);
[91mâ†’  747 [ 34 â†’  30]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{[0m
   748           : [38;5;250m      [39mRecordBackgroundError(status);
[91mâ†’  749 [356 â†’ 353]:[0m [91m[38;5;250m    [39m}[0m
   750           : [38;5;250m    [39mCleanupCompaction(compact);
   751           : [38;5;250m    [39mc[38;5;241m-[39m[38;5;241m>[39mReleaseInputs();
   752           : [38;5;250m    [39mDeleteObsoleteFiles();
[91mâ†’  753 [1354 â†’ 1351]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  754 [1354 â†’ 1351]:[0m [91m[38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mc;[0m
[91mâ†’  755 [1354 â†’ 1351]:[0m [91m[0m
[91mâ†’  756 [1320 â†’ 1321]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(status.ok())[38;5;250m [39m{[0m
[91mâ†’  757 [1320 â†’ 1321]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Done[39;00m[0m
[91mâ†’  758 [ 34 â†’  30]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(shutting_down_.load(std[38;5;241m:[39m[38;5;241m:[39mmemory_order_acquire))[38;5;250m [39m{[0m
[91mâ†’  759 [ 34 â†’  30]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Ignore compaction errors found during shutting down[39;00m[0m
   760           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   761           : [38;5;250m    [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mCompaction error: %s[39m[38;5;124m"[39m,[38;5;250m [39mstatus.ToString().c_str());
[91mâ†’  762 [1354 â†’ 1351]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  763 [1354 â†’ 1351]:[0m [91m[0m
   764           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(is_manual)[38;5;250m [39m{
   765           : [38;5;250m    [39mManualCompaction[38;5;241m*[39m[38;5;250m [39mm[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmanual_compaction_;
   766           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   767           : [38;5;250m      [39mm[38;5;241m-[39m[38;5;241m>[39mdone[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   768           : [38;5;250m    [39m}

........................................

   771           : [38;5;250m      [39m[38;5;66;03m// to the range that is left to be compacted.[39;00m
   772           : [38;5;250m      [39mm[38;5;241m-[39m[38;5;241m>[39mtmp_storage[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmanual_end;
   773           : [38;5;250m      [39mm[38;5;241m-[39m[38;5;241m>[39mbegin[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mm[38;5;241m-[39m[38;5;241m>[39mtmp_storage;
   774           : [38;5;250m    [39m}
   775           : [38;5;250m    [39mmanual_compaction_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’  776 [1354 â†’ 1351]:[0m [91m[38;5;250m  [39m}[0m
   777           : }
   778           : 
[91mâ†’  779 [356 â†’ 353]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDBImpl::CleanupCompaction[39m(CompactionState[38;5;241m*[39m[38;5;250m [39mcompact)[38;5;250m [39m{[0m
   780           : [38;5;250m  [39mmutex_.AssertHeld();
   781           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(compact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
   782           : [38;5;250m    [39m[38;5;66;03m// May happen if we get a shutdown call in the middle of compaction[39;00m
   783           : [38;5;250m    [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;241m-[39m[38;5;241m>[39mAbandon();
   784           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder;
[91mâ†’  785 [355 â†’ 352]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   786           : [38;5;250m    [39massert(compact[38;5;241m-[39m[38;5;241m>[39moutfile[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);
[91mâ†’  787 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  788 [356 â†’ 353]:[0m [91m[38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39moutfile;[0m
[91mâ†’  789 [252 â†’ 251]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39moutputs.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   790           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mCompactionState[38;5;241m:[39m[38;5;241m:[39mOutput[38;5;241m&[39m[38;5;250m [39mout[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39moutputs[i];
   791           : [38;5;250m    [39mpending_outputs_.erase(out.number);
[91mâ†’  792 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
   793           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mcompact;
   794           : }
   795           : 
[91mâ†’  796 [252 â†’ 251]:[0m [91mStatus[38;5;250m [39m[38;5;21mDBImpl::OpenCompactionOutputFile[39m(CompactionState[38;5;241m*[39m[38;5;250m [39mcompact)[38;5;250m [39m{[0m
[91mâ†’  797 [252 â†’ 251]:[0m [91m[38;5;250m  [39massert(compact[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);[0m
[91mâ†’  798 [252 â†’ 251]:[0m [91m[38;5;250m  [39massert(compact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);[0m
[91mâ†’  799 [252 â†’ 251]:[0m [91m[38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39mfile_number;[0m
   800           : [38;5;250m  [39m{
   801           : [38;5;250m    [39mmutex_.Lock();
   802           : [38;5;250m    [39mfile_number[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mNewFileNumber();
   803           : [38;5;250m    [39mpending_outputs_.insert(file_number);
   804           : [38;5;250m    [39mCompactionState[38;5;241m:[39m[38;5;241m:[39mOutput[38;5;250m [39mout;

........................................

   807           : [38;5;250m    [39mout.largest.Clear();
   808           : [38;5;250m    [39mcompact[38;5;241m-[39m[38;5;241m>[39moutputs.push_back(out);
   809           : [38;5;250m    [39mmutex_.Unlock();
   810           : [38;5;250m  [39m}
   811           : 
[91mâ†’  812 [252 â†’ 251]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Make the output file[39;00m[0m
   813           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mfname[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mTableFileName(dbname_,[38;5;250m [39mfile_number);
   814           : [38;5;250m  [39mStatus[38;5;250m [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39menv_[38;5;241m-[39m[38;5;241m>[39mNewWritableFile(fname,[38;5;250m [39m[38;5;241m&[39mcompact[38;5;241m-[39m[38;5;241m>[39moutfile);
[91mâ†’  815 [252 â†’ 251]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   816           : [38;5;250m    [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mTableBuilder(options_,[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39moutfile);
[91mâ†’  817 [252 â†’ 251]:[0m [91m[38;5;250m  [39m}[0m
   818           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
   819           : }
   820           : 
   821           : Status[38;5;250m [39mDBImpl[38;5;241m:[39m[38;5;241m:[39mFinishCompactionOutputFile(CompactionState[38;5;241m*[39m[38;5;250m [39mcompact,
[91mâ†’  822 [251 â†’ 250]:[0m [91m[38;5;250m                                          [39mIterator[38;5;241m*[39m[38;5;250m [39minput)[38;5;250m [39m{[0m
[91mâ†’  823 [251 â†’ 250]:[0m [91m[38;5;250m  [39massert(compact[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);[0m
[91mâ†’  824 [251 â†’ 250]:[0m [91m[38;5;250m  [39massert(compact[38;5;241m-[39m[38;5;241m>[39moutfile[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);[0m
[91mâ†’  825 [251 â†’ 250]:[0m [91m[38;5;250m  [39massert(compact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);[0m
[91mâ†’  826 [251 â†’ 250]:[0m [91m[0m
[91mâ†’  827 [251 â†’ 250]:[0m [91m[38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39moutput_number[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mcurrent_output()[38;5;241m-[39m[38;5;241m>[39mnumber;[0m
[91mâ†’  828 [251 â†’ 250]:[0m [91m[38;5;250m  [39massert(output_number[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
   829           : 
[91mâ†’  830 [251 â†’ 250]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Check for iterator errors[39;00m[0m
[91mâ†’  831 [251 â†’ 250]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minput[38;5;241m-[39m[38;5;241m>[39mstatus();[0m
   832           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mcurrent_entries[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;241m-[39m[38;5;241m>[39mNumEntries();
[91mâ†’  833 [251 â†’ 250]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   834           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;241m-[39m[38;5;241m>[39mFinish();
   835           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   836           : [38;5;250m    [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;241m-[39m[38;5;241m>[39mAbandon();
[91mâ†’  837 [251 â†’ 250]:[0m [91m[38;5;250m  [39m}[0m
   838           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mcurrent_bytes[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;241m-[39m[38;5;241m>[39mFileSize();
   839           : [38;5;250m  [39mcompact[38;5;241m-[39m[38;5;241m>[39mcurrent_output()[38;5;241m-[39m[38;5;241m>[39mfile_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcurrent_bytes;
   840           : [38;5;250m  [39mcompact[38;5;241m-[39m[38;5;241m>[39mtotal_bytes[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mcurrent_bytes;
   841           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder;
   842           : [38;5;250m  [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
   843           : 
[91mâ†’  844 [251 â†’ 250]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Finish and check for file errors[39;00m[0m
[91mâ†’  845 [251 â†’ 250]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   846           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39moutfile[38;5;241m-[39m[38;5;241m>[39mSync();
[91mâ†’  847 [251 â†’ 250]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  848 [251 â†’ 250]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   849           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39moutfile[38;5;241m-[39m[38;5;241m>[39mClose();
[91mâ†’  850 [251 â†’ 250]:[0m [91m[38;5;250m  [39m}[0m
   851           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39moutfile;
   852           : [38;5;250m  [39mcompact[38;5;241m-[39m[38;5;241m>[39moutfile[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’  853 [251 â†’ 250]:[0m [91m[0m
[91mâ†’  854 [251 â†’ 250]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mcurrent_entries[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
[91mâ†’  855 [251 â†’ 250]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Verify that the table is usable[39;00m[0m
   856           : [38;5;250m    [39mIterator[38;5;241m*[39m[38;5;250m [39miter[38;5;250m [39m[38;5;241m=[39m
   857           : [38;5;250m        [39mtable_cache_[38;5;241m-[39m[38;5;241m>[39mNewIterator(ReadOptions(),[38;5;250m [39moutput_number,[38;5;250m [39mcurrent_bytes);
   858           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39miter[38;5;241m-[39m[38;5;241m>[39mstatus();
   859           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[38;5;250m [39miter;
[91mâ†’  860 [251 â†’ 250]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   861           : [38;5;250m      [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mGenerated table #%llu@%d: %lld keys, %lld bytes[39m[38;5;124m"[39m,
   862           : [38;5;250m          [39m([38;5;125munsigned[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m)output_number,[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mlevel(),
   863           : [38;5;250m          [39m([38;5;125munsigned[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m)current_entries,
   864           : [38;5;250m          [39m([38;5;125munsigned[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m)current_bytes);
[91mâ†’  865 [251 â†’ 250]:[0m [91m[38;5;250m    [39m}[0m
   866           : [38;5;250m  [39m}
   867           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
   868           : }
   869           : 
[91mâ†’  870 [322 â†’ 323]:[0m [91mStatus[38;5;250m [39m[38;5;21mDBImpl::InstallCompactionResults[39m(CompactionState[38;5;241m*[39m[38;5;250m [39mcompact)[38;5;250m [39m{[0m
   871           : [38;5;250m  [39mmutex_.AssertHeld();
   872           : [38;5;250m  [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mCompacted %d@%d + %d@%d files => %lld bytes[39m[38;5;124m"[39m,
   873           : [38;5;250m      [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mnum_input_files([38;5;241m0[39m),[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mlevel(),
   874           : [38;5;250m      [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mnum_input_files([38;5;241m1[39m),[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mlevel()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m,
   875           : [38;5;250m      [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;241m>[39m(compact[38;5;241m-[39m[38;5;241m>[39mtotal_bytes));
   876           : 
[91mâ†’  877 [322 â†’ 323]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Add compaction outputs[39;00m[0m
   878           : [38;5;250m  [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mAddInputDeletions(compact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39medit());
   879           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mlevel();
   880           : [38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39moutputs.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{
   881           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mCompactionState[38;5;241m:[39m[38;5;241m:[39mOutput[38;5;241m&[39m[38;5;250m [39mout[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39moutputs[i];
   882           : [38;5;250m    [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39medit()[38;5;241m-[39m[38;5;241m>[39mAddFile(level[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m,[38;5;250m [39mout.number,[38;5;250m [39mout.file_size,
   883           : [38;5;250m                                         [39mout.smallest,[38;5;250m [39mout.largest);
[91mâ†’  884 [322 â†’ 323]:[0m [91m[38;5;250m  [39m}[0m
   885           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mLogAndApply(compact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39medit(),[38;5;250m [39m[38;5;241m&[39mmutex_);
   886           : }
   887           : 
[91mâ†’  888 [356 â†’ 353]:[0m [91mStatus[38;5;250m [39m[38;5;21mDBImpl::DoCompactionWork[39m(CompactionState[38;5;241m*[39m[38;5;250m [39mcompact)[38;5;250m [39m{[0m
   889           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mstart_micros[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39menv_[38;5;241m-[39m[38;5;241m>[39mNowMicros();
   890           : [38;5;250m  [39m[38;5;125mint64_t[39m[38;5;250m [39mimm_micros[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m  [39m[38;5;66;03m// Micros spent doing imm_ compactions[39;00m
[91mâ†’  891 [356 â†’ 353]:[0m [91m[0m
   892           : [38;5;250m  [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mCompacting %d@%d + %d@%d files[39m[38;5;124m"[39m,
   893           : [38;5;250m      [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mnum_input_files([38;5;241m0[39m),[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mlevel(),
   894           : [38;5;250m      [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mnum_input_files([38;5;241m1[39m),
   895           : [38;5;250m      [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mlevel()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m);
[91mâ†’  896 [356 â†’ 353]:[0m [91m[0m
   897           : [38;5;250m  [39massert(versions_[38;5;241m-[39m[38;5;241m>[39mNumLevelFiles(compact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mlevel())[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);
[91mâ†’  898 [356 â†’ 353]:[0m [91m[38;5;250m  [39massert(compact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);[0m
[91mâ†’  899 [356 â†’ 353]:[0m [91m[38;5;250m  [39massert(compact[38;5;241m-[39m[38;5;241m>[39moutfile[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);[0m
[91mâ†’  900 [356 â†’ 353]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(snapshots_.empty())[38;5;250m [39m{[0m
   901           : [38;5;250m    [39mcompact[38;5;241m-[39m[38;5;241m>[39msmallest_snapshot[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mLastSequence();
   902           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   903           : [38;5;250m    [39mcompact[38;5;241m-[39m[38;5;241m>[39msmallest_snapshot[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39msnapshots_.oldest()[38;5;241m-[39m[38;5;241m>[39msequence_number();
[91mâ†’  904 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  905 [356 â†’ 353]:[0m [91m[0m
   906           : [38;5;250m  [39mIterator[38;5;241m*[39m[38;5;250m [39minput[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mMakeInputIterator(compact[38;5;241m-[39m[38;5;241m>[39mcompaction);
   907           : 
[91mâ†’  908 [356 â†’ 353]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Release mutex while we're actually doing the compaction work[39;00m[0m
   909           : [38;5;250m  [39mmutex_.Unlock();
[91mâ†’  910 [356 â†’ 353]:[0m [91m[0m
   911           : [38;5;250m  [39minput[38;5;241m-[39m[38;5;241m>[39mSeekToFirst();
   912           : [38;5;250m  [39mStatus[38;5;250m [39mstatus;
   913           : [38;5;250m  [39mParsedInternalKey[38;5;250m [39mikey;
   914           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mcurrent_user_key;
   915           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39mhas_current_user_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
   916           : [38;5;250m  [39mSequenceNumber[38;5;250m [39mlast_sequence_for_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkMaxSequenceNumber;
[91mâ†’  917 [737 â†’ 738]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(input[38;5;241m-[39m[38;5;241m>[39mValid()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m![39mshutting_down_.load(std[38;5;241m:[39m[38;5;241m:[39mmemory_order_acquire))[38;5;250m [39m{[0m
[91mâ†’  918 [737 â†’ 738]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Prioritize immutable compaction work[39;00m[0m
   919           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(has_imm_.load(std[38;5;241m:[39m[38;5;241m:[39mmemory_order_relaxed))[38;5;250m [39m{
   920           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mimm_start[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39menv_[38;5;241m-[39m[38;5;241m>[39mNowMicros();
   921           : [38;5;250m      [39mmutex_.Lock();
   922           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(imm_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
   923           : [38;5;250m        [39mCompactMemTable();

........................................

   924           : [38;5;250m        [39m[38;5;66;03m// Wake up MakeRoomForWrite() if necessary.[39;00m
   925           : [38;5;250m        [39mbackground_work_finished_signal_.SignalAll();
   926           : [38;5;250m      [39m}
   927           : [38;5;250m      [39mmutex_.Unlock();
   928           : [38;5;250m      [39mimm_micros[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m(env_[38;5;241m-[39m[38;5;241m>[39mNowMicros()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mimm_start);
[91mâ†’  929 [737 â†’ 738]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  930 [737 â†’ 738]:[0m [91m[0m
   931           : [38;5;250m    [39mSlice[38;5;250m [39mkey[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minput[38;5;241m-[39m[38;5;241m>[39mkey();
[91mâ†’  932 [737 â†’ 738]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(compact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mShouldStopBefore(key)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
   933           : [38;5;250m        [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
   934           : [38;5;250m      [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFinishCompactionOutputFile(compact,[38;5;250m [39minput);
   935           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   936           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
   937           : [38;5;250m      [39m}
[91mâ†’  938 [737 â†’ 738]:[0m [91m[38;5;250m    [39m}[0m
   939           : 
[91mâ†’  940 [737 â†’ 738]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Handle key/value, add to state, etc.[39;00m[0m
[91mâ†’  941 [737 â†’ 738]:[0m [91m[38;5;250m    [39m[38;5;125mbool[39m[38;5;250m [39mdrop[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;[0m
   942           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mParseInternalKey(key,[38;5;250m [39m[38;5;241m&[39mikey))[38;5;250m [39m{
   943           : [38;5;250m      [39m[38;5;66;03m// Do not hide error keys[39;00m
   944           : [38;5;250m      [39mcurrent_user_key.clear();
   945           : [38;5;250m      [39mhas_current_user_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
   946           : [38;5;250m      [39mlast_sequence_for_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkMaxSequenceNumber;
[91mâ†’  947 [737 â†’ 738]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
[91mâ†’  948 [737 â†’ 738]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mhas_current_user_key[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[0m
[91mâ†’  949 [409 â†’ 411]:[0m [91m[38;5;250m          [39muser_comparator()[38;5;241m-[39m[38;5;241m>[39mCompare(ikey.user_key,[38;5;250m [39mSlice(current_user_key))[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[0m
[91mâ†’  950 [503 â†’ 502]:[0m [91m[38;5;250m              [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
[91mâ†’  951 [503 â†’ 502]:[0m [91m[38;5;250m        [39m[38;5;66;03m// First occurrence of this user key[39;00m[0m
   952           : [38;5;250m        [39mcurrent_user_key.assign(ikey.user_key.data(),[38;5;250m [39mikey.user_key.size());
   953           : [38;5;250m        [39mhas_current_user_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   954           : [38;5;250m        [39mlast_sequence_for_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkMaxSequenceNumber;
[91mâ†’  955 [737 â†’ 738]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  956 [737 â†’ 738]:[0m [91m[0m
[91mâ†’  957 [234 â†’ 236]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(last_sequence_for_key[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39msmallest_snapshot)[38;5;250m [39m{[0m
[91mâ†’  958 [234 â†’ 236]:[0m [91m[38;5;250m        [39m[38;5;66;03m// Hidden by an newer entry for same user key[39;00m[0m
   959           : [38;5;250m        [39mdrop[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;[38;5;250m  [39m[38;5;66;03m// (A)[39;00m
[91mâ†’  960 [503 â†’ 502]:[0m [91m[38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(ikey.type[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mkTypeDeletion[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’  961 [503 â†’ 502]:[0m [91m[38;5;250m                 [39mikey.sequence[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39msmallest_snapshot[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
   962           : [38;5;250m                 [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mIsBaseLevelForKey(ikey.user_key))[38;5;250m [39m{
   963           : [38;5;250m        [39m[38;5;66;03m// For this user key:[39;00m
   964           : [38;5;250m        [39m[38;5;66;03m// (1) there is no data in higher levels[39;00m
   965           : [38;5;250m        [39m[38;5;66;03m// (2) data in lower levels will have larger sequence numbers[39;00m
   966           : [38;5;250m        [39m[38;5;66;03m// (3) data in layers that are being compacted here and have[39;00m
   967           : [38;5;250m        [39m[38;5;66;03m//     smaller sequence numbers will be dropped in the next[39;00m
   968           : [38;5;250m        [39m[38;5;66;03m//     few iterations of this loop (by rule (A) above).[39;00m
   969           : [38;5;250m        [39m[38;5;66;03m// Therefore this deletion marker is obsolete and can be dropped.[39;00m
   970           : [38;5;250m        [39mdrop[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  971 [737 â†’ 738]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  972 [737 â†’ 738]:[0m [91m[0m
   973           : [38;5;250m      [39mlast_sequence_for_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mikey.sequence;
   974           : [38;5;250m    [39m}
   975           : [38;5;130m#if 0[39m
   976           : [38;5;250m    [39mLog(options_.info_log,
   977           : [38;5;250m        [39m[38;5;124m"[39m[38;5;124m  Compact: %s, seq %d, type: %d %d, drop: %d, is_base: %d, [39m[38;5;124m"[39m

........................................

   979           : [38;5;250m        [39mikey.user_key.ToString().c_str(),
   980           : [38;5;250m        [39m([38;5;125mint[39m)ikey.sequence,[38;5;250m [39mikey.type,[38;5;250m [39mkTypeValue,[38;5;250m [39mdrop,
   981           : [38;5;250m        [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mIsBaseLevelForKey(ikey.user_key),
   982           : [38;5;250m        [39m([38;5;125mint[39m)last_sequence_for_key,[38;5;250m [39m([38;5;125mint[39m)compact[38;5;241m-[39m[38;5;241m>[39msmallest_snapshot);
   983           : [38;5;130m#[39m[38;5;130mendif[39m
[91mâ†’  984 [737 â†’ 738]:[0m [91m[0m
[91mâ†’  985 [275 â†’ 274]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mdrop)[38;5;250m [39m{[0m
[91mâ†’  986 [275 â†’ 274]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Open output file if necessary[39;00m[0m
[91mâ†’  987 [252 â†’ 251]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(compact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   988           : [38;5;250m        [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mOpenCompactionOutputFile(compact);
   989           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   990           : [38;5;250m          [39m[38;5;28;01mbreak[39;00m;
[91mâ†’  991 [252 â†’ 251]:[0m [91m[38;5;250m        [39m}[0m
[91mâ†’  992 [275 â†’ 274]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  993 [252 â†’ 251]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(compact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;241m-[39m[38;5;241m>[39mNumEntries()[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   994           : [38;5;250m        [39mcompact[38;5;241m-[39m[38;5;241m>[39mcurrent_output()[38;5;241m-[39m[38;5;241m>[39msmallest.DecodeFrom(key);
[91mâ†’  995 [275 â†’ 274]:[0m [91m[38;5;250m      [39m}[0m
   996           : [38;5;250m      [39mcompact[38;5;241m-[39m[38;5;241m>[39mcurrent_output()[38;5;241m-[39m[38;5;241m>[39mlargest.DecodeFrom(key);
   997           : [38;5;250m      [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;241m-[39m[38;5;241m>[39mAdd(key,[38;5;250m [39minput[38;5;241m-[39m[38;5;241m>[39mvalue());
   998           : 
[91mâ†’  999 [275 â†’ 274]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Close output file if it is big enough[39;00m[0m
[91mâ†’ 1000 [275 â†’ 274]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(compact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;241m-[39m[38;5;241m>[39mFileSize()[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[0m
[91mâ†’ 1001 [ 85 â†’  84]:[0m [91m[38;5;250m          [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mMaxOutputFileSize())[38;5;250m [39m{[0m
  1002           : [38;5;250m        [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFinishCompactionOutputFile(compact,[38;5;250m [39minput);
  1003           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
  1004           : [38;5;250m          [39m[38;5;28;01mbreak[39;00m;
[91mâ†’ 1005 [ 85 â†’  84]:[0m [91m[38;5;250m        [39m}[0m
[91mâ†’ 1006 [275 â†’ 274]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’ 1007 [737 â†’ 738]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’ 1008 [737 â†’ 738]:[0m [91m[0m
[91mâ†’ 1009 [737 â†’ 738]:[0m [91m[38;5;250m    [39minput[38;5;241m-[39m[38;5;241m>[39mNext();[0m
[91mâ†’ 1010 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’ 1011 [356 â†’ 353]:[0m [91m[0m
[91mâ†’ 1012 [ 34 â†’  30]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(status.ok()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mshutting_down_.load(std[38;5;241m:[39m[38;5;241m:[39mmemory_order_acquire))[38;5;250m [39m{[0m
  1013           : [38;5;250m    [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mIOError([38;5;124m"[39m[38;5;124mDeleting DB during compaction[39m[38;5;124m"[39m);
[91mâ†’ 1014 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
  1015           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(status.ok()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mbuilder[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
  1016           : [38;5;250m    [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFinishCompactionOutputFile(compact,[38;5;250m [39minput);
[91mâ†’ 1017 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’ 1018 [322 â†’ 323]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(status.ok())[38;5;250m [39m{[0m
  1019           : [38;5;250m    [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minput[38;5;241m-[39m[38;5;241m>[39mstatus();
[91mâ†’ 1020 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
  1021           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39minput;
  1022           : [38;5;250m  [39minput[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’ 1023 [356 â†’ 353]:[0m [91m[0m
  1024           : [38;5;250m  [39mCompactionStats[38;5;250m [39mstats;
  1025           : [38;5;250m  [39mstats.micros[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39menv_[38;5;241m-[39m[38;5;241m>[39mNowMicros()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mstart_micros[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mimm_micros;
[91mâ†’ 1026 [712 â†’ 706]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mwhich[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mwhich[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m2[39m;[38;5;250m [39mwhich[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
[91mâ†’ 1027 [633 â†’ 627]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mnum_input_files(which);[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
  1028           : [38;5;250m      [39mstats.bytes_read[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39minput(which,[38;5;250m [39mi)[38;5;241m-[39m[38;5;241m>[39mfile_size;
[91mâ†’ 1029 [712 â†’ 706]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’ 1030 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’ 1031 [252 â†’ 251]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39moutputs.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
  1032           : [38;5;250m    [39mstats.bytes_written[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mcompact[38;5;241m-[39m[38;5;241m>[39moutputs[i].file_size;
[91mâ†’ 1033 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’ 1034 [356 â†’ 353]:[0m [91m[0m
  1035           : [38;5;250m  [39mmutex_.Lock();
  1036           : [38;5;250m  [39mstats_[compact[38;5;241m-[39m[38;5;241m>[39mcompaction[38;5;241m-[39m[38;5;241m>[39mlevel()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m].Add(stats);
[91mâ†’ 1037 [356 â†’ 353]:[0m [91m[0m
[91mâ†’ 1038 [322 â†’ 323]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(status.ok())[38;5;250m [39m{[0m
  1039           : [38;5;250m    [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mInstallCompactionResults(compact);
[91mâ†’ 1040 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’ 1041 [ 34 â†’  30]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{[0m
  1042           : [38;5;250m    [39mRecordBackgroundError(status);
[91mâ†’ 1043 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
  1044           : [38;5;250m  [39mVersionSet[38;5;241m:[39m[38;5;241m:[39mLevelSummaryStorage[38;5;250m [39mtmp;
  1045           : [38;5;250m  [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mcompacted to: %s[39m[38;5;124m"[39m,[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mLevelSummary([38;5;241m&[39mtmp));
  1046           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
  1047           : }
  1048           : 

........................................

  1078           : 
  1079           : [38;5;250m  [39m[38;5;66;03m// Collect together all needed child iterators[39;00m
  1080           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mIterator[38;5;241m*[39m[38;5;241m>[39m[38;5;250m [39mlist;
  1081           : [38;5;250m  [39mlist.push_back(mem_[38;5;241m-[39m[38;5;241m>[39mNewIterator());
  1082           : [38;5;250m  [39mmem_[38;5;241m-[39m[38;5;241m>[39mRef();
[91mâ†’ 1083 [240 â†’ 242]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(imm_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
  1084           : [38;5;250m    [39mlist.push_back(imm_[38;5;241m-[39m[38;5;241m>[39mNewIterator());
  1085           : [38;5;250m    [39mimm_[38;5;241m-[39m[38;5;241m>[39mRef();
  1086           : [38;5;250m  [39m}
  1087           : [38;5;250m  [39mversions_[38;5;241m-[39m[38;5;241m>[39mcurrent()[38;5;241m-[39m[38;5;241m>[39mAddIterators(options,[38;5;250m [39m[38;5;241m&[39mlist);
  1088           : [38;5;250m  [39mIterator[38;5;241m*[39m[38;5;250m [39minternal_iter[38;5;250m [39m[38;5;241m=[39m

........................................

  1321           : Status[38;5;250m [39m[38;5;21mDBImpl::MakeRoomForWrite[39m([38;5;125mbool[39m[38;5;250m [39mforce)[38;5;250m [39m{
  1322           : [38;5;250m  [39mmutex_.AssertHeld();
  1323           : [38;5;250m  [39massert([38;5;241m![39mwriters_.empty());
  1324           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39mallow_delay[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m![39mforce;
  1325           : [38;5;250m  [39mStatus[38;5;250m [39ms;
[91mâ†’ 1326 [4837 â†’ 4835]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;28mtrue[39m)[38;5;250m [39m{[0m
  1327           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mbg_error_.ok())[38;5;250m [39m{
  1328           : [38;5;250m      [39m[38;5;66;03m// Yield previous error[39;00m
  1329           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbg_error_;
  1330           : [38;5;250m      [39m[38;5;28;01mbreak[39;00m;
[91mâ†’ 1331 [3210 â†’ 3214]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(allow_delay[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mversions_[38;5;241m-[39m[38;5;241m>[39mNumLevelFiles([38;5;241m0[39m)[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[0m
  1332           : [38;5;250m                                  [39mconfig[38;5;241m:[39m[38;5;241m:[39mkL0_SlowdownWritesTrigger)[38;5;250m [39m{
  1333           : [38;5;250m      [39m[38;5;66;03m// We are getting close to hitting a hard limit on the number of[39;00m
  1334           : [38;5;250m      [39m[38;5;66;03m// L0 files.  Rather than delaying a single write by several[39;00m
  1335           : [38;5;250m      [39m[38;5;66;03m// seconds when we hit the hard limit, start delaying each[39;00m
  1336           : [38;5;250m      [39m[38;5;66;03m// individual write by 1ms to reduce latency variance.  Also,[39;00m

........................................

  1338           : [38;5;250m      [39m[38;5;66;03m// case it is sharing the same core as the writer.[39;00m
  1339           : [38;5;250m      [39mmutex_.Unlock();
  1340           : [38;5;250m      [39menv_[38;5;241m-[39m[38;5;241m>[39mSleepForMicroseconds([38;5;241m1000[39m);
  1341           : [38;5;250m      [39mallow_delay[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;[38;5;250m  [39m[38;5;66;03m// Do not delay a single write more than once[39;00m
  1342           : [38;5;250m      [39mmutex_.Lock();
[91mâ†’ 1343 [4837 â†’ 4835]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mforce[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
  1344           : [38;5;250m               [39m(mem_[38;5;241m-[39m[38;5;241m>[39mApproximateMemoryUsage()[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39moptions_.write_buffer_size))[38;5;250m [39m{
  1345           : [38;5;250m      [39m[38;5;66;03m// There is room in current memtable[39;00m
  1346           : [38;5;250m      [39m[38;5;28;01mbreak[39;00m;
[91mâ†’ 1347 [123 â†’ 121]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(imm_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
  1348           : [38;5;250m      [39m[38;5;66;03m// We have filled up the current memtable, but the previous[39;00m
[91mâ†’ 1349 [123 â†’ 121]:[0m [91m[38;5;250m      [39m[38;5;66;03m// one is still being compacted, so we wait.[39;00m[0m
  1350           : [38;5;250m      [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mCurrent memtable full; waiting...[39m[38;5;130;01m\n[39;00m[38;5;124m"[39m);
  1351           : [38;5;250m      [39mbackground_work_finished_signal_.Wait();
  1352           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(versions_[38;5;241m-[39m[38;5;241m>[39mNumLevelFiles([38;5;241m0[39m)[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkL0_StopWritesTrigger)[38;5;250m [39m{
  1353           : [38;5;250m      [39m[38;5;66;03m// There are too many level-0 files.[39;00m
  1354           : [38;5;250m      [39mLog(options_.info_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mToo many L0 files; waiting...[39m[38;5;130;01m\n[39;00m[38;5;124m"[39m);

........................................

  1373           : [38;5;250m      [39mhas_imm_.store([38;5;28mtrue[39m,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmemory_order_release);
  1374           : [38;5;250m      [39mmem_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mMemTable(internal_comparator_);
  1375           : [38;5;250m      [39mmem_[38;5;241m-[39m[38;5;241m>[39mRef();
  1376           : [38;5;250m      [39mforce[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;[38;5;250m  [39m[38;5;66;03m// Do not force another compaction if have room[39;00m
  1377           : [38;5;250m      [39mMaybeScheduleCompaction();
[91mâ†’ 1378 [4837 â†’ 4835]:[0m [91m[38;5;250m    [39m}[0m
  1379           : [38;5;250m  [39m}
  1380           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
  1381           : }
  1382           : 
  1383           : [38;5;125mbool[39m[38;5;250m [39m[38;5;21mDBImpl::GetProperty[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mproperty,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mvalue)[38;5;250m [39m{

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/db_impl.h ===
Lines with coverage differences:

Lines with different hit counts: 93, 154

Detailed differences with context:
============================================================
    88           : [38;5;250m  [39m[38;5;66;03m// Per level compaction stats.  stats_[level] stores the stats for[39;00m
    89           : [38;5;250m  [39m[38;5;66;03m// compactions that produced data for the specified "level".[39;00m
    90           : [38;5;250m  [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;21;01mCompactionStats[39;00m[38;5;250m [39m{
    91           : [38;5;250m    [39mCompactionStats()[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mmicros([38;5;241m0[39m),[38;5;250m [39mbytes_read([38;5;241m0[39m),[38;5;250m [39mbytes_written([38;5;241m0[39m)[38;5;250m [39m{}
    92           : 
[91mâ†’   93 [2083 â†’ 2079]:[0m [91m[38;5;250m    [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mAdd[39m([38;5;28;01mconst[39;00m[38;5;250m [39mCompactionStats[38;5;241m&[39m[38;5;250m [39mc)[38;5;250m [39m{[0m
    94           : [38;5;250m      [39mthis[38;5;241m-[39m[38;5;241m>[39mmicros[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mc.micros;
    95           : [38;5;250m      [39mthis[38;5;241m-[39m[38;5;241m>[39mbytes_read[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mc.bytes_read;
    96           : [38;5;250m      [39mthis[38;5;241m-[39m[38;5;241m>[39mbytes_written[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mc.bytes_written;
    97           : [38;5;250m    [39m}
    98           : 

........................................

   149           : [38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mOpenCompactionOutputFile[39m(CompactionState[38;5;241m*[39m[38;5;250m [39mcompact);
   150           : [38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mFinishCompactionOutputFile[39m(CompactionState[38;5;241m*[39m[38;5;250m [39mcompact,[38;5;250m [39mIterator[38;5;241m*[39m[38;5;250m [39minput);
   151           : [38;5;250m  [39mStatus[38;5;250m [39mInstallCompactionResults(CompactionState[38;5;241m*[39m[38;5;250m [39mcompact)
   152           : [38;5;250m      [39mEXCLUSIVE_LOCKS_REQUIRED(mutex_);
   153           : 
[91mâ†’  154 [3668 â†’ 3670]:[0m [91m[38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39m[38;5;21muser_comparator[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
   155           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39minternal_comparator_.user_comparator();
   156           : [38;5;250m  [39m}
   157           : 
   158           : [38;5;250m  [39m[38;5;66;03m// Constant after construction[39;00m
   159           : [38;5;250m  [39mEnv[38;5;241m*[39m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39menv_;

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/dbformat.cc ===
Lines with coverage differences:

Lines with different hit counts: 16, 17, 18, 19, 22, 48, 52, 54, 57, 59, 61, 62, 67, 68, 73, 82, 85, 89, 90, 92, 96, 97, 103, 105, 107, 109, 110

Detailed differences with context:
============================================================
    11           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"port/port.h"[39;00m
    12           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/coding.h"[39;00m
    13           : 
    14           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
    15           : 
[91mâ†’   16 [10967 â†’ 10959]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39m[38;5;21mPackSequenceAndType[39m([38;5;125muint64_t[39m[38;5;250m [39mseq,[38;5;250m [39mValueType[38;5;250m [39mt)[38;5;250m [39m{[0m
[91mâ†’   17 [10967 â†’ 10959]:[0m [91m[38;5;250m  [39massert(seq[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39mkMaxSequenceNumber);[0m
[91mâ†’   18 [10967 â†’ 10959]:[0m [91m[38;5;250m  [39massert(t[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39mkValueTypeForSeek);[0m
[91mâ†’   19 [10967 â†’ 10959]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(seq[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m8[39m)[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mt;[0m
    20           : }
    21           : 
[91mâ†’   22 [9500 â†’ 9493]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mAppendInternalKey[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mresult,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mParsedInternalKey[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m{[0m
    23           : [38;5;250m  [39mresult[38;5;241m-[39m[38;5;241m>[39mappend(key.user_key.data(),[38;5;250m [39mkey.user_key.size());
    24           : [38;5;250m  [39mPutFixed64(result,[38;5;250m [39mPackSequenceAndType(key.sequence,[38;5;250m [39mkey.type));
    25           : }
    26           : 
    27           : std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mParsedInternalKey::DebugString[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{

........................................

    43           : 
    44           : [38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mInternalKeyComparator::Name[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{
    45           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;124m"[39m[38;5;124mleveldb.InternalKeyComparator[39m[38;5;124m"[39m;
    46           : }
    47           : 
[91mâ†’   48 [22444 â†’ 22200]:[0m [91m[38;5;125mint[39m[38;5;250m [39m[38;5;21mInternalKeyComparator::Compare[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39makey,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mbkey)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
    49           : [38;5;250m  [39m[38;5;66;03m// Order by:[39;00m
    50           : [38;5;250m  [39m[38;5;66;03m//    increasing user key (according to user-supplied comparator)[39;00m
    51           : [38;5;250m  [39m[38;5;66;03m//    decreasing sequence number[39;00m
[91mâ†’   52 [22444 â†’ 22200]:[0m [91m[38;5;250m  [39m[38;5;66;03m//    decreasing type (though sequence# should be enough to disambiguate)[39;00m[0m
    53           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39muser_comparator_[38;5;241m-[39m[38;5;241m>[39mCompare(ExtractUserKey(akey),[38;5;250m [39mExtractUserKey(bkey));
[91mâ†’   54 [11993 â†’ 11769]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
    55           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39manum[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mDecodeFixed64(akey.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39makey.size()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m8[39m);
    56           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mbnum[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mDecodeFixed64(bkey.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mbkey.size()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m8[39m);
[91mâ†’   57 [1906 â†’ 1885]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(anum[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mbnum)[38;5;250m [39m{[0m
    58           : [38;5;250m      [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m-1[39m;
[91mâ†’   59 [5445 â†’ 5343]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(anum[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mbnum)[38;5;250m [39m{[0m
    60           : [38;5;250m      [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m+[39m[38;5;241m1[39m;
[91mâ†’   61 [11993 â†’ 11769]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   62 [22444 â†’ 22200]:[0m [91m[38;5;250m  [39m}[0m
    63           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mr;
    64           : }
    65           : 
    66           : [38;5;125mvoid[39m[38;5;250m [39mInternalKeyComparator[38;5;241m:[39m[38;5;241m:[39mFindShortestSeparator(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mstart,
[91mâ†’   67 [118 â†’ 114]:[0m [91m[38;5;250m                                                  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mlimit)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’   68 [118 â†’ 114]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Attempt to shorten the user portion of the key[39;00m[0m
    69           : [38;5;250m  [39mSlice[38;5;250m [39muser_start[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mExtractUserKey([38;5;241m*[39mstart);
    70           : [38;5;250m  [39mSlice[38;5;250m [39muser_limit[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mExtractUserKey(limit);
    71           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mtmp[39m(user_start.data(),[38;5;250m [39muser_start.size());
    72           : [38;5;250m  [39muser_comparator_[38;5;241m-[39m[38;5;241m>[39mFindShortestSeparator([38;5;241m&[39mtmp,[38;5;250m [39muser_limit);
[91mâ†’   73 [118 â†’ 114]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(tmp.size()[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39muser_start.size()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
    74           : [38;5;250m      [39muser_comparator_[38;5;241m-[39m[38;5;241m>[39mCompare(user_start,[38;5;250m [39mtmp)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
    75           : [38;5;250m    [39m[38;5;66;03m// User key has become shorter physically, but larger logically.[39;00m
    76           : [38;5;250m    [39m[38;5;66;03m// Tack on the earliest possible number to the shortened user key.[39;00m
    77           : [38;5;250m    [39mPutFixed64([38;5;241m&[39mtmp,
    78           : [38;5;250m               [39mPackSequenceAndType(kMaxSequenceNumber,[38;5;250m [39mkValueTypeForSeek));
    79           : [38;5;250m    [39massert([38;5;28;01mthis[39;00m[38;5;241m-[39m[38;5;241m>[39mCompare([38;5;241m*[39mstart,[38;5;250m [39mtmp)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m);
    80           : [38;5;250m    [39massert([38;5;28;01mthis[39;00m[38;5;241m-[39m[38;5;241m>[39mCompare(tmp,[38;5;250m [39mlimit)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m);
    81           : [38;5;250m    [39mstart[38;5;241m-[39m[38;5;241m>[39mswap(tmp);
[91mâ†’   82 [118 â†’ 114]:[0m [91m[38;5;250m  [39m}[0m
    83           : }
    84           : 
[91mâ†’   85 [1697 â†’ 1695]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mInternalKeyComparator::FindShortSuccessor[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mkey)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
    86           : [38;5;250m  [39mSlice[38;5;250m [39muser_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mExtractUserKey([38;5;241m*[39mkey);
    87           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mtmp[39m(user_key.data(),[38;5;250m [39muser_key.size());
    88           : [38;5;250m  [39muser_comparator_[38;5;241m-[39m[38;5;241m>[39mFindShortSuccessor([38;5;241m&[39mtmp);
[91mâ†’   89 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(tmp.size()[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39muser_key.size()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’   90 [293 â†’ 292]:[0m [91m[38;5;250m      [39muser_comparator_[38;5;241m-[39m[38;5;241m>[39mCompare(user_key,[38;5;250m [39mtmp)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
    91           : [38;5;250m    [39m[38;5;66;03m// User key has become shorter physically, but larger logically.[39;00m
[91mâ†’   92 [293 â†’ 292]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Tack on the earliest possible number to the shortened user key.[39;00m[0m
    93           : [38;5;250m    [39mPutFixed64([38;5;241m&[39mtmp,
    94           : [38;5;250m               [39mPackSequenceAndType(kMaxSequenceNumber,[38;5;250m [39mkValueTypeForSeek));
    95           : [38;5;250m    [39massert([38;5;28;01mthis[39;00m[38;5;241m-[39m[38;5;241m>[39mCompare([38;5;241m*[39mkey,[38;5;250m [39mtmp)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m);
[91mâ†’   96 [293 â†’ 292]:[0m [91m[38;5;250m    [39mkey[38;5;241m-[39m[38;5;241m>[39mswap(tmp);[0m
[91mâ†’   97 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m}[0m
    98           : }
    99           : 
   100           : [38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mInternalFilterPolicy::Name[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39muser_policy_[38;5;241m-[39m[38;5;241m>[39mName();[38;5;250m [39m}
   101           : 
   102           : [38;5;125mvoid[39m[38;5;250m [39mInternalFilterPolicy[38;5;241m:[39m[38;5;241m:[39mCreateFilter([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39mkeys,[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mn,
[91mâ†’  103 [1816 â†’ 1810]:[0m [91m[38;5;250m                                        [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mdst)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
   104           : [38;5;250m  [39m[38;5;66;03m// We rely on the fact that the code in table.cc does not mind us[39;00m
[91mâ†’  105 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m[38;5;66;03m// adjusting keys[].[39;00m[0m
   106           : [38;5;250m  [39mSlice[38;5;241m*[39m[38;5;250m [39mmkey[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mconst_cast[39;00m[38;5;241m<[39mSlice[38;5;241m*[39m[38;5;241m>[39m(keys);
[91mâ†’  107 [2324 â†’ 2303]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mn;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   108           : [38;5;250m    [39mmkey[i][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mExtractUserKey(keys[i]);
[91mâ†’  109 [2324 â†’ 2303]:[0m [91m[38;5;250m    [39m[38;5;66;03m// TODO(sanjay): Suppress dups?[39;00m[0m
[91mâ†’  110 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m}[0m
   111           : [38;5;250m  [39muser_policy_[38;5;241m-[39m[38;5;241m>[39mCreateFilter(keys,[38;5;250m [39mn,[38;5;250m [39mdst);
   112           : }
   113           : 
   114           : [38;5;125mbool[39m[38;5;250m [39m[38;5;21mInternalFilterPolicy::KeyMayMatch[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mf)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{
   115           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39muser_policy_[38;5;241m-[39m[38;5;241m>[39mKeyMayMatch(ExtractUserKey(key),[38;5;250m [39mf);

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/dbformat.h ===
Lines with coverage differences:

Lines with different hit counts: 95, 96, 97, 140, 144, 149, 150, 151, 167, 172, 174, 175, 180

Detailed differences with context:
============================================================
    90           : [38;5;66;03m//[39;00m
    91           : [38;5;66;03m// On error, returns false, leaves "*result" in an undefined state.[39;00m
    92           : [38;5;125mbool[39m[38;5;250m [39m[38;5;21mParseInternalKey[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39minternal_key,[38;5;250m [39mParsedInternalKey[38;5;241m*[39m[38;5;250m [39mresult);
    93           : 
    94           : [38;5;66;03m// Returns the user key portion of an internal key.[39;00m
[91mâ†’   95 [85107 â†’ 84637]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39mSlice[38;5;250m [39m[38;5;21mExtractUserKey[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39minternal_key)[38;5;250m [39m{[0m
[91mâ†’   96 [85107 â†’ 84637]:[0m [91m[38;5;250m  [39massert(internal_key.size()[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m8[39m);[0m
[91mâ†’   97 [85107 â†’ 84637]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mSlice(internal_key.data(),[38;5;250m [39minternal_key.size()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m8[39m);[0m
    98           : }
    99           : 
   100           : [38;5;66;03m// A comparator for internal keys that uses a specified comparator for[39;00m
   101           : [38;5;66;03m// the user key portion and breaks ties by decreasing sequence number.[39;00m
   102           : class[38;5;250m [39mInternalKeyComparator[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mpublic[38;5;250m [39mComparator[38;5;250m [39m{

........................................

   135           : [38;5;250m [39mprivate[38;5;241m:[39m
   136           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mrep_;
   137           : 
   138           : [38;5;250m [39mpublic[38;5;241m:[39m
   139           : [38;5;250m  [39mInternalKey()[38;5;250m [39m{}[38;5;250m  [39m[38;5;66;03m// Leave rep_ as empty to indicate it is invalid[39;00m
[91mâ†’  140 [9500 â†’ 9493]:[0m [91m[38;5;250m  [39mInternalKey([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39muser_key,[38;5;250m [39mSequenceNumber[38;5;250m [39ms,[38;5;250m [39mValueType[38;5;250m [39mt)[38;5;250m [39m{[0m
   141           : [38;5;250m    [39mAppendInternalKey([38;5;241m&[39mrep_,[38;5;250m [39mParsedInternalKey(user_key,[38;5;250m [39ms,[38;5;250m [39mt));
   142           : [38;5;250m  [39m}
   143           : 
[91mâ†’  144 [5357 â†’ 5330]:[0m [91m[38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mDecodeFrom[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39ms)[38;5;250m [39m{[0m
   145           : [38;5;250m    [39mrep_.assign(s.data(),[38;5;250m [39ms.size());
   146           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;241m![39mrep_.empty();
   147           : [38;5;250m  [39m}
   148           : 
[91mâ†’  149 [29038 â†’ 28807]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mEncode[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’  150 [29038 â†’ 28807]:[0m [91m[38;5;250m    [39massert([38;5;241m![39mrep_.empty());[0m
[91mâ†’  151 [29038 â†’ 28807]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mrep_;[0m
   152           : [38;5;250m  [39m}
   153           : 
   154           : [38;5;250m  [39mSlice[38;5;250m [39m[38;5;21muser_key[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mExtractUserKey(rep_);[38;5;250m [39m}
   155           : 
   156           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSetFrom[39m([38;5;28;01mconst[39;00m[38;5;250m [39mParsedInternalKey[38;5;241m&[39m[38;5;250m [39mp)[38;5;250m [39m{

........................................

   162           : 
   163           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mDebugString[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m;
   164           : };
   165           : 
   166           : [38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mInternalKeyComparator[38;5;241m:[39m[38;5;241m:[39mCompare([38;5;28;01mconst[39;00m[38;5;250m [39mInternalKey[38;5;241m&[39m[38;5;250m [39ma,
[91mâ†’  167 [3832 â†’ 3823]:[0m [91m[38;5;250m                                          [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKey[38;5;241m&[39m[38;5;250m [39mb)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
   168           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mCompare(a.Encode(),[38;5;250m [39mb.Encode());
   169           : }
   170           : 
   171           : [38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39mParseInternalKey([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39minternal_key,
[91mâ†’  172 [16635 â†’ 16636]:[0m [91m[38;5;250m                             [39mParsedInternalKey[38;5;241m*[39m[38;5;250m [39mresult)[38;5;250m [39m{[0m
   173           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mn[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minternal_key.size();
[91mâ†’  174 [16635 â†’ 16636]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(n[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m8[39m)[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;[0m
[91mâ†’  175 [16635 â†’ 16636]:[0m [91m[38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39mnum[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mDecodeFixed64(internal_key.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mn[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m8[39m);[0m
   176           : [38;5;250m  [39m[38;5;125muint8_t[39m[38;5;250m [39mc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnum[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m0xff[39m;
   177           : [38;5;250m  [39mresult[38;5;241m-[39m[38;5;241m>[39msequence[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnum[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m8[39m;
   178           : [38;5;250m  [39mresult[38;5;241m-[39m[38;5;241m>[39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39mValueType[38;5;241m>[39m(c);
   179           : [38;5;250m  [39mresult[38;5;241m-[39m[38;5;241m>[39muser_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(internal_key.data(),[38;5;250m [39mn[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m8[39m);
[91mâ†’  180 [16635 â†’ 16636]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(c[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(kTypeValue));[0m
   181           : }
   182           : 
   183           : [38;5;66;03m// A helper class useful for DBImpl::Get()[39;00m
   184           : class[38;5;250m [39mLookupKey[38;5;250m [39m{
   185           : [38;5;250m [39mpublic[38;5;241m:[39m

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/filename.cc ===
Lines with coverage differences:

Lines with different hit counts: 21, 28, 29, 30, 33, 34, 35, 79, 81, 84, 87, 90, 95, 98, 99, 101, 103, 105, 107, 108, 109, 111, 117, 118, 119, 120

Detailed differences with context:
============================================================
    16           : [38;5;66;03m// A utility routine: write "data" to the named file and Sync() it.[39;00m
    17           : Status[38;5;250m [39mWriteStringToFileSync(Env[38;5;241m*[39m[38;5;250m [39menv,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mdata,
    18           : [38;5;250m                             [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfname);
    19           : 
    20           : [38;5;28;01mstatic[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mMakeFileName([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mdbname,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mnumber,
[91mâ†’   21 [10925 â†’ 10920]:[0m [91m[38;5;250m                                [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39msuffix)[38;5;250m [39m{[0m
    22           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;250m [39mbuf[[38;5;241m100[39m];
    23           : [38;5;250m  [39msnprintf(buf,[38;5;250m [39m[38;5;28;01msizeof[39;00m(buf),[38;5;250m [39m[38;5;124m"[39m[38;5;124m/%06llu.%s[39m[38;5;124m"[39m,
    24           : [38;5;250m           [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125munsigned[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;250m [39m[38;5;125mlong[39m[38;5;241m>[39m(number),[38;5;250m [39msuffix);
    25           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mdbname[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mbuf;
    26           : }
    27           : 
[91mâ†’   28 [3864 â†’ 3866]:[0m [91mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mLogFileName[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mdbname,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mnumber)[38;5;250m [39m{[0m
[91mâ†’   29 [3864 â†’ 3866]:[0m [91m[38;5;250m  [39massert(number[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’   30 [3864 â†’ 3866]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mMakeFileName(dbname,[38;5;250m [39mnumber,[38;5;250m [39m[38;5;124m"[39m[38;5;124mlog[39m[38;5;124m"[39m);[0m
    31           : }
    32           : 
[91mâ†’   33 [4115 â†’ 4108]:[0m [91mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mTableFileName[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mdbname,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mnumber)[38;5;250m [39m{[0m
[91mâ†’   34 [4115 â†’ 4108]:[0m [91m[38;5;250m  [39massert(number[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’   35 [4115 â†’ 4108]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mMakeFileName(dbname,[38;5;250m [39mnumber,[38;5;250m [39m[38;5;124m"[39m[38;5;124mldb[39m[38;5;124m"[39m);[0m
    36           : }
    37           : 
    38           : std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mSSTTableFileName[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mdbname,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mnumber)[38;5;250m [39m{
    39           : [38;5;250m  [39massert(number[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);
    40           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mMakeFileName(dbname,[38;5;250m [39mnumber,[38;5;250m [39m[38;5;124m"[39m[38;5;124msst[39m[38;5;124m"[39m);

........................................

    74           : [38;5;66;03m//    dbname/LOG[39;00m
    75           : [38;5;66;03m//    dbname/LOG.old[39;00m
    76           : [38;5;66;03m//    dbname/MANIFEST-[0-9]+[39;00m
    77           : [38;5;66;03m//    dbname/[0-9]+.(log|sst|ldb)[39;00m
    78           : [38;5;125mbool[39m[38;5;250m [39mParseFileName([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;241m*[39m[38;5;250m [39mnumber,
[91mâ†’   79 [43421 â†’ 43406]:[0m [91m[38;5;250m                   [39mFileType[38;5;241m*[39m[38;5;250m [39mtype)[38;5;250m [39m{[0m
    80           : [38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mrest[39m(filename);
[91mâ†’   81 [4978 â†’ 4976]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(rest[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mCURRENT[39m[38;5;124m"[39m)[38;5;250m [39m{[0m
    82           : [38;5;250m    [39m[38;5;241m*[39mnumber[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
    83           : [38;5;250m    [39m[38;5;241m*[39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkCurrentFile;
[91mâ†’   84 [4978 â†’ 4976]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(rest[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mLOCK[39m[38;5;124m"[39m)[38;5;250m [39m{[0m
    85           : [38;5;250m    [39m[38;5;241m*[39mnumber[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
    86           : [38;5;250m    [39m[38;5;241m*[39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkDBLockFile;
[91mâ†’   87 [6704 â†’ 6703]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(rest[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mLOG[39m[38;5;124m"[39m[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39mrest[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mLOG.old[39m[38;5;124m"[39m)[38;5;250m [39m{[0m
    88           : [38;5;250m    [39m[38;5;241m*[39mnumber[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
    89           : [38;5;250m    [39m[38;5;241m*[39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkInfoLogFile;
[91mâ†’   90 [6813 â†’ 6811]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(rest.starts_with([38;5;124m"[39m[38;5;124mMANIFEST-[39m[38;5;124m"[39m))[38;5;250m [39m{[0m
    91           : [38;5;250m    [39mrest.remove_prefix(strlen([38;5;124m"[39m[38;5;124mMANIFEST-[39m[38;5;124m"[39m));
    92           : [38;5;250m    [39m[38;5;125muint64_t[39m[38;5;250m [39mnum;
    93           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mConsumeDecimalNumber([38;5;241m&[39mrest,[38;5;250m [39m[38;5;241m&[39mnum))[38;5;250m [39m{
    94           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’   95 [6813 â†’ 6811]:[0m [91m[38;5;250m    [39m}[0m
    96           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mrest.empty())[38;5;250m [39m{
    97           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’   98 [6813 â†’ 6811]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   99 [6813 â†’ 6811]:[0m [91m[38;5;250m    [39m[38;5;241m*[39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkDescriptorFile;[0m
   100           : [38;5;250m    [39m[38;5;241m*[39mnumber[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnum;
[91mâ†’  101 [19948 â†’ 19940]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   102           : [38;5;250m    [39m[38;5;66;03m// Avoid strtoull() to keep filename format independent of the[39;00m
[91mâ†’  103 [19948 â†’ 19940]:[0m [91m[38;5;250m    [39m[38;5;66;03m// current locale[39;00m[0m
   104           : [38;5;250m    [39m[38;5;125muint64_t[39m[38;5;250m [39mnum;
[91mâ†’  105 [9956 â†’ 9952]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mConsumeDecimalNumber([38;5;241m&[39mrest,[38;5;250m [39m[38;5;241m&[39mnum))[38;5;250m [39m{[0m
   106           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’  107 [9992 â†’ 9988]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  108 [9992 â†’ 9988]:[0m [91m[38;5;250m    [39mSlice[38;5;250m [39msuffix[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mrest;[0m
[91mâ†’  109 [5827 â†’ 5826]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(suffix[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mSlice([38;5;124m"[39m[38;5;124m.log[39m[38;5;124m"[39m))[38;5;250m [39m{[0m
   110           : [38;5;250m      [39m[38;5;241m*[39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkLogFile;
[91mâ†’  111 [4165 â†’ 4162]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(suffix[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mSlice([38;5;124m"[39m[38;5;124m.sst[39m[38;5;124m"[39m)[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39msuffix[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mSlice([38;5;124m"[39m[38;5;124m.ldb[39m[38;5;124m"[39m))[38;5;250m [39m{[0m
   112           : [38;5;250m      [39m[38;5;241m*[39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkTableFile;
   113           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(suffix[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mSlice([38;5;124m"[39m[38;5;124m.dbtmp[39m[38;5;124m"[39m))[38;5;250m [39m{
   114           : [38;5;250m      [39m[38;5;241m*[39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkTempFile;
   115           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   116           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’  117 [9992 â†’ 9988]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  118 [9992 â†’ 9988]:[0m [91m[38;5;250m    [39m[38;5;241m*[39mnumber[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnum;[0m
[91mâ†’  119 [33465 â†’ 33454]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  120 [43421 â†’ 43406]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;[0m
   121           : }
   122           : 
   123           : Status[38;5;250m [39mSetCurrentFile(Env[38;5;241m*[39m[38;5;250m [39menv,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mdbname,
   124           : [38;5;250m                      [39m[38;5;125muint64_t[39m[38;5;250m [39mdescriptor_number)[38;5;250m [39m{
   125           : [38;5;250m  [39m[38;5;66;03m// Remove leading "dbname/" and add newline to manifest file name[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/log_reader.cc ===
Lines with coverage differences:

Lines with different hit counts: 56, 61, 62, 63, 67, 69, 71, 76, 79, 89, 90, 92, 101, 108, 117, 123, 127, 129, 132, 136, 144, 150, 169, 170, 173, 189, 190, 191, 192, 193, 202, 204, 205, 206, 210, 213, 214, 216, 217, 233, 234, 241, 243, 244, 256, 258, 259, 261, 262, 266, 267, 268, 269, 270

Detailed differences with context:
============================================================
    51           : [38;5;250m  [39m}
    52           : 
    53           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
    54           : }
    55           : 
[91mâ†’   56 [6558 â†’ 6560]:[0m [91m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mReader::ReadRecord[39m(Slice[38;5;241m*[39m[38;5;250m [39mrecord,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mscratch)[38;5;250m [39m{[0m
    57           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(last_record_offset_[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39minitial_offset_)[38;5;250m [39m{
    58           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mSkipToInitialBlock())[38;5;250m [39m{
    59           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
    60           : [38;5;250m    [39m}
[91mâ†’   61 [6558 â†’ 6560]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   62 [6558 â†’ 6560]:[0m [91m[0m
[91mâ†’   63 [6558 â†’ 6560]:[0m [91m[38;5;250m  [39mscratch[38;5;241m-[39m[38;5;241m>[39mclear();[0m
    64           : [38;5;250m  [39mrecord[38;5;241m-[39m[38;5;241m>[39mclear();
    65           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39min_fragmented_record[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
    66           : [38;5;250m  [39m[38;5;66;03m// Record offset of the logical record that we're reading[39;00m
[91mâ†’   67 [6558 â†’ 6560]:[0m [91m[38;5;250m  [39m[38;5;66;03m// 0 is a dummy value to make compilers happy[39;00m[0m
    68           : [38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39mprospective_record_offset[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’   69 [6558 â†’ 6560]:[0m [91m[0m
    70           : [38;5;250m  [39mSlice[38;5;250m [39mfragment;
[91mâ†’   71 [86006 â†’ 87150]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;28mtrue[39m)[38;5;250m [39m{[0m
    72           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125munsigned[39m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mrecord_type[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mReadPhysicalRecord([38;5;241m&[39mfragment);
    73           : 
    74           : [38;5;250m    [39m[38;5;66;03m// ReadPhysicalRecord may have only had an empty trailer remaining in its[39;00m
    75           : [38;5;250m    [39m[38;5;66;03m// internal buffer. Calculate the offset of the next physical record now[39;00m
[91mâ†’   76 [86006 â†’ 87150]:[0m [91m[38;5;250m    [39m[38;5;66;03m// that it has returned, properly accounting for its header size.[39;00m[0m
    77           : [38;5;250m    [39m[38;5;125muint64_t[39m[38;5;250m [39mphysical_record_offset[38;5;250m [39m[38;5;241m=[39m
    78           : [38;5;250m        [39mend_of_buffer_offset_[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mbuffer_.size()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mkHeaderSize[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mfragment.size();
[91mâ†’   79 [86006 â†’ 87150]:[0m [91m[0m
    80           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(resyncing_)[38;5;250m [39m{
    81           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(record_type[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mkMiddleType)[38;5;250m [39m{
    82           : [38;5;250m        [39m[38;5;28;01mcontinue[39;00m;
    83           : [38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(record_type[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mkLastType)[38;5;250m [39m{
    84           : [38;5;250m        [39mresyncing_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
    85           : [38;5;250m        [39m[38;5;28;01mcontinue[39;00m;
    86           : [38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
    87           : [38;5;250m        [39mresyncing_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
    88           : [38;5;250m      [39m}
[91mâ†’   89 [86006 â†’ 87150]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   90 [86006 â†’ 87150]:[0m [91m[0m
    91           : [38;5;250m    [39m[38;5;28;01mswitch[39;00m[38;5;250m [39m(record_type)[38;5;250m [39m{
[91mâ†’   92 [3635 â†’ 3633]:[0m [91m[38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkFullType[39m:[0m
    93           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(in_fragmented_record)[38;5;250m [39m{
    94           : [38;5;250m          [39m[38;5;66;03m// Handle bug in earlier versions of log::Writer where[39;00m
    95           : [38;5;250m          [39m[38;5;66;03m// it could emit an empty kFirstType record at the tail end[39;00m
    96           : [38;5;250m          [39m[38;5;66;03m// of a block followed by a kFullType or kFirstType record[39;00m
    97           : [38;5;250m          [39m[38;5;66;03m// at the beginning of the next block.[39;00m
    98           : [38;5;250m          [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mscratch[38;5;241m-[39m[38;5;241m>[39mempty())[38;5;250m [39m{
    99           : [38;5;250m            [39mReportCorruption(scratch[38;5;241m-[39m[38;5;241m>[39msize(),[38;5;250m [39m[38;5;124m"[39m[38;5;124mpartial record without end(1)[39m[38;5;124m"[39m);
   100           : [38;5;250m          [39m}
[91mâ†’  101 [3635 â†’ 3633]:[0m [91m[38;5;250m        [39m}[0m
   102           : [38;5;250m        [39mprospective_record_offset[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mphysical_record_offset;
   103           : [38;5;250m        [39mscratch[38;5;241m-[39m[38;5;241m>[39mclear();
   104           : [38;5;250m        [39m[38;5;241m*[39mrecord[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfragment;
   105           : [38;5;250m        [39mlast_record_offset_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mprospective_record_offset;
   106           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
   107           : 
[91mâ†’  108 [239 â†’ 241]:[0m [91m[38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkFirstType[39m:[0m
   109           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(in_fragmented_record)[38;5;250m [39m{
   110           : [38;5;250m          [39m[38;5;66;03m// Handle bug in earlier versions of log::Writer where[39;00m
   111           : [38;5;250m          [39m[38;5;66;03m// it could emit an empty kFirstType record at the tail end[39;00m
   112           : [38;5;250m          [39m[38;5;66;03m// of a block followed by a kFullType or kFirstType record[39;00m
   113           : [38;5;250m          [39m[38;5;66;03m// at the beginning of the next block.[39;00m
   114           : [38;5;250m          [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mscratch[38;5;241m-[39m[38;5;241m>[39mempty())[38;5;250m [39m{
   115           : [38;5;250m            [39mReportCorruption(scratch[38;5;241m-[39m[38;5;241m>[39msize(),[38;5;250m [39m[38;5;124m"[39m[38;5;124mpartial record without end(2)[39m[38;5;124m"[39m);
   116           : [38;5;250m          [39m}
[91mâ†’  117 [239 â†’ 241]:[0m [91m[38;5;250m        [39m}[0m
   118           : [38;5;250m        [39mprospective_record_offset[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mphysical_record_offset;
   119           : [38;5;250m        [39mscratch[38;5;241m-[39m[38;5;241m>[39massign(fragment.data(),[38;5;250m [39mfragment.size());
   120           : [38;5;250m        [39min_fragmented_record[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   121           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
   122           : 
[91mâ†’  123 [79209 â†’ 80349]:[0m [91m[38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkMiddleType[39m:[0m
   124           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39min_fragmented_record)[38;5;250m [39m{
   125           : [38;5;250m          [39mReportCorruption(fragment.size(),
   126           : [38;5;250m                           [39m[38;5;124m"[39m[38;5;124mmissing start of fragmented record(1)[39m[38;5;124m"[39m);
[91mâ†’  127 [79209 â†’ 80349]:[0m [91m[38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   128           : [38;5;250m          [39mscratch[38;5;241m-[39m[38;5;241m>[39mappend(fragment.data(),[38;5;250m [39mfragment.size());
[91mâ†’  129 [79209 â†’ 80349]:[0m [91m[38;5;250m        [39m}[0m
   130           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
   131           : 
[91mâ†’  132 [239 â†’ 241]:[0m [91m[38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkLastType[39m:[0m
   133           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39min_fragmented_record)[38;5;250m [39m{
   134           : [38;5;250m          [39mReportCorruption(fragment.size(),
   135           : [38;5;250m                           [39m[38;5;124m"[39m[38;5;124mmissing start of fragmented record(2)[39m[38;5;124m"[39m);
[91mâ†’  136 [239 â†’ 241]:[0m [91m[38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   137           : [38;5;250m          [39mscratch[38;5;241m-[39m[38;5;241m>[39mappend(fragment.data(),[38;5;250m [39mfragment.size());
   138           : [38;5;250m          [39m[38;5;241m*[39mrecord[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice([38;5;241m*[39mscratch);
   139           : [38;5;250m          [39mlast_record_offset_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mprospective_record_offset;
   140           : [38;5;250m          [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
   141           : [38;5;250m        [39m}
   142           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
   143           : 
[91mâ†’  144 [2684 â†’ 2686]:[0m [91m[38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkEof[39m:[0m
   145           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(in_fragmented_record)[38;5;250m [39m{
   146           : [38;5;250m          [39m[38;5;66;03m// This can be caused by the writer dying immediately after[39;00m
   147           : [38;5;250m          [39m[38;5;66;03m// writing a physical record but before completing the next; don't[39;00m
   148           : [38;5;250m          [39m[38;5;66;03m// treat it as a corruption, just ignore the entire logical record.[39;00m
   149           : [38;5;250m          [39mscratch[38;5;241m-[39m[38;5;241m>[39mclear();
[91mâ†’  150 [2684 â†’ 2686]:[0m [91m[38;5;250m        [39m}[0m
   151           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
   152           : 
   153           : [38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkBadRecord[39m:
   154           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(in_fragmented_record)[38;5;250m [39m{
   155           : [38;5;250m          [39mReportCorruption(scratch[38;5;241m-[39m[38;5;241m>[39msize(),[38;5;250m [39m[38;5;124m"[39m[38;5;124merror in middle of record[39m[38;5;124m"[39m);

........................................

   164           : [38;5;250m        [39mReportCorruption(
   165           : [38;5;250m            [39m(fragment.size()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m(in_fragmented_record[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39mscratch[38;5;241m-[39m[38;5;241m>[39msize()[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;241m0[39m)),
   166           : [38;5;250m            [39mbuf);
   167           : [38;5;250m        [39min_fragmented_record[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
   168           : [38;5;250m        [39mscratch[38;5;241m-[39m[38;5;241m>[39mclear();
[91mâ†’  169 [239 â†’ 241]:[0m [91m[38;5;250m        [39m[38;5;28;01mbreak[39;00m;[0m
[91mâ†’  170 [86006 â†’ 87150]:[0m [91m[38;5;250m      [39m}[0m
   171           : [38;5;250m    [39m}
   172           : [38;5;250m  [39m}
[91mâ†’  173 [6558 â†’ 6560]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;[0m
   174           : }
   175           : 
   176           : [38;5;125muint64_t[39m[38;5;250m [39m[38;5;21mReader::LastRecordOffset[39m()[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mlast_record_offset_;[38;5;250m [39m}
   177           : 
   178           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mReader::ReportCorruption[39m([38;5;125muint64_t[39m[38;5;250m [39mbytes,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mreason)[38;5;250m [39m{

........................................

   184           : [38;5;250m      [39mend_of_buffer_offset_[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mbuffer_.size()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mbytes[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39minitial_offset_)[38;5;250m [39m{
   185           : [38;5;250m    [39mreporter_[38;5;241m-[39m[38;5;241m>[39mCorruption([38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125msize_t[39m[38;5;241m>[39m(bytes),[38;5;250m [39mreason);
   186           : [38;5;250m  [39m}
   187           : }
   188           : 
[91mâ†’  189 [86006 â†’ 87150]:[0m [91m[38;5;125munsigned[39m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39m[38;5;21mReader::ReadPhysicalRecord[39m(Slice[38;5;241m*[39m[38;5;250m [39mresult)[38;5;250m [39m{[0m
[91mâ†’  190 [168138 â†’ 170426]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;28mtrue[39m)[38;5;250m [39m{[0m
[91mâ†’  191 [84816 â†’ 85962]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(buffer_.size()[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mkHeaderSize)[38;5;250m [39m{[0m
[91mâ†’  192 [82132 â†’ 83276]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39meof_)[38;5;250m [39m{[0m
[91mâ†’  193 [82132 â†’ 83276]:[0m [91m[38;5;250m        [39m[38;5;66;03m// Last read was a full read, so this is a trailer to skip[39;00m[0m
   194           : [38;5;250m        [39mbuffer_.clear();
   195           : [38;5;250m        [39mStatus[38;5;250m [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfile_[38;5;241m-[39m[38;5;241m>[39mRead(kBlockSize,[38;5;250m [39m[38;5;241m&[39mbuffer_,[38;5;250m [39mbacking_store_);
   196           : [38;5;250m        [39mend_of_buffer_offset_[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mbuffer_.size();
   197           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   198           : [38;5;250m          [39mbuffer_.clear();
   199           : [38;5;250m          [39mReportDrop(kBlockSize,[38;5;250m [39mstatus);
   200           : [38;5;250m          [39meof_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   201           : [38;5;250m          [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mkEof;
[91mâ†’  202 [2684 â†’ 2686]:[0m [91m[38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(buffer_.size()[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mkBlockSize)[38;5;250m [39m{[0m
   203           : [38;5;250m          [39meof_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  204 [82132 â†’ 83276]:[0m [91m[38;5;250m        [39m}[0m
[91mâ†’  205 [82132 â†’ 83276]:[0m [91m[38;5;250m        [39m[38;5;28;01mcontinue[39;00m;[0m
[91mâ†’  206 [2684 â†’ 2686]:[0m [91m[38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   207           : [38;5;250m        [39m[38;5;66;03m// Note that if buffer_ is non-empty, we have a truncated header at the[39;00m
   208           : [38;5;250m        [39m[38;5;66;03m// end of the file, which can be caused by the writer crashing in the[39;00m
   209           : [38;5;250m        [39m[38;5;66;03m// middle of writing the header. Instead of considering this an error,[39;00m
[91mâ†’  210 [2684 â†’ 2686]:[0m [91m[38;5;250m        [39m[38;5;66;03m// just report EOF.[39;00m[0m
   211           : [38;5;250m        [39mbuffer_.clear();
   212           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mkEof;
[91mâ†’  213 [84816 â†’ 85962]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  214 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m}[0m
   215           : 
[91mâ†’  216 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Parse the header[39;00m[0m
[91mâ†’  217 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mheader[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbuffer_.data();[0m
   218           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39ma[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m(header[[38;5;241m4[39m])[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m0xff[39m;
   219           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mb[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m(header[[38;5;241m5[39m])[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m0xff[39m;
   220           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125munsigned[39m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mheader[[38;5;241m6[39m];
   221           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mlength[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39ma[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39m(b[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m8[39m);
   222           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(kHeaderSize[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mlength[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mbuffer_.size())[38;5;250m [39m{

........................................

   228           : [38;5;250m      [39m}
   229           : [38;5;250m      [39m[38;5;66;03m// If the end of the file has been reached without reading |length| bytes[39;00m
   230           : [38;5;250m      [39m[38;5;66;03m// of payload, assume the writer died in the middle of writing the record.[39;00m
   231           : [38;5;250m      [39m[38;5;66;03m// Don't report a corruption.[39;00m
   232           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mkEof;
[91mâ†’  233 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  234 [83322 â†’ 84464]:[0m [91m[0m
   235           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(type[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mkZeroType[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mlength[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   236           : [38;5;250m      [39m[38;5;66;03m// Skip zero length record without reporting any drops since[39;00m
   237           : [38;5;250m      [39m[38;5;66;03m// such records are produced by the mmap based writing code in[39;00m
   238           : [38;5;250m      [39m[38;5;66;03m// env_posix.cc that preallocates file regions.[39;00m
   239           : [38;5;250m      [39mbuffer_.clear();
   240           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mkBadRecord;
[91mâ†’  241 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m}[0m
   242           : 
[91mâ†’  243 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Check crc[39;00m[0m
[91mâ†’  244 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(checksum_)[38;5;250m [39m{[0m
   245           : [38;5;250m      [39m[38;5;125muint32_t[39m[38;5;250m [39mexpected_crc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc32c[38;5;241m:[39m[38;5;241m:[39mUnmask(DecodeFixed32(header));
   246           : [38;5;250m      [39m[38;5;125muint32_t[39m[38;5;250m [39mactual_crc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc32c[38;5;241m:[39m[38;5;241m:[39mValue(header[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m6[39m,[38;5;250m [39m[38;5;241m1[39m[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mlength);
   247           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(actual_crc[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mexpected_crc)[38;5;250m [39m{
   248           : [38;5;250m        [39m[38;5;66;03m// Drop the rest of the buffer since "length" itself may have[39;00m
   249           : [38;5;250m        [39m[38;5;66;03m// been corrupted and if we trust it, we could find some[39;00m

........................................

   251           : [38;5;250m        [39m[38;5;66;03m// like a valid log record.[39;00m
   252           : [38;5;250m        [39m[38;5;125msize_t[39m[38;5;250m [39mdrop_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbuffer_.size();
   253           : [38;5;250m        [39mbuffer_.clear();
   254           : [38;5;250m        [39mReportCorruption(drop_size,[38;5;250m [39m[38;5;124m"[39m[38;5;124mchecksum mismatch[39m[38;5;124m"[39m);
   255           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mkBadRecord;
[91mâ†’  256 [83322 â†’ 84464]:[0m [91m[38;5;250m      [39m}[0m
   257           : [38;5;250m    [39m}
[91mâ†’  258 [83322 â†’ 84464]:[0m [91m[0m
[91mâ†’  259 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39mbuffer_.remove_prefix(kHeaderSize[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mlength);[0m
   260           : 
[91mâ†’  261 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Skip physical record that started before initial_offset_[39;00m[0m
[91mâ†’  262 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(end_of_buffer_offset_[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mbuffer_.size()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mkHeaderSize[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mlength[38;5;250m [39m[38;5;241m<[39m[0m
   263           : [38;5;250m        [39minitial_offset_)[38;5;250m [39m{
   264           : [38;5;250m      [39mresult[38;5;241m-[39m[38;5;241m>[39mclear();
   265           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mkBadRecord;
[91mâ†’  266 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  267 [83322 â†’ 84464]:[0m [91m[0m
[91mâ†’  268 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(header[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkHeaderSize,[38;5;250m [39mlength);[0m
[91mâ†’  269 [83322 â†’ 84464]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mtype;[0m
[91mâ†’  270 [86006 â†’ 87150]:[0m [91m[38;5;250m  [39m}[0m
   271           : }
   272           : 
   273           : }[38;5;250m  [39m[38;5;66;03m// namespace log[39;00m
   274           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/log_writer.cc ===
Lines with coverage differences:

Lines with different hit counts: 34, 40, 43, 45, 54, 56, 58, 59, 60, 61, 64, 72, 73, 78, 79, 83, 84, 85, 87, 88, 93, 98, 100, 102, 104

Detailed differences with context:
============================================================
    29           : [38;5;250m  [39mInitTypeCrc(type_crc_);
    30           : }
    31           : 
    32           : Writer[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mWriter()[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mdefault[39;00m;
    33           : 
[91mâ†’   34 [8885 â†’ 8883]:[0m [91mStatus[38;5;250m [39m[38;5;21mWriter::AddRecord[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mslice)[38;5;250m [39m{[0m
    35           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mslice.data();
    36           : [38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39mleft[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mslice.size();
    37           : 
    38           : [38;5;250m  [39m[38;5;66;03m// Fragment the record if necessary and emit it.  Note that if slice[39;00m
    39           : [38;5;250m  [39m[38;5;66;03m// is empty, we still want to iterate once to emit a single[39;00m
[91mâ†’   40 [8885 â†’ 8883]:[0m [91m[38;5;250m  [39m[38;5;66;03m// zero-length record[39;00m[0m
    41           : [38;5;250m  [39mStatus[38;5;250m [39ms;
    42           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39mbegin[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’   43 [249995 â†’ 249993]:[0m [91m[38;5;250m  [39m[38;5;28;01mdo[39;00m[38;5;250m [39m{[0m
    44           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mleftover[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkBlockSize[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mblock_offset_;
[91mâ†’   45 [249995 â†’ 249993]:[0m [91m[38;5;250m    [39massert(leftover[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
    46           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(leftover[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mkHeaderSize)[38;5;250m [39m{
    47           : [38;5;250m      [39m[38;5;66;03m// Switch to a new block[39;00m
    48           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(leftover[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
    49           : [38;5;250m        [39m[38;5;66;03m// Fill the trailer (literal below relies on kHeaderSize being 7)[39;00m
    50           : [38;5;250m        [39m[38;5;28;01mstatic_assert[39;00m(kHeaderSize[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m7[39m,[38;5;250m [39m[38;5;124m"[39m[38;5;124m"[39m);
    51           : [38;5;250m        [39mdest_[38;5;241m-[39m[38;5;241m>[39mAppend(Slice([38;5;124m"[39m[38;5;130;01m\x00[39;00m[38;5;130;01m\x00[39;00m[38;5;130;01m\x00[39;00m[38;5;130;01m\x00[39;00m[38;5;130;01m\x00[39;00m[38;5;130;01m\x00[39;00m[38;5;124m"[39m,[38;5;250m [39mleftover));
    52           : [38;5;250m      [39m}
    53           : [38;5;250m      [39mblock_offset_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’   54 [249995 â†’ 249993]:[0m [91m[38;5;250m    [39m}[0m
    55           : 
[91mâ†’   56 [249995 â†’ 249993]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Invariant: we never leave < kHeaderSize bytes in a block.[39;00m[0m
    57           : [38;5;250m    [39massert(kBlockSize[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mblock_offset_[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mkHeaderSize[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);
[91mâ†’   58 [249995 â†’ 249993]:[0m [91m[0m
[91mâ†’   59 [249995 â†’ 249993]:[0m [91m[38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mavail[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkBlockSize[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mblock_offset_[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mkHeaderSize;[0m
[91mâ†’   60 [249995 â†’ 249993]:[0m [91m[38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mfragment_length[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(left[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mavail)[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39mleft[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mavail;[0m
[91mâ†’   61 [249995 â†’ 249993]:[0m [91m[0m
    62           : [38;5;250m    [39mRecordType[38;5;250m [39mtype;
    63           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39mend[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(left[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mfragment_length);
[91mâ†’   64 [8232 â†’ 8230]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(begin[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mend)[38;5;250m [39m{[0m
    65           : [38;5;250m      [39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkFullType;
    66           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(begin)[38;5;250m [39m{
    67           : [38;5;250m      [39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkFirstType;
    68           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(end)[38;5;250m [39m{
    69           : [38;5;250m      [39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkLastType;
    70           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
    71           : [38;5;250m      [39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkMiddleType;
[91mâ†’   72 [249995 â†’ 249993]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   73 [249995 â†’ 249993]:[0m [91m[0m
    74           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mEmitPhysicalRecord(type,[38;5;250m [39mptr,[38;5;250m [39mfragment_length);
    75           : [38;5;250m    [39mptr[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mfragment_length;
    76           : [38;5;250m    [39mleft[38;5;250m [39m[38;5;241m-[39m[38;5;241m=[39m[38;5;250m [39mfragment_length;
    77           : [38;5;250m    [39mbegin[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’   78 [8885 â†’ 8883]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(s.ok()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mleft[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’   79 [8885 â†’ 8883]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;[0m
    80           : }
    81           : 
    82           : Status[38;5;250m [39mWriter[38;5;241m:[39m[38;5;241m:[39mEmitPhysicalRecord(RecordType[38;5;250m [39mt,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mptr,
[91mâ†’   83 [249995 â†’ 249993]:[0m [91m[38;5;250m                                  [39m[38;5;125msize_t[39m[38;5;250m [39mlength)[38;5;250m [39m{[0m
[91mâ†’   84 [249995 â†’ 249993]:[0m [91m[38;5;250m  [39massert(length[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0xffff[39m);[38;5;250m  [39m[38;5;66;03m// Must fit in two bytes[39;00m[0m
[91mâ†’   85 [249995 â†’ 249993]:[0m [91m[38;5;250m  [39massert(block_offset_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkHeaderSize[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mlength[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39mkBlockSize);[0m
    86           : 
[91mâ†’   87 [249995 â†’ 249993]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Format the header[39;00m[0m
[91mâ†’   88 [249995 â†’ 249993]:[0m [91m[38;5;250m  [39m[38;5;125mchar[39m[38;5;250m [39mbuf[kHeaderSize];[0m
    89           : [38;5;250m  [39mbuf[[38;5;241m4[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mchar[39m[38;5;241m>[39m(length[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m0xff[39m);
    90           : [38;5;250m  [39mbuf[[38;5;241m5[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mchar[39m[38;5;241m>[39m(length[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m8[39m);
    91           : [38;5;250m  [39mbuf[[38;5;241m6[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mchar[39m[38;5;241m>[39m(t);
    92           : 
[91mâ†’   93 [249995 â†’ 249993]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Compute the crc of the record type and the payload.[39;00m[0m
    94           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mcrc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc32c[38;5;241m:[39m[38;5;241m:[39mExtend(type_crc_[t],[38;5;250m [39mptr,[38;5;250m [39mlength);
    95           : [38;5;250m  [39mcrc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc32c[38;5;241m:[39m[38;5;241m:[39mMask(crc);[38;5;250m  [39m[38;5;66;03m// Adjust for storage[39;00m
    96           : [38;5;250m  [39mEncodeFixed32(buf,[38;5;250m [39mcrc);
    97           : 
[91mâ†’   98 [249995 â†’ 249993]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Write the header and the payload[39;00m[0m
    99           : [38;5;250m  [39mStatus[38;5;250m [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdest_[38;5;241m-[39m[38;5;241m>[39mAppend(Slice(buf,[38;5;250m [39mkHeaderSize));
[91mâ†’  100 [249995 â†’ 249993]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   101           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdest_[38;5;241m-[39m[38;5;241m>[39mAppend(Slice(ptr,[38;5;250m [39mlength));
[91mâ†’  102 [249995 â†’ 249993]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   103           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdest_[38;5;241m-[39m[38;5;241m>[39mFlush();
[91mâ†’  104 [249995 â†’ 249993]:[0m [91m[38;5;250m    [39m}[0m
   105           : [38;5;250m  [39m}
   106           : [38;5;250m  [39mblock_offset_[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mkHeaderSize[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mlength;
   107           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
   108           : }
   109           : 

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/memtable.cc ===
Lines with coverage differences:

Lines with different hit counts: 14, 62, 77, 82, 98

Detailed differences with context:
============================================================
     9           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"leveldb/iterator.h"[39;00m
    10           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/coding.h"[39;00m
    11           : 
    12           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
    13           : 
[91mâ†’   14 [24940 â†’ 24883]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39mSlice[38;5;250m [39m[38;5;21mGetLengthPrefixedSlice[39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mdata)[38;5;250m [39m{[0m
    15           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mlen;
    16           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdata;
    17           : [38;5;250m  [39mp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetVarint32Ptr(p,[38;5;250m [39mp[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m5[39m,[38;5;250m [39m[38;5;241m&[39mlen);[38;5;250m  [39m[38;5;66;03m// +5: we assume "p" is not corrupted[39;00m
    18           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mSlice(p,[38;5;250m [39mlen);
    19           : }

........................................

    57           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToFirst[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39miter_.SeekToFirst();[38;5;250m [39m}
    58           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToLast[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39miter_.SeekToLast();[38;5;250m [39m}
    59           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mNext[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39miter_.Next();[38;5;250m [39m}
    60           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPrev[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39miter_.Prev();[38;5;250m [39m}
    61           : [38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mkey[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mGetLengthPrefixedSlice(iter_.key());[38;5;250m [39m}
[91mâ†’   62 [3980 â†’ 3961]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mvalue[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
    63           : [38;5;250m    [39mSlice[38;5;250m [39mkey_slice[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetLengthPrefixedSlice(iter_.key());
    64           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mGetLengthPrefixedSlice(key_slice.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkey_slice.size());
    65           : [38;5;250m  [39m}
    66           : 
    67           : [38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mstatus[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();[38;5;250m [39m}

........................................

    72           : };
    73           : 
    74           : Iterator[38;5;241m*[39m[38;5;250m [39m[38;5;21mMemTable::NewIterator[39m()[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mMemTableIterator([38;5;241m&[39mtable_);[38;5;250m [39m}
    75           : 
    76           : [38;5;125mvoid[39m[38;5;250m [39mMemTable[38;5;241m:[39m[38;5;241m:[39mAdd(SequenceNumber[38;5;250m [39ms,[38;5;250m [39mValueType[38;5;250m [39mtype,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,
[91mâ†’   77 [3779 â†’ 3781]:[0m [91m[38;5;250m                   [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
    78           : [38;5;250m  [39m[38;5;66;03m// Format of an entry is concatenation of:[39;00m
    79           : [38;5;250m  [39m[38;5;66;03m//  key_size     : varint32 of internal_key.size()[39;00m
    80           : [38;5;250m  [39m[38;5;66;03m//  key bytes    : char[internal_key.size()][39;00m
    81           : [38;5;250m  [39m[38;5;66;03m//  value_size   : varint32 of value.size()[39;00m
[91mâ†’   82 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m[38;5;66;03m//  value bytes  : char[value.size()][39;00m[0m
    83           : [38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39mkey_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkey.size();
    84           : [38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39mval_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mvalue.size();
    85           : [38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39minternal_key_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkey_size[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m8[39m;
    86           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mencoded_len[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mVarintLength(internal_key_size)[38;5;250m [39m[38;5;241m+[39m
    87           : [38;5;250m                             [39minternal_key_size[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mVarintLength(val_size)[38;5;250m [39m[38;5;241m+[39m

........................................

    93           : [38;5;250m  [39mEncodeFixed64(p,[38;5;250m [39m(s[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m8[39m)[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mtype);
    94           : [38;5;250m  [39mp[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m8[39m;
    95           : [38;5;250m  [39mp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mEncodeVarint32(p,[38;5;250m [39mval_size);
    96           : [38;5;250m  [39mmemcpy(p,[38;5;250m [39mvalue.data(),[38;5;250m [39mval_size);
    97           : [38;5;250m  [39massert(p[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mval_size[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mbuf[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mencoded_len);
[91mâ†’   98 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39mtable_.Insert(buf);[0m
    99           : }
   100           : 
   101           : [38;5;125mbool[39m[38;5;250m [39m[38;5;21mMemTable::Get[39m([38;5;28;01mconst[39;00m[38;5;250m [39mLookupKey[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mvalue,[38;5;250m [39mStatus[38;5;241m*[39m[38;5;250m [39ms)[38;5;250m [39m{
   102           : [38;5;250m  [39mSlice[38;5;250m [39mmemkey[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkey.memtable_key();
   103           : [38;5;250m  [39mTable[38;5;241m:[39m[38;5;241m:[39mIterator[38;5;250m [39m[38;5;21miter[39m([38;5;241m&[39mtable_);

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/memtable.h ===
Lines with coverage differences:

Lines with different hit counts: 33, 35, 36, 38

Detailed differences with context:
============================================================
    28           : 
    29           : [38;5;250m  [39m[38;5;66;03m// Increase reference count.[39;00m
    30           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mRef[39m()[38;5;250m [39m{[38;5;250m [39m[38;5;241m+[39m[38;5;241m+[39mrefs_;[38;5;250m [39m}
    31           : 
    32           : [38;5;250m  [39m[38;5;66;03m// Drop reference count.  Delete if no more references exist.[39;00m
[91mâ†’   33 [7346 â†’ 7350]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mUnref[39m()[38;5;250m [39m{[0m
    34           : [38;5;250m    [39m[38;5;241m-[39m[38;5;241m-[39mrefs_;
[91mâ†’   35 [7346 â†’ 7350]:[0m [91m[38;5;250m    [39massert(refs_[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’   36 [3654 â†’ 3656]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(refs_[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
    37           : [38;5;250m      [39mdelete[38;5;250m [39mthis;
[91mâ†’   38 [7346 â†’ 7350]:[0m [91m[38;5;250m    [39m}[0m
    39           : [38;5;250m  [39m}
    40           : 
    41           : [38;5;250m  [39m[38;5;66;03m// Returns an estimate of the number of bytes of data in use by this[39;00m
    42           : [38;5;250m  [39m[38;5;66;03m// data structure. It is safe to call when MemTable is being modified.[39;00m
    43           : [38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39m[38;5;21mApproximateMemoryUsage[39m();

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/skiplist.h ===
Lines with coverage differences:

Lines with different hit counts: 104, 153, 154, 156, 157, 159, 160, 162, 163, 167, 168, 169, 171, 172, 173, 183, 190, 196, 201, 202, 203, 207, 208, 209, 242, 243, 246, 248, 250, 251, 255, 256, 257, 263, 266, 271, 272, 273, 278, 279, 280, 330, 331, 333, 337, 339, 343, 345, 346, 347, 348, 350, 357, 359, 360, 362, 364, 367

Detailed differences with context:
============================================================
    99           : [38;5;250m  [39m};
   100           : 
   101           : [38;5;250m [39mprivate[38;5;241m:[39m
   102           : [38;5;250m  [39m[38;5;28;01menum[39;00m[38;5;250m [39m{[38;5;250m [39mkMaxHeight[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m12[39m[38;5;250m [39m};
   103           : 
[91mâ†’  104 [11164 â†’ 11170]:[0m [91m[38;5;250m  [39m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39m[38;5;21mGetMaxHeight[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
   105           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mmax_height_.load(std[38;5;241m:[39m[38;5;241m:[39mmemory_order_relaxed);
   106           : [38;5;250m  [39m}
   107           : 
   108           : [38;5;250m  [39mNode[38;5;241m*[39m[38;5;250m [39m[38;5;21mNewNode[39m([38;5;28;01mconst[39;00m[38;5;250m [39mKey[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mheight);
   109           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39m[38;5;21mRandomHeight[39m();

........................................

   148           : 
   149           : [38;5;250m  [39mKey[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mkey;
   150           : 
   151           : [38;5;250m  [39m[38;5;66;03m// Accessors/mutators for links.  Wrapped in methods so we can[39;00m
   152           : [38;5;250m  [39m[38;5;66;03m// add the appropriate barriers as necessary.[39;00m
[91mâ†’  153 [15157 â†’ 15140]:[0m [91m[38;5;250m  [39mNode[38;5;241m*[39m[38;5;250m [39m[38;5;21mNext[39m([38;5;125mint[39m[38;5;250m [39mn)[38;5;250m [39m{[0m
[91mâ†’  154 [15157 â†’ 15140]:[0m [91m[38;5;250m    [39massert(n[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
   155           : [38;5;250m    [39m[38;5;66;03m// Use an 'acquire load' so that we observe a fully initialized[39;00m
[91mâ†’  156 [15157 â†’ 15140]:[0m [91m[38;5;250m    [39m[38;5;66;03m// version of the returned Node.[39;00m[0m
[91mâ†’  157 [15157 â†’ 15140]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mnext_[n].load(std[38;5;241m:[39m[38;5;241m:[39mmemory_order_acquire);[0m
   158           : [38;5;250m  [39m}
[91mâ†’  159 [49980 â†’ 50008]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSetNext[39m([38;5;125mint[39m[38;5;250m [39mn,[38;5;250m [39mNode[38;5;241m*[39m[38;5;250m [39mx)[38;5;250m [39m{[0m
[91mâ†’  160 [49980 â†’ 50008]:[0m [91m[38;5;250m    [39massert(n[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
   161           : [38;5;250m    [39m[38;5;66;03m// Use a 'release store' so that anybody who reads through this[39;00m
[91mâ†’  162 [49980 â†’ 50008]:[0m [91m[38;5;250m    [39m[38;5;66;03m// pointer observes a fully initialized version of the inserted node.[39;00m[0m
[91mâ†’  163 [49980 â†’ 50008]:[0m [91m[38;5;250m    [39mnext_[n].store(x,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmemory_order_release);[0m
   164           : [38;5;250m  [39m}
   165           : 
   166           : [38;5;250m  [39m[38;5;66;03m// No-barrier variants that can be safely used in a few locations.[39;00m
[91mâ†’  167 [6132 â†’ 6136]:[0m [91m[38;5;250m  [39mNode[38;5;241m*[39m[38;5;250m [39m[38;5;21mNoBarrier_Next[39m([38;5;125mint[39m[38;5;250m [39mn)[38;5;250m [39m{[0m
[91mâ†’  168 [6132 â†’ 6136]:[0m [91m[38;5;250m    [39massert(n[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’  169 [6132 â†’ 6136]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mnext_[n].load(std[38;5;241m:[39m[38;5;241m:[39mmemory_order_relaxed);[0m
   170           : [38;5;250m  [39m}
[91mâ†’  171 [6132 â†’ 6136]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mNoBarrier_SetNext[39m([38;5;125mint[39m[38;5;250m [39mn,[38;5;250m [39mNode[38;5;241m*[39m[38;5;250m [39mx)[38;5;250m [39m{[0m
[91mâ†’  172 [6132 â†’ 6136]:[0m [91m[38;5;250m    [39massert(n[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’  173 [6132 â†’ 6136]:[0m [91m[38;5;250m    [39mnext_[n].store(x,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmemory_order_relaxed);[0m
   174           : [38;5;250m  [39m}
   175           : 
   176           : [38;5;250m [39mprivate[38;5;241m:[39m
   177           : [38;5;250m  [39m[38;5;66;03m// Array of length equal to the node height.  next_[0] is lowest level link.[39;00m
   178           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39matomic[38;5;241m<[39mNode[38;5;241m*[39m[38;5;241m>[39m[38;5;250m [39mnext_[[38;5;241m1[39m];
   179           : };
   180           : 
   181           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
   182           : typename[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mNode[38;5;241m*[39m[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mNewNode(
[91mâ†’  183 [7433 â†’ 7437]:[0m [91m[38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mKey[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mheight)[38;5;250m [39m{[0m
   184           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mnode_memory[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39marena_[38;5;241m-[39m[38;5;241m>[39mAllocateAligned(
   185           : [38;5;250m      [39m[38;5;28;01msizeof[39;00m(Node)[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m(std[38;5;241m:[39m[38;5;241m:[39matomic[38;5;241m<[39mNode[38;5;241m*[39m[38;5;241m>[39m)[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m(height[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m));
   186           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mnew[38;5;250m [39m(node_memory)[38;5;250m [39mNode(key);
   187           : }
   188           : 
   189           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
[91mâ†’  190 [5381 â†’ 5382]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mIterator[38;5;241m:[39m[38;5;241m:[39mIterator([38;5;28;01mconst[39;00m[38;5;250m [39mSkipList[38;5;241m*[39m[38;5;250m [39mlist)[38;5;250m [39m{[0m
   191           : [38;5;250m  [39mlist_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlist;
   192           : [38;5;250m  [39mnode_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnullptr;
   193           : }
   194           : 
   195           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
[91mâ†’  196 [25612 â†’ 25538]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mIterator[38;5;241m:[39m[38;5;241m:[39mValid()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
   197           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mnode_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mnullptr;
   198           : }
   199           : 
   200           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
[91mâ†’  201 [10308 â†’ 10271]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mKey[38;5;241m&[39m[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mIterator[38;5;241m:[39m[38;5;241m:[39mkey()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’  202 [10308 â†’ 10271]:[0m [91m[38;5;250m  [39massert(Valid());[0m
[91mâ†’  203 [10308 â†’ 10271]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mnode_[38;5;241m-[39m[38;5;241m>[39mkey;[0m
   204           : }
   205           : 
   206           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
[91mâ†’  207 [3559 â†’ 3540]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mvoid[39m[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mIterator[38;5;241m:[39m[38;5;241m:[39mNext()[38;5;250m [39m{[0m
[91mâ†’  208 [3559 â†’ 3540]:[0m [91m[38;5;250m  [39massert(Valid());[0m
[91mâ†’  209 [3559 â†’ 3540]:[0m [91m[38;5;250m  [39mnode_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnode_[38;5;241m-[39m[38;5;241m>[39mNext([38;5;241m0[39m);[0m
   210           : }
   211           : 
   212           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
   213           : [38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mvoid[39m[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mIterator[38;5;241m:[39m[38;5;241m:[39mPrev()[38;5;250m [39m{
   214           : [38;5;250m  [39m[38;5;66;03m// Instead of using explicit "prev" links, we just search for the[39;00m

........................................

   237           : [38;5;250m    [39mnode_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnullptr;
   238           : [38;5;250m  [39m}
   239           : }
   240           : 
   241           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
[91mâ†’  242 [3779 â†’ 3781]:[0m [91m[38;5;125mint[39m[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mRandomHeight()[38;5;250m [39m{[0m
[91mâ†’  243 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Increase height with probability 1 in kBranching[39;00m[0m
   244           : [38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125munsigned[39m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mkBranching[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m4[39m;
   245           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mheight[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;
[91mâ†’  246 [2353 â†’ 2355]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(height[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mkMaxHeight[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m((rnd_.Next()[38;5;250m [39m[38;5;241m%[39m[38;5;250m [39mkBranching)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m))[38;5;250m [39m{[0m
   247           : [38;5;250m    [39mheight[38;5;241m+[39m[38;5;241m+[39m;
[91mâ†’  248 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m}[0m
   249           : [38;5;250m  [39massert(height[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);
[91mâ†’  250 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39massert(height[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39mkMaxHeight);[0m
[91mâ†’  251 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mheight;[0m
   252           : }
   253           : 
   254           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
[91mâ†’  255 [8201 â†’ 8203]:[0m [91m[38;5;125mbool[39m[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mKeyIsAfterNode([38;5;28;01mconst[39;00m[38;5;250m [39mKey[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39mNode[38;5;241m*[39m[38;5;250m [39mn)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’  256 [8201 â†’ 8203]:[0m [91m[38;5;250m  [39m[38;5;66;03m// null n is considered infinite[39;00m[0m
[91mâ†’  257 [8201 â†’ 8203]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(n[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mnullptr)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m(compare_(n[38;5;241m-[39m[38;5;241m>[39mkey,[38;5;250m [39mkey)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m);[0m
   258           : }
   259           : 
   260           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
   261           : typename[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mNode[38;5;241m*[39m
   262           : SkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mFindGreaterOrEqual([38;5;28;01mconst[39;00m[38;5;250m [39mKey[38;5;241m&[39m[38;5;250m [39mkey,
[91mâ†’  263 [5045 â†’ 5047]:[0m [91m[38;5;250m                                              [39mNode[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mprev)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
   264           : [38;5;250m  [39mNode[38;5;241m*[39m[38;5;250m [39mx[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mhead_;
   265           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetMaxHeight()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m;
[91mâ†’  266 [8201 â†’ 8203]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;28mtrue[39m)[38;5;250m [39m{[0m
   267           : [38;5;250m    [39mNode[38;5;241m*[39m[38;5;250m [39mnext[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mx[38;5;241m-[39m[38;5;241m>[39mNext(level);
   268           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(KeyIsAfterNode(key,[38;5;250m [39mnext))[38;5;250m [39m{
   269           : [38;5;250m      [39m[38;5;66;03m// Keep searching in this list[39;00m
   270           : [38;5;250m      [39mx[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnext;
[91mâ†’  271 [7161 â†’ 7163]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
[91mâ†’  272 [7161 â†’ 7163]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(prev[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mnullptr)[38;5;250m [39mprev[level][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mx;[0m
[91mâ†’  273 [5045 â†’ 5047]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(level[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   274           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mnext;
   275           : [38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   276           : [38;5;250m        [39m[38;5;66;03m// Switch to next list[39;00m
   277           : [38;5;250m        [39mlevel[38;5;241m-[39m[38;5;241m-[39m;
[91mâ†’  278 [7161 â†’ 7163]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  279 [8201 â†’ 8203]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  280 [5045 â†’ 5047]:[0m [91m[38;5;250m  [39m}[0m
   281           : }
   282           : 
   283           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
   284           : typename[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mNode[38;5;241m*[39m
   285           : SkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mFindLessThan([38;5;28;01mconst[39;00m[38;5;250m [39mKey[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{

........................................

   325           : SkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mSkipList(Comparator[38;5;250m [39mcmp,[38;5;250m [39mArena[38;5;241m*[39m[38;5;250m [39marena)
   326           : [38;5;250m    [39m[38;5;241m:[39m[38;5;250m [39mcompare_(cmp),
   327           : [38;5;250m      [39marena_(arena),
   328           : [38;5;250m      [39mhead_(NewNode([38;5;241m0[39m[38;5;250m [39m[38;5;66;03m/* any key will do */[39;00m,[38;5;250m [39mkMaxHeight)),
   329           : [38;5;250m      [39mmax_height_([38;5;241m1[39m),
[91mâ†’  330 [3654 â†’ 3656]:[0m [91m[38;5;250m      [39mrnd_([38;5;241m0xdeadbeef[39m)[38;5;250m [39m{[0m
[91mâ†’  331 [43848 â†’ 43872]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mkMaxHeight;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   332           : [38;5;250m    [39mhead_[38;5;241m-[39m[38;5;241m>[39mSetNext(i,[38;5;250m [39mnullptr);
[91mâ†’  333 [3654 â†’ 3656]:[0m [91m[38;5;250m  [39m}[0m
   334           : }
   335           : 
   336           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
[91mâ†’  337 [3779 â†’ 3781]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mInsert([38;5;28;01mconst[39;00m[38;5;250m [39mKey[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m{[0m
   338           : [38;5;250m  [39m[38;5;66;03m// TODO(opt): We can use a barrier-free variant of FindGreaterOrEqual()[39;00m
[91mâ†’  339 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m[38;5;66;03m// here since Insert() is externally synchronized.[39;00m[0m
   340           : [38;5;250m  [39mNode[38;5;241m*[39m[38;5;250m [39mprev[kMaxHeight];
   341           : [38;5;250m  [39mNode[38;5;241m*[39m[38;5;250m [39mx[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFindGreaterOrEqual(key,[38;5;250m [39mprev);
   342           : 
[91mâ†’  343 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Our data structure does not allow duplicate insertion[39;00m[0m
   344           : [38;5;250m  [39massert(x[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mnullptr[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39m[38;5;241m![39mEqual(key,[38;5;250m [39mx[38;5;241m-[39m[38;5;241m>[39mkey));
[91mâ†’  345 [3779 â†’ 3781]:[0m [91m[0m
[91mâ†’  346 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mheight[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mRandomHeight();[0m
[91mâ†’  347 [2340 â†’ 2342]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(height[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mGetMaxHeight())[38;5;250m [39m{[0m
[91mâ†’  348 [2340 â†’ 2342]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetMaxHeight();[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mheight;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   349           : [38;5;250m      [39mprev[i][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mhead_;
[91mâ†’  350 [2340 â†’ 2342]:[0m [91m[38;5;250m    [39m}[0m
   351           : [38;5;250m    [39m[38;5;66;03m// It is ok to mutate max_height_ without any synchronization[39;00m
   352           : [38;5;250m    [39m[38;5;66;03m// with concurrent readers.  A concurrent reader that observes[39;00m
   353           : [38;5;250m    [39m[38;5;66;03m// the new value of max_height_ will see either the old value of[39;00m
   354           : [38;5;250m    [39m[38;5;66;03m// new level pointers from head_ (nullptr), or a new value set in[39;00m
   355           : [38;5;250m    [39m[38;5;66;03m// the loop below.  In the former case the reader will[39;00m
   356           : [38;5;250m    [39m[38;5;66;03m// immediately drop to the next level since nullptr sorts after all[39;00m
[91mâ†’  357 [2340 â†’ 2342]:[0m [91m[38;5;250m    [39m[38;5;66;03m// keys.  In the latter case the reader will use the new node.[39;00m[0m
   358           : [38;5;250m    [39mmax_height_.store(height,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmemory_order_relaxed);
[91mâ†’  359 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  360 [3779 â†’ 3781]:[0m [91m[0m
   361           : [38;5;250m  [39mx[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mNewNode(key,[38;5;250m [39mheight);
[91mâ†’  362 [6132 â†’ 6136]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mheight;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   363           : [38;5;250m    [39m[38;5;66;03m// NoBarrier_SetNext() suffices since we will add a barrier when[39;00m
[91mâ†’  364 [6132 â†’ 6136]:[0m [91m[38;5;250m    [39m[38;5;66;03m// we publish a pointer to "x" in prev[i].[39;00m[0m
   365           : [38;5;250m    [39mx[38;5;241m-[39m[38;5;241m>[39mNoBarrier_SetNext(i,[38;5;250m [39mprev[i][38;5;241m-[39m[38;5;241m>[39mNoBarrier_Next(i));
   366           : [38;5;250m    [39mprev[i][38;5;241m-[39m[38;5;241m>[39mSetNext(i,[38;5;250m [39mx);
[91mâ†’  367 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m}[0m
   368           : }
   369           : 
   370           : template[38;5;250m [39m[38;5;241m<[39mtypename[38;5;250m [39mKey,[38;5;250m [39mclass[38;5;250m [39mComparator[38;5;241m>[39m
   371           : [38;5;125mbool[39m[38;5;250m [39mSkipList[38;5;241m<[39mKey,[38;5;250m [39mComparator[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mContains([38;5;28;01mconst[39;00m[38;5;250m [39mKey[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{
   372           : [38;5;250m  [39mNode[38;5;241m*[39m[38;5;250m [39mx[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFindGreaterOrEqual(key,[38;5;250m [39mnullptr);

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/table_cache.cc ===
Lines with coverage differences:

Lines with different hit counts: 19, 26, 42, 48, 58, 59, 61, 62, 68, 73, 74, 75, 80, 83, 84, 89, 90, 91, 96, 114

Detailed differences with context:
============================================================
    14           : [38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;21;01mTableAndFile[39;00m[38;5;250m [39m{
    15           : [38;5;250m  [39mRandomAccessFile[38;5;241m*[39m[38;5;250m [39mfile;
    16           : [38;5;250m  [39mTable[38;5;241m*[39m[38;5;250m [39mtable;
    17           : };
    18           : 
[91mâ†’   19 [2136 â†’ 2131]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDeleteEntry[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
    20           : [38;5;250m  [39mTableAndFile[38;5;241m*[39m[38;5;250m [39mtf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mTableAndFile[38;5;241m*[39m[38;5;241m>[39m(value);
    21           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mtf[38;5;241m-[39m[38;5;241m>[39mtable;
    22           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mtf[38;5;241m-[39m[38;5;241m>[39mfile;
    23           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mtf;
    24           : }
    25           : 
[91mâ†’   26 [3874 â†’ 3866]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mUnrefEntry[39m([38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg1,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg2)[38;5;250m [39m{[0m
    27           : [38;5;250m  [39mCache[38;5;241m*[39m[38;5;250m [39mcache[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mCache[38;5;241m*[39m[38;5;241m>[39m(arg1);
    28           : [38;5;250m  [39mCache[38;5;241m:[39m[38;5;241m:[39mHandle[38;5;241m*[39m[38;5;250m [39mh[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mCache[38;5;241m:[39m[38;5;241m:[39mHandle[38;5;241m*[39m[38;5;241m>[39m(arg2);
    29           : [38;5;250m  [39mcache[38;5;241m-[39m[38;5;241m>[39mRelease(h);
    30           : }
    31           : 

........................................

    37           : [38;5;250m      [39mcache_(NewLRUCache(entries))[38;5;250m [39m{}
    38           : 
    39           : TableCache[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mTableCache()[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mcache_;[38;5;250m [39m}
    40           : 
    41           : Status[38;5;250m [39mTableCache[38;5;241m:[39m[38;5;241m:[39mFindTable([38;5;125muint64_t[39m[38;5;250m [39mfile_number,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mfile_size,
[91mâ†’   42 [4419 â†’ 4411]:[0m [91m[38;5;250m                             [39mCache[38;5;241m:[39m[38;5;241m:[39mHandle[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mhandle)[38;5;250m [39m{[0m
    43           : [38;5;250m  [39mStatus[38;5;250m [39ms;
    44           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;250m [39mbuf[[38;5;28;01msizeof[39;00m(file_number)];
    45           : [38;5;250m  [39mEncodeFixed64(buf,[38;5;250m [39mfile_number);
    46           : [38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mkey[39m(buf,[38;5;250m [39m[38;5;28;01msizeof[39;00m(buf));
    47           : [38;5;250m  [39m[38;5;241m*[39mhandle[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcache_[38;5;241m-[39m[38;5;241m>[39mLookup(key);
[91mâ†’   48 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m*[39mhandle[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
    49           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mfname[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mTableFileName(dbname_,[38;5;250m [39mfile_number);
    50           : [38;5;250m    [39mRandomAccessFile[38;5;241m*[39m[38;5;250m [39mfile[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
    51           : [38;5;250m    [39mTable[38;5;241m*[39m[38;5;250m [39mtable[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
    52           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39menv_[38;5;241m-[39m[38;5;241m>[39mNewRandomAccessFile(fname,[38;5;250m [39m[38;5;241m&[39mfile);
    53           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39ms.ok())[38;5;250m [39m{
    54           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mold_fname[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSSTTableFileName(dbname_,[38;5;250m [39mfile_number);
    55           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(env_[38;5;241m-[39m[38;5;241m>[39mNewRandomAccessFile(old_fname,[38;5;250m [39m[38;5;241m&[39mfile).ok())[38;5;250m [39m{
    56           : [38;5;250m        [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
    57           : [38;5;250m      [39m}
[91mâ†’   58 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   59 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
    60           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mTable[38;5;241m:[39m[38;5;241m:[39mOpen(options_,[38;5;250m [39mfile,[38;5;250m [39mfile_size,[38;5;250m [39m[38;5;241m&[39mtable);
[91mâ†’   61 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   62 [2136 â†’ 2131]:[0m [91m[0m
    63           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39ms.ok())[38;5;250m [39m{
    64           : [38;5;250m      [39massert(table[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);
    65           : [38;5;250m      [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mfile;
    66           : [38;5;250m      [39m[38;5;66;03m// We do not cache error results so that if the error is transient,[39;00m
    67           : [38;5;250m      [39m[38;5;66;03m// or somebody repairs the file, we recover automatically.[39;00m
[91mâ†’   68 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
    69           : [38;5;250m      [39mTableAndFile[38;5;241m*[39m[38;5;250m [39mtf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mTableAndFile;
    70           : [38;5;250m      [39mtf[38;5;241m-[39m[38;5;241m>[39mfile[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfile;
    71           : [38;5;250m      [39mtf[38;5;241m-[39m[38;5;241m>[39mtable[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mtable;
    72           : [38;5;250m      [39m[38;5;241m*[39mhandle[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcache_[38;5;241m-[39m[38;5;241m>[39mInsert(key,[38;5;250m [39mtf,[38;5;250m [39m[38;5;241m1[39m,[38;5;250m [39m[38;5;241m&[39mDeleteEntry);
[91mâ†’   73 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   74 [4419 â†’ 4411]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   75 [4419 â†’ 4411]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;[0m
    76           : }
    77           : 
    78           : Iterator[38;5;241m*[39m[38;5;250m [39mTableCache[38;5;241m:[39m[38;5;241m:[39mNewIterator([38;5;28;01mconst[39;00m[38;5;250m [39mReadOptions[38;5;241m&[39m[38;5;250m [39moptions,
    79           : [38;5;250m                                  [39m[38;5;125muint64_t[39m[38;5;250m [39mfile_number,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mfile_size,
[91mâ†’   80 [3874 â†’ 3866]:[0m [91m[38;5;250m                                  [39mTable[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mtableptr)[38;5;250m [39m{[0m
    81           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(tableptr[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
    82           : [38;5;250m    [39m[38;5;241m*[39mtableptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’   83 [3874 â†’ 3866]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   84 [3874 â†’ 3866]:[0m [91m[0m
    85           : [38;5;250m  [39mCache[38;5;241m:[39m[38;5;241m:[39mHandle[38;5;241m*[39m[38;5;250m [39mhandle[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
    86           : [38;5;250m  [39mStatus[38;5;250m [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFindTable(file_number,[38;5;250m [39mfile_size,[38;5;250m [39m[38;5;241m&[39mhandle);
    87           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39ms.ok())[38;5;250m [39m{
    88           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mNewErrorIterator(s);
[91mâ†’   89 [3874 â†’ 3866]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   90 [3874 â†’ 3866]:[0m [91m[0m
[91mâ†’   91 [3874 â†’ 3866]:[0m [91m[38;5;250m  [39mTable[38;5;241m*[39m[38;5;250m [39mtable[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mTableAndFile[38;5;241m*[39m[38;5;241m>[39m(cache_[38;5;241m-[39m[38;5;241m>[39mValue(handle))[38;5;241m-[39m[38;5;241m>[39mtable;[0m
    92           : [38;5;250m  [39mIterator[38;5;241m*[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mtable[38;5;241m-[39m[38;5;241m>[39mNewIterator(options);
    93           : [38;5;250m  [39mresult[38;5;241m-[39m[38;5;241m>[39mRegisterCleanup([38;5;241m&[39mUnrefEntry,[38;5;250m [39mcache_,[38;5;250m [39mhandle);
    94           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(tableptr[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
    95           : [38;5;250m    [39m[38;5;241m*[39mtableptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mtable;
[91mâ†’   96 [3874 â†’ 3866]:[0m [91m[38;5;250m  [39m}[0m
    97           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;
    98           : }
    99           : 
   100           : Status[38;5;250m [39mTableCache[38;5;241m:[39m[38;5;241m:[39mGet([38;5;28;01mconst[39;00m[38;5;250m [39mReadOptions[38;5;241m&[39m[38;5;250m [39moptions,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mfile_number,
   101           : [38;5;250m                       [39m[38;5;125muint64_t[39m[38;5;250m [39mfile_size,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mk,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg,

........................................

   109           : [38;5;250m    [39mcache_[38;5;241m-[39m[38;5;241m>[39mRelease(handle);
   110           : [38;5;250m  [39m}
   111           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
   112           : }
   113           : 
[91mâ†’  114 [553 â†’ 556]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTableCache::Evict[39m([38;5;125muint64_t[39m[38;5;250m [39mfile_number)[38;5;250m [39m{[0m
   115           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;250m [39mbuf[[38;5;28;01msizeof[39;00m(file_number)];
   116           : [38;5;250m  [39mEncodeFixed64(buf,[38;5;250m [39mfile_number);
   117           : [38;5;250m  [39mcache_[38;5;241m-[39m[38;5;241m>[39mErase(Slice(buf,[38;5;250m [39m[38;5;28;01msizeof[39;00m(buf)));
   118           : }
   119           : 

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/version_edit.cc ===
Lines with coverage differences:

Lines with different hit counts: 26, 41, 45, 46, 49, 50, 53, 54, 57, 58, 61, 62, 63, 67, 68, 69, 73, 74, 75, 83, 86, 88, 92, 95, 97, 102, 105, 111, 117, 118, 129, 130, 134, 137, 138, 142, 145, 146, 150, 153, 154, 158, 177, 178, 179, 180, 181, 185, 190, 192, 193, 196, 197, 201

Detailed differences with context:
============================================================
    21           : [38;5;250m  [39mkNewFile[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m7[39m,
    22           : [38;5;250m  [39m[38;5;66;03m// 8 was used for large value refs[39;00m
    23           : [38;5;250m  [39mkPrevLogNumber[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m9[39m
    24           : };
    25           : 
[91mâ†’   26 [12017 â†’ 12007]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mVersionEdit::Clear[39m()[38;5;250m [39m{[0m
    27           : [38;5;250m  [39mcomparator_.clear();
    28           : [38;5;250m  [39mlog_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
    29           : [38;5;250m  [39mprev_log_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
    30           : [38;5;250m  [39mlast_sequence_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
    31           : [38;5;250m  [39mnext_file_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;

........................................

    36           : [38;5;250m  [39mhas_last_sequence_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
    37           : [38;5;250m  [39mdeleted_files_.clear();
    38           : [38;5;250m  [39mnew_files_.clear();
    39           : }
    40           : 
[91mâ†’   41 [6119 â†’ 6117]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mVersionEdit::EncodeTo[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mdst)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
    42           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(has_comparator_)[38;5;250m [39m{
    43           : [38;5;250m    [39mPutVarint32(dst,[38;5;250m [39mkComparator);
    44           : [38;5;250m    [39mPutLengthPrefixedSlice(dst,[38;5;250m [39mcomparator_);
[91mâ†’   45 [6119 â†’ 6117]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   46 [4284 â†’ 4282]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(has_log_number_)[38;5;250m [39m{[0m
    47           : [38;5;250m    [39mPutVarint32(dst,[38;5;250m [39mkLogNumber);
    48           : [38;5;250m    [39mPutVarint64(dst,[38;5;250m [39mlog_number_);
[91mâ†’   49 [6119 â†’ 6117]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   50 [3173 â†’ 3171]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(has_prev_log_number_)[38;5;250m [39m{[0m
    51           : [38;5;250m    [39mPutVarint32(dst,[38;5;250m [39mkPrevLogNumber);
    52           : [38;5;250m    [39mPutVarint64(dst,[38;5;250m [39mprev_log_number_);
[91mâ†’   53 [6119 â†’ 6117]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   54 [4284 â†’ 4282]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(has_next_file_number_)[38;5;250m [39m{[0m
    55           : [38;5;250m    [39mPutVarint32(dst,[38;5;250m [39mkNextFileNumber);
    56           : [38;5;250m    [39mPutVarint64(dst,[38;5;250m [39mnext_file_number_);
[91mâ†’   57 [6119 â†’ 6117]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   58 [4284 â†’ 4282]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(has_last_sequence_)[38;5;250m [39m{[0m
    59           : [38;5;250m    [39mPutVarint32(dst,[38;5;250m [39mkLastSequence);
    60           : [38;5;250m    [39mPutVarint64(dst,[38;5;250m [39mlast_sequence_);
[91mâ†’   61 [6119 â†’ 6117]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   62 [6119 â†’ 6117]:[0m [91m[0m
[91mâ†’   63 [430 â†’ 431]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mcompact_pointers_.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    64           : [38;5;250m    [39mPutVarint32(dst,[38;5;250m [39mkCompactPointer);
    65           : [38;5;250m    [39mPutVarint32(dst,[38;5;250m [39mcompact_pointers_[i].first);[38;5;250m  [39m[38;5;66;03m// level[39;00m
    66           : [38;5;250m    [39mPutLengthPrefixedSlice(dst,[38;5;250m [39mcompact_pointers_[i].second.Encode());
[91mâ†’   67 [6119 â†’ 6117]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   68 [6119 â†’ 6117]:[0m [91m[0m
[91mâ†’   69 [586 â†’ 589]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01mauto[39;00m[38;5;241m&[39m[38;5;250m [39mdeleted_file_kvp[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mdeleted_files_)[38;5;250m [39m{[0m
    70           : [38;5;250m    [39mPutVarint32(dst,[38;5;250m [39mkDeletedFile);
    71           : [38;5;250m    [39mPutVarint32(dst,[38;5;250m [39mdeleted_file_kvp.first);[38;5;250m   [39m[38;5;66;03m// level[39;00m
    72           : [38;5;250m    [39mPutVarint64(dst,[38;5;250m [39mdeleted_file_kvp.second);[38;5;250m  [39m[38;5;66;03m// file number[39;00m
[91mâ†’   73 [6119 â†’ 6117]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   74 [6119 â†’ 6117]:[0m [91m[0m
[91mâ†’   75 [2086 â†’ 2083]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mnew_files_.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    76           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mFileMetaData[38;5;241m&[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnew_files_[i].second;
    77           : [38;5;250m    [39mPutVarint32(dst,[38;5;250m [39mkNewFile);
    78           : [38;5;250m    [39mPutVarint32(dst,[38;5;250m [39mnew_files_[i].first);[38;5;250m  [39m[38;5;66;03m// level[39;00m
    79           : [38;5;250m    [39mPutVarint64(dst,[38;5;250m [39mf.number);
    80           : [38;5;250m    [39mPutVarint64(dst,[38;5;250m [39mf.file_size);
    81           : [38;5;250m    [39mPutLengthPrefixedSlice(dst,[38;5;250m [39mf.smallest.Encode());
    82           : [38;5;250m    [39mPutLengthPrefixedSlice(dst,[38;5;250m [39mf.largest.Encode());
[91mâ†’   83 [6119 â†’ 6117]:[0m [91m[38;5;250m  [39m}[0m
    84           : }
    85           : 
[91mâ†’   86 [1257 â†’ 1253]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mGetInternalKey[39m(Slice[38;5;241m*[39m[38;5;250m [39minput,[38;5;250m [39mInternalKey[38;5;241m*[39m[38;5;250m [39mdst)[38;5;250m [39m{[0m
    87           : [38;5;250m  [39mSlice[38;5;250m [39mstr;
[91mâ†’   88 [1257 â†’ 1253]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetLengthPrefixedSlice(input,[38;5;250m [39m[38;5;241m&[39mstr))[38;5;250m [39m{[0m
    89           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mdst[38;5;241m-[39m[38;5;241m>[39mDecodeFrom(str);
    90           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
    91           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’   92 [1257 â†’ 1253]:[0m [91m[38;5;250m  [39m}[0m
    93           : }
    94           : 
[91mâ†’   95 [792 â†’ 790]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mGetLevel[39m(Slice[38;5;241m*[39m[38;5;250m [39minput,[38;5;250m [39m[38;5;125mint[39m[38;5;241m*[39m[38;5;250m [39mlevel)[38;5;250m [39m{[0m
    96           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mv;
[91mâ†’   97 [792 â†’ 790]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetVarint32(input,[38;5;250m [39m[38;5;241m&[39mv)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels)[38;5;250m [39m{[0m
    98           : [38;5;250m    [39m[38;5;241m*[39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv;
    99           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
   100           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   101           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’  102 [792 â†’ 790]:[0m [91m[38;5;250m  [39m}[0m
   103           : }
   104           : 
[91mâ†’  105 [2881 â†’ 2879]:[0m [91mStatus[38;5;250m [39m[38;5;21mVersionEdit::DecodeFrom[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39msrc)[38;5;250m [39m{[0m
   106           : [38;5;250m  [39mClear();
   107           : [38;5;250m  [39mSlice[38;5;250m [39minput[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39msrc;
   108           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mmsg[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
   109           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mtag;
   110           : 
[91mâ†’  111 [2881 â†’ 2879]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Temporary storage for parsing[39;00m[0m
   112           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mlevel;
   113           : [38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39mnumber;
   114           : [38;5;250m  [39mFileMetaData[38;5;250m [39mf;
   115           : [38;5;250m  [39mSlice[38;5;250m [39mstr;
   116           : [38;5;250m  [39mInternalKey[38;5;250m [39mkey;
[91mâ†’  117 [2881 â†’ 2879]:[0m [91m[0m
[91mâ†’  118 [10144 â†’ 10134]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(msg[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mGetVarint32([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mtag))[38;5;250m [39m{[0m
   119           : [38;5;250m    [39m[38;5;28;01mswitch[39;00m[38;5;250m [39m(tag)[38;5;250m [39m{
   120           : [38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkComparator[39m:
   121           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetLengthPrefixedSlice([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mstr))[38;5;250m [39m{
   122           : [38;5;250m          [39mcomparator_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstr.ToString();
   123           : [38;5;250m          [39mhas_comparator_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;

........................................

   124           : [38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   125           : [38;5;250m          [39mmsg[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mcomparator name[39m[38;5;124m"[39m;
   126           : [38;5;250m        [39m}
   127           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
   128           : 
[91mâ†’  129 [2157 â†’ 2155]:[0m [91m[38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkLogNumber[39m:[0m
[91mâ†’  130 [2157 â†’ 2155]:[0m [91m[38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetVarint64([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mlog_number_))[38;5;250m [39m{[0m
   131           : [38;5;250m          [39mhas_log_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   132           : [38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   133           : [38;5;250m          [39mmsg[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mlog number[39m[38;5;124m"[39m;
[91mâ†’  134 [2157 â†’ 2155]:[0m [91m[38;5;250m        [39m}[0m
   135           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
   136           : 
[91mâ†’  137 [1046 â†’ 1044]:[0m [91m[38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkPrevLogNumber[39m:[0m
[91mâ†’  138 [1046 â†’ 1044]:[0m [91m[38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetVarint64([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mprev_log_number_))[38;5;250m [39m{[0m
   139           : [38;5;250m          [39mhas_prev_log_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   140           : [38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   141           : [38;5;250m          [39mmsg[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mprevious log number[39m[38;5;124m"[39m;
[91mâ†’  142 [1046 â†’ 1044]:[0m [91m[38;5;250m        [39m}[0m
   143           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
   144           : 
[91mâ†’  145 [2157 â†’ 2155]:[0m [91m[38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkNextFileNumber[39m:[0m
[91mâ†’  146 [2157 â†’ 2155]:[0m [91m[38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetVarint64([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mnext_file_number_))[38;5;250m [39m{[0m
   147           : [38;5;250m          [39mhas_next_file_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   148           : [38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   149           : [38;5;250m          [39mmsg[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mnext file number[39m[38;5;124m"[39m;
[91mâ†’  150 [2157 â†’ 2155]:[0m [91m[38;5;250m        [39m}[0m
   151           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
   152           : 
[91mâ†’  153 [2157 â†’ 2155]:[0m [91m[38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkLastSequence[39m:[0m
[91mâ†’  154 [2157 â†’ 2155]:[0m [91m[38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetVarint64([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mlast_sequence_))[38;5;250m [39m{[0m
   155           : [38;5;250m          [39mhas_last_sequence_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   156           : [38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   157           : [38;5;250m          [39mmsg[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mlast sequence number[39m[38;5;124m"[39m;
[91mâ†’  158 [2157 â†’ 2155]:[0m [91m[38;5;250m        [39m}[0m
   159           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
   160           : 
   161           : [38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkCompactPointer[39m:
   162           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetLevel([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mlevel)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mGetInternalKey([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mkey))[38;5;250m [39m{
   163           : [38;5;250m          [39mcompact_pointers_.push_back(std[38;5;241m:[39m[38;5;241m:[39mmake_pair(level,[38;5;250m [39mkey));

........................................

   172           : [38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   173           : [38;5;250m          [39mmsg[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mdeleted file[39m[38;5;124m"[39m;
   174           : [38;5;250m        [39m}
   175           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
   176           : 
[91mâ†’  177 [584 â†’ 582]:[0m [91m[38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkNewFile[39m:[0m
[91mâ†’  178 [584 â†’ 582]:[0m [91m[38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetLevel([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mlevel)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mGetVarint64([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mf.number)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’  179 [584 â†’ 582]:[0m [91m[38;5;250m            [39mGetVarint64([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mf.file_size)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’  180 [584 â†’ 582]:[0m [91m[38;5;250m            [39mGetInternalKey([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mf.smallest)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’  181 [584 â†’ 582]:[0m [91m[38;5;250m            [39mGetInternalKey([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mf.largest))[38;5;250m [39m{[0m
   182           : [38;5;250m          [39mnew_files_.push_back(std[38;5;241m:[39m[38;5;241m:[39mmake_pair(level,[38;5;250m [39mf));
   183           : [38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   184           : [38;5;250m          [39mmsg[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mnew-file entry[39m[38;5;124m"[39m;
[91mâ†’  185 [584 â†’ 582]:[0m [91m[38;5;250m        [39m}[0m
   186           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
   187           : 
   188           : [38;5;250m      [39m[38;5;28;01mdefault[39;00m[38;5;241m:[39m
   189           : [38;5;250m        [39mmsg[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124munknown tag[39m[38;5;124m"[39m;
[91mâ†’  190 [10144 â†’ 10134]:[0m [91m[38;5;250m        [39m[38;5;28;01mbreak[39;00m;[0m
   191           : [38;5;250m    [39m}
[91mâ†’  192 [2881 â†’ 2879]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  193 [2881 â†’ 2879]:[0m [91m[0m
   194           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(msg[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m![39minput.empty())[38;5;250m [39m{
   195           : [38;5;250m    [39mmsg[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124minvalid tag[39m[38;5;124m"[39m;
[91mâ†’  196 [2881 â†’ 2879]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  197 [2881 â†’ 2879]:[0m [91m[0m
   198           : [38;5;250m  [39mStatus[38;5;250m [39mresult;
   199           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(msg[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
   200           : [38;5;250m    [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mVersionEdit[39m[38;5;124m"[39m,[38;5;250m [39mmsg);
[91mâ†’  201 [2881 â†’ 2879]:[0m [91m[38;5;250m  [39m}[0m
   202           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;
   203           : }
   204           : 
   205           : std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mVersionEdit::DebugString[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{
   206           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mr;

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/version_edit.h ===
Lines with coverage differences:

Lines with different hit counts: 40, 44, 48, 52, 56, 64, 74

Detailed differences with context:
============================================================
    35           : 
    36           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSetComparatorName[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mname)[38;5;250m [39m{
    37           : [38;5;250m    [39mhas_comparator_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
    38           : [38;5;250m    [39mcomparator_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mname.ToString();
    39           : [38;5;250m  [39m}
[91mâ†’   40 [6119 â†’ 6117]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSetLogNumber[39m([38;5;125muint64_t[39m[38;5;250m [39mnum)[38;5;250m [39m{[0m
    41           : [38;5;250m    [39mhas_log_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
    42           : [38;5;250m    [39mlog_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnum;
    43           : [38;5;250m  [39m}
[91mâ†’   44 [3173 â†’ 3171]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSetPrevLogNumber[39m([38;5;125muint64_t[39m[38;5;250m [39mnum)[38;5;250m [39m{[0m
    45           : [38;5;250m    [39mhas_prev_log_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
    46           : [38;5;250m    [39mprev_log_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnum;
    47           : [38;5;250m  [39m}
[91mâ†’   48 [6119 â†’ 6117]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSetNextFile[39m([38;5;125muint64_t[39m[38;5;250m [39mnum)[38;5;250m [39m{[0m
    49           : [38;5;250m    [39mhas_next_file_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
    50           : [38;5;250m    [39mnext_file_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnum;
    51           : [38;5;250m  [39m}
[91mâ†’   52 [4284 â†’ 4282]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSetLastSequence[39m(SequenceNumber[38;5;250m [39mseq)[38;5;250m [39m{[0m
    53           : [38;5;250m    [39mhas_last_sequence_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
    54           : [38;5;250m    [39mlast_sequence_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mseq;
    55           : [38;5;250m  [39m}
[91mâ†’   56 [464 â†’ 461]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSetCompactPointer[39m([38;5;125mint[39m[38;5;250m [39mlevel,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKey[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m{[0m
    57           : [38;5;250m    [39mcompact_pointers_.push_back(std[38;5;241m:[39m[38;5;241m:[39mmake_pair(level,[38;5;250m [39mkey));
    58           : [38;5;250m  [39m}
    59           : 
    60           : [38;5;250m  [39m[38;5;66;03m// Add the specified file at the specified number.[39;00m
    61           : [38;5;250m  [39m[38;5;66;03m// REQUIRES: This version has not been saved (see VersionSet::SaveTo)[39;00m
    62           : [38;5;250m  [39m[38;5;66;03m// REQUIRES: "smallest" and "largest" are smallest and largest keys in file[39;00m
    63           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39mAddFile([38;5;125mint[39m[38;5;250m [39mlevel,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mfile,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mfile_size,
[91mâ†’   64 [2188 â†’ 2185]:[0m [91m[38;5;250m               [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKey[38;5;241m&[39m[38;5;250m [39msmallest,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKey[38;5;241m&[39m[38;5;250m [39mlargest)[38;5;250m [39m{[0m
    65           : [38;5;250m    [39mFileMetaData[38;5;250m [39mf;
    66           : [38;5;250m    [39mf.number[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfile;
    67           : [38;5;250m    [39mf.file_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfile_size;
    68           : [38;5;250m    [39mf.smallest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39msmallest;
    69           : [38;5;250m    [39mf.largest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlargest;
    70           : [38;5;250m    [39mnew_files_.push_back(std[38;5;241m:[39m[38;5;241m:[39mmake_pair(level,[38;5;250m [39mf));
    71           : [38;5;250m  [39m}
    72           : 
    73           : [38;5;250m  [39m[38;5;66;03m// Delete the specified "file" from the specified "level".[39;00m
[91mâ†’   74 [586 â†’ 589]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDeleteFile[39m([38;5;125mint[39m[38;5;250m [39mlevel,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mfile)[38;5;250m [39m{[0m
    75           : [38;5;250m    [39mdeleted_files_.insert(std[38;5;241m:[39m[38;5;241m:[39mmake_pair(level,[38;5;250m [39mfile));
    76           : [38;5;250m  [39m}
    77           : 
    78           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mEncodeTo[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mdst)[38;5;250m [39m[38;5;28;01mconst[39;00m;
    79           : [38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mDecodeFrom[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39msrc);

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/version_set.cc ===
Lines with coverage differences:

Lines with different hit counts: 25, 31, 42, 46, 48, 51, 55, 56, 60, 62, 64, 68, 69, 71, 72, 75, 76, 77, 79, 80, 81, 83, 84, 85, 89, 92, 95, 97, 99, 101, 103, 104, 109, 110, 111, 112, 116, 117, 118, 119, 126, 128, 129, 130, 132, 135, 137, 138, 139, 140, 142, 143, 144, 145, 150, 151, 152, 154, 155, 156, 168, 178, 179, 180, 190, 191, 192, 194, 195, 196, 198, 212, 217, 220, 224, 233, 242, 278, 289, 291, 292, 294, 298, 299, 301, 303, 305, 306, 308, 310, 311, 312, 314, 315, 316, 317, 319, 320, 321, 322, 403, 405, 411, 412, 413, 426, 433, 434, 447, 448, 450, 456, 457, 458, 459, 460, 462, 466, 472, 474, 476, 480, 481, 483, 484, 485, 488, 490, 491, 492, 493, 494, 501, 502, 503, 504, 506, 508, 509, 511, 513, 521, 536, 537, 538, 576, 578, 583, 599, 603, 605, 608, 609, 613, 614, 616, 618, 623, 624, 625, 630, 631, 632, 636, 638, 639, 643, 645, 646, 663, 665, 666, 669, 673, 676, 678, 684, 685, 688, 690, 691, 693, 695, 696, 698, 699, 701, 702, 703, 711, 712, 713, 715, 718, 719, 720, 721, 723, 724, 727, 728, 730, 761, 762, 764, 765, 767, 771, 778, 779, 780, 781, 782, 784, 785, 786, 788, 789, 792, 802, 816, 818, 819, 822, 823, 827, 829, 832, 836, 839, 840, 844, 845, 858, 859, 910, 913, 914, 919, 921, 922, 924, 925, 926, 929, 930, 931, 934, 935, 936, 939, 940, 941, 944, 1021, 1024, 1027, 1028, 1031, 1032, 1034, 1045, 1048, 1049, 1053, 1054, 1055, 1058, 1059, 1060, 1084, 1095, 1096, 1097, 1098, 1101, 1102, 1144, 1145, 1146, 1147, 1149, 1151, 1152, 1153, 1183, 1184, 1185, 1187, 1189, 1192, 1195, 1196, 1198, 1199, 1200, 1208, 1214, 1221, 1222, 1225, 1226, 1233, 1234, 1238, 1239, 1240, 1242, 1244, 1247, 1252, 1255, 1257, 1258, 1259, 1261, 1262, 1264, 1265, 1268, 1269, 1273, 1280, 1281, 1282, 1285, 1294, 1295, 1296, 1297, 1305, 1308, 1309, 1315, 1324, 1327, 1329, 1336, 1337, 1357, 1360, 1363, 1364, 1365, 1366, 1370, 1374, 1376, 1380, 1383, 1386, 1390, 1395, 1396, 1403, 1423, 1424, 1427, 1428, 1431, 1436, 1480, 1481, 1483, 1486, 1489, 1492, 1496, 1497, 1499, 1502, 1503, 1504, 1506, 1507, 1531, 1533, 1535, 1543, 1545, 1550, 1552, 1555, 1556, 1559

Detailed differences with context:
============================================================
    20           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/coding.h"[39;00m
    21           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/logging.h"[39;00m
    22           : 
    23           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
    24           : 
[91mâ†’   25 [2525 â†’ 2521]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39m[38;5;21mTargetFileSize[39m([38;5;28;01mconst[39;00m[38;5;250m [39mOptions[38;5;241m*[39m[38;5;250m [39moptions)[38;5;250m [39m{[0m
    26           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39moptions[38;5;241m-[39m[38;5;241m>[39mmax_file_size;
    27           : }
    28           : 
    29           : [38;5;66;03m// Maximum bytes of overlaps in grandparent (i.e., level+2) before we[39;00m
    30           : [38;5;66;03m// stop building a single file in a level->level+1 compaction.[39;00m
[91mâ†’   31 [2042 â†’ 2041]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mint64_t[39m[38;5;250m [39m[38;5;21mMaxGrandParentOverlapBytes[39m([38;5;28;01mconst[39;00m[38;5;250m [39mOptions[38;5;241m*[39m[38;5;250m [39moptions)[38;5;250m [39m{[0m
    32           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;241m10[39m[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39mTargetFileSize(options);
    33           : }
    34           : 
    35           : [38;5;66;03m// Maximum number of bytes in all compacted files.  We avoid expanding[39;00m
    36           : [38;5;66;03m// the lower level file set of a compaction if it would make the[39;00m

........................................

    37           : [38;5;66;03m// total compaction cover more than this many bytes.[39;00m
    38           : [38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mint64_t[39m[38;5;250m [39m[38;5;21mExpandedCompactionByteSizeLimit[39m([38;5;28;01mconst[39;00m[38;5;250m [39mOptions[38;5;241m*[39m[38;5;250m [39moptions)[38;5;250m [39m{
    39           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;241m25[39m[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39mTargetFileSize(options);
    40           : }
    41           : 
[91mâ†’   42 [25040 â†’ 25030]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mdouble[39m[38;5;250m [39m[38;5;21mMaxBytesForLevel[39m([38;5;28;01mconst[39;00m[38;5;250m [39mOptions[38;5;241m*[39m[38;5;250m [39moptions,[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mlevel)[38;5;250m [39m{[0m
    43           : [38;5;250m  [39m[38;5;66;03m// Note: the result for level zero is not really used since we set[39;00m
    44           : [38;5;250m  [39m[38;5;66;03m// the level-0 compaction threshold based on number of files.[39;00m
    45           : 
[91mâ†’   46 [25040 â†’ 25030]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Result for both level-0 and level-1[39;00m[0m
    47           : [38;5;250m  [39m[38;5;125mdouble[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m10.[39m[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;241m1048576.0[39m;
[91mâ†’   48 [50080 â†’ 50060]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(level[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m1[39m)[38;5;250m [39m{[0m
    49           : [38;5;250m    [39mresult[38;5;250m [39m[38;5;241m*[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m10[39m;
    50           : [38;5;250m    [39mlevel[38;5;241m-[39m[38;5;241m-[39m;
[91mâ†’   51 [25040 â†’ 25030]:[0m [91m[38;5;250m  [39m}[0m
    52           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;
    53           : }
    54           : 
[91mâ†’   55 [478 â†’ 475]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39m[38;5;21mMaxFileSizeForLevel[39m([38;5;28;01mconst[39;00m[38;5;250m [39mOptions[38;5;241m*[39m[38;5;250m [39moptions,[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mlevel)[38;5;250m [39m{[0m
[91mâ†’   56 [478 â†’ 475]:[0m [91m[38;5;250m  [39m[38;5;66;03m// We could vary per level to reduce number of files?[39;00m[0m
    57           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mTargetFileSize(options);
    58           : }
    59           : 
[91mâ†’   60 [26894 â†’ 26873]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mint64_t[39m[38;5;250m [39m[38;5;21mTotalFileSize[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39mfiles)[38;5;250m [39m{[0m
    61           : [38;5;250m  [39m[38;5;125mint64_t[39m[38;5;250m [39msum[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’   62 [2975 â†’ 2953]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfiles.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    63           : [38;5;250m    [39msum[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mfiles[i][38;5;241m-[39m[38;5;241m>[39mfile_size;
[91mâ†’   64 [26894 â†’ 26873]:[0m [91m[38;5;250m  [39m}[0m
    65           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39msum;
    66           : }
    67           : 
[91mâ†’   68 [8678 â†’ 8676]:[0m [91mVersion[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mVersion()[38;5;250m [39m{[0m
[91mâ†’   69 [8678 â†’ 8676]:[0m [91m[38;5;250m  [39massert(refs_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
    70           : 
[91mâ†’   71 [8678 â†’ 8676]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Remove from linked list[39;00m[0m
[91mâ†’   72 [8678 â†’ 8676]:[0m [91m[38;5;250m  [39mprev_[38;5;241m-[39m[38;5;241m>[39mnext_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnext_;[0m
    73           : [38;5;250m  [39mnext_[38;5;241m-[39m[38;5;241m>[39mprev_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mprev_;
    74           : 
[91mâ†’   75 [8678 â†’ 8676]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Drop references to files[39;00m[0m
[91mâ†’   76 [60746 â†’ 60732]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels;[38;5;250m [39mlevel[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
[91mâ†’   77 [3618 â†’ 3612]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfiles_[level].size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    78           : [38;5;250m      [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfiles_[level][i];
[91mâ†’   79 [3618 â†’ 3612]:[0m [91m[38;5;250m      [39massert(f[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’   80 [3618 â†’ 3612]:[0m [91m[38;5;250m      [39mf[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;241m-[39m[38;5;241m-[39m;[0m
[91mâ†’   81 [2086 â†’ 2083]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(f[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
    82           : [38;5;250m        [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mf;
[91mâ†’   83 [3618 â†’ 3612]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’   84 [60746 â†’ 60732]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   85 [8678 â†’ 8676]:[0m [91m[38;5;250m  [39m}[0m
    86           : }
    87           : 
    88           : [38;5;125mint[39m[38;5;250m [39mFindFile([38;5;28;01mconst[39;00m[38;5;250m [39mInternalKeyComparator[38;5;241m&[39m[38;5;250m [39micmp,
[91mâ†’   89 [12579 â†’ 12385]:[0m [91m[38;5;250m             [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39mfiles,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m{[0m
    90           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mleft[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
    91           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mright[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfiles.size();
[91mâ†’   92 [8644 â†’ 8451]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(left[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mright)[38;5;250m [39m{[0m
    93           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mmid[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(left[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mright)[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39m[38;5;241m2[39m;
    94           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfiles[mid];
[91mâ†’   95 [2119 â†’ 2092]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(icmp.InternalKeyComparator[38;5;241m:[39m[38;5;241m:[39mCompare(f[38;5;241m-[39m[38;5;241m>[39mlargest.Encode(),[38;5;250m [39mkey)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
    96           : [38;5;250m      [39m[38;5;66;03m// Key at "mid.largest" is < "target".  Therefore all[39;00m
[91mâ†’   97 [2119 â†’ 2092]:[0m [91m[38;5;250m      [39m[38;5;66;03m// files at or before "mid" are uninteresting.[39;00m[0m
    98           : [38;5;250m      [39mleft[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmid[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m;
[91mâ†’   99 [6525 â†’ 6359]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   100           : [38;5;250m      [39m[38;5;66;03m// Key at "mid.largest" is >= "target".  Therefore all files[39;00m
[91mâ†’  101 [6525 â†’ 6359]:[0m [91m[38;5;250m      [39m[38;5;66;03m// after "mid" are uninteresting.[39;00m[0m
   102           : [38;5;250m      [39mright[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmid;
[91mâ†’  103 [8644 â†’ 8451]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  104 [12579 â†’ 12385]:[0m [91m[38;5;250m  [39m}[0m
   105           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mright;
   106           : }
   107           : 
   108           : [38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39mAfterFile([38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39mucmp,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39muser_key,
[91mâ†’  109 [117 â†’ 116]:[0m [91m[38;5;250m                      [39m[38;5;28;01mconst[39;00m[38;5;250m [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf)[38;5;250m [39m{[0m
[91mâ†’  110 [117 â†’ 116]:[0m [91m[38;5;250m  [39m[38;5;66;03m// null user_key occurs before all keys and is therefore never after *f[39;00m[0m
[91mâ†’  111 [117 â†’ 116]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(user_key[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’  112 [117 â†’ 116]:[0m [91m[38;5;250m          [39mucmp[38;5;241m-[39m[38;5;241m>[39mCompare([38;5;241m*[39muser_key,[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39mlargest.user_key())[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);[0m
   113           : }
   114           : 
   115           : [38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39mBeforeFile([38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39mucmp,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39muser_key,
[91mâ†’  116 [598 â†’ 596]:[0m [91m[38;5;250m                       [39m[38;5;28;01mconst[39;00m[38;5;250m [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf)[38;5;250m [39m{[0m
[91mâ†’  117 [598 â†’ 596]:[0m [91m[38;5;250m  [39m[38;5;66;03m// null user_key occurs after all keys and is therefore never before *f[39;00m[0m
[91mâ†’  118 [598 â†’ 596]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(user_key[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’  119 [598 â†’ 596]:[0m [91m[38;5;250m          [39mucmp[38;5;241m-[39m[38;5;241m>[39mCompare([38;5;241m*[39muser_key,[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39msmallest.user_key())[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m);[0m
   120           : }
   121           : 
   122           : [38;5;125mbool[39m[38;5;250m [39mSomeFileOverlapsRange([38;5;28;01mconst[39;00m[38;5;250m [39mInternalKeyComparator[38;5;241m&[39m[38;5;250m [39micmp,
   123           : [38;5;250m                           [39m[38;5;125mbool[39m[38;5;250m [39mdisjoint_sorted_files,
   124           : [38;5;250m                           [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39mfiles,
   125           : [38;5;250m                           [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39msmallest_user_key,
[91mâ†’  126 [6862 â†’ 6856]:[0m [91m[38;5;250m                           [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39mlargest_user_key)[38;5;250m [39m{[0m
   127           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39mucmp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39micmp.user_comparator();
[91mâ†’  128 [828 â†’ 825]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mdisjoint_sorted_files)[38;5;250m [39m{[0m
[91mâ†’  129 [828 â†’ 825]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Need to check against all files[39;00m[0m
[91mâ†’  130 [117 â†’ 116]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfiles.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   131           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfiles[i];
[91mâ†’  132 [117 â†’ 116]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(AfterFile(ucmp,[38;5;250m [39msmallest_user_key,[38;5;250m [39mf)[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[0m
   133           : [38;5;250m          [39mBeforeFile(ucmp,[38;5;250m [39mlargest_user_key,[38;5;250m [39mf))[38;5;250m [39m{
   134           : [38;5;250m        [39m[38;5;66;03m// No overlap[39;00m
[91mâ†’  135 [ 63 â†’  62]:[0m [91m[38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   136           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;[38;5;250m  [39m[38;5;66;03m// Overlap[39;00m
[91mâ†’  137 [117 â†’ 116]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  138 [765 â†’ 763]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  139 [828 â†’ 825]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;[0m
[91mâ†’  140 [6034 â†’ 6031]:[0m [91m[38;5;250m  [39m}[0m
   141           : 
[91mâ†’  142 [6034 â†’ 6031]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Binary search over file list[39;00m[0m
[91mâ†’  143 [6034 â†’ 6031]:[0m [91m[38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mindex[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[0m
[91mâ†’  144 [6034 â†’ 6031]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(smallest_user_key[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
[91mâ†’  145 [6034 â†’ 6031]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Find the earliest possible internal key for smallest_user_key[39;00m[0m
   146           : [38;5;250m    [39mInternalKey[38;5;250m [39msmall_key([38;5;241m*[39msmallest_user_key,[38;5;250m [39mkMaxSequenceNumber,
   147           : [38;5;250m                          [39mkValueTypeForSeek);
   148           : [38;5;250m    [39mindex[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFindFile(icmp,[38;5;250m [39mfiles,[38;5;250m [39msmall_key.Encode());
   149           : [38;5;250m  [39m}
[91mâ†’  150 [6034 â†’ 6031]:[0m [91m[0m
[91mâ†’  151 [5521 â†’ 5519]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(index[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mfiles.size())[38;5;250m [39m{[0m
[91mâ†’  152 [5521 â†’ 5519]:[0m [91m[38;5;250m    [39m[38;5;66;03m// beginning of range is after all files, so no overlap.[39;00m[0m
   153           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’  154 [513 â†’ 512]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  155 [513 â†’ 512]:[0m [91m[0m
[91mâ†’  156 [6034 â†’ 6031]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;241m![39mBeforeFile(ucmp,[38;5;250m [39mlargest_user_key,[38;5;250m [39mfiles[index]);[0m
   157           : }
   158           : 
   159           : [38;5;66;03m// An internal iterator.  For a given version/level pair, yields[39;00m
   160           : [38;5;66;03m// information about the files in the level.  For a given entry, key()[39;00m
   161           : [38;5;66;03m// is the largest key that occurs in the file, and value() is an[39;00m

........................................

   163           : [38;5;66;03m// encoded using EncodeFixed64.[39;00m
   164           : [38;5;28;01mclass[39;00m[38;5;250m [39m[38;5;21;01mVersion[39;00m[38;5;241m:[39m[38;5;241m:[39mLevelFileNumIterator[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;250m [39mIterator[38;5;250m [39m{
   165           : [38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;241m:[39m
   166           : [38;5;250m  [39mLevelFileNumIterator([38;5;28;01mconst[39;00m[38;5;250m [39mInternalKeyComparator[38;5;241m&[39m[38;5;250m [39micmp,
   167           : [38;5;250m                       [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m*[39m[38;5;250m [39mflist)
[91mâ†’  168 [1081 â†’ 1070]:[0m [91m[38;5;250m      [39m[38;5;241m:[39m[38;5;250m [39micmp_(icmp),[38;5;250m [39mflist_(flist),[38;5;250m [39mindex_(flist[38;5;241m-[39m[38;5;241m>[39msize())[38;5;250m [39m{[38;5;250m  [39m[38;5;66;03m// Marks as invalid[39;00m[0m
   169           : [38;5;250m  [39m}
   170           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mValid[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mindex_[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mflist_[38;5;241m-[39m[38;5;241m>[39msize();[38;5;250m [39m}
   171           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeek[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mtarget)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   172           : [38;5;250m    [39mindex_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFindFile(icmp_,[38;5;250m [39m[38;5;241m*[39mflist_,[38;5;250m [39mtarget);
   173           : [38;5;250m  [39m}
   174           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToFirst[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39mindex_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39m}
   175           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToLast[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   176           : [38;5;250m    [39mindex_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mflist_[38;5;241m-[39m[38;5;241m>[39mempty()[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mflist_[38;5;241m-[39m[38;5;241m>[39msize()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m;
   177           : [38;5;250m  [39m}
[91mâ†’  178 [1003 â†’ 998]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mNext[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’  179 [1003 â†’ 998]:[0m [91m[38;5;250m    [39massert(Valid());[0m
[91mâ†’  180 [1003 â†’ 998]:[0m [91m[38;5;250m    [39mindex_[38;5;241m+[39m[38;5;241m+[39m;[0m
   181           : [38;5;250m  [39m}
   182           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPrev[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   183           : [38;5;250m    [39massert(Valid());
   184           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(index_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   185           : [38;5;250m      [39mindex_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mflist_[38;5;241m-[39m[38;5;241m>[39msize();[38;5;250m  [39m[38;5;66;03m// Marks as invalid[39;00m
   186           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   187           : [38;5;250m      [39mindex_[38;5;241m-[39m[38;5;241m-[39m;
   188           : [38;5;250m    [39m}
   189           : [38;5;250m  [39m}
[91mâ†’  190 [1051 â†’ 1041]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mkey[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’  191 [1051 â†’ 1041]:[0m [91m[38;5;250m    [39massert(Valid());[0m
[91mâ†’  192 [1051 â†’ 1041]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m([38;5;241m*[39mflist_)[index_][38;5;241m-[39m[38;5;241m>[39mlargest.Encode();[0m
   193           : [38;5;250m  [39m}
[91mâ†’  194 [1051 â†’ 1041]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mvalue[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’  195 [1051 â†’ 1041]:[0m [91m[38;5;250m    [39massert(Valid());[0m
[91mâ†’  196 [1051 â†’ 1041]:[0m [91m[38;5;250m    [39mEncodeFixed64(value_buf_,[38;5;250m [39m([38;5;241m*[39mflist_)[index_][38;5;241m-[39m[38;5;241m>[39mnumber);[0m
   197           : [38;5;250m    [39mEncodeFixed64(value_buf_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m8[39m,[38;5;250m [39m([38;5;241m*[39mflist_)[index_][38;5;241m-[39m[38;5;241m>[39mfile_size);
[91mâ†’  198 [1051 â†’ 1041]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mSlice(value_buf_,[38;5;250m [39m[38;5;28;01msizeof[39;00m(value_buf_));[0m
   199           : [38;5;250m  [39m}
   200           : [38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mstatus[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();[38;5;250m [39m}
   201           : 
   202           : [38;5;250m [39m[38;5;28;01mprivate[39;00m[38;5;241m:[39m
   203           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKeyComparator[38;5;250m [39micmp_;

........................................

   207           : [38;5;250m  [39m[38;5;66;03m// Backing store for value().  Holds the file number and size.[39;00m
   208           : [38;5;250m  [39m[38;5;28;01mmutable[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;250m [39mvalue_buf_[[38;5;241m16[39m];
   209           : };
   210           : 
   211           : [38;5;28;01mstatic[39;00m[38;5;250m [39mIterator[38;5;241m*[39m[38;5;250m [39mGetFileIterator([38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mReadOptions[38;5;241m&[39m[38;5;250m [39moptions,
[91mâ†’  212 [1051 â†’ 1041]:[0m [91m[38;5;250m                                 [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mfile_value)[38;5;250m [39m{[0m
   213           : [38;5;250m  [39mTableCache[38;5;241m*[39m[38;5;250m [39mcache[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mTableCache[38;5;241m*[39m[38;5;241m>[39m(arg);
   214           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(file_value.size()[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m16[39m)[38;5;250m [39m{
   215           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mNewErrorIterator(
   216           : [38;5;250m        [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mFileReader invoked with unexpected value[39m[38;5;124m"[39m));
[91mâ†’  217 [1051 â†’ 1041]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   218           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mcache[38;5;241m-[39m[38;5;241m>[39mNewIterator(options,[38;5;250m [39mDecodeFixed64(file_value.data()),
   219           : [38;5;250m                              [39mDecodeFixed64(file_value.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m8[39m));
[91mâ†’  220 [1051 â†’ 1041]:[0m [91m[38;5;250m  [39m}[0m
   221           : }
   222           : 
   223           : Iterator[38;5;241m*[39m[38;5;250m [39mVersion[38;5;241m:[39m[38;5;241m:[39mNewConcatenatingIterator([38;5;28;01mconst[39;00m[38;5;250m [39mReadOptions[38;5;241m&[39m[38;5;250m [39moptions,
[91mâ†’  224 [734 â†’ 729]:[0m [91m[38;5;250m                                            [39m[38;5;125mint[39m[38;5;250m [39mlevel)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
   225           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mNewTwoLevelIterator(
   226           : [38;5;250m      [39m[38;5;28;01mnew[39;00m[38;5;250m [39mLevelFileNumIterator(vset_[38;5;241m-[39m[38;5;241m>[39micmp_,[38;5;250m [39m[38;5;241m&[39mfiles_[level]),[38;5;250m [39m[38;5;241m&[39mGetFileIterator,
   227           : [38;5;250m      [39mvset_[38;5;241m-[39m[38;5;241m>[39mtable_cache_,[38;5;250m [39moptions);
   228           : }
   229           : 
   230           : [38;5;125mvoid[39m[38;5;250m [39mVersion[38;5;241m:[39m[38;5;241m:[39mAddIterators([38;5;28;01mconst[39;00m[38;5;250m [39mReadOptions[38;5;241m&[39m[38;5;250m [39moptions,
   231           : [38;5;250m                           [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mIterator[38;5;241m*[39m[38;5;241m>[39m[38;5;241m*[39m[38;5;250m [39miters)[38;5;250m [39m{
   232           : [38;5;250m  [39m[38;5;66;03m// Merge all level zero files together since they may overlap[39;00m
[91mâ†’  233 [861 â†’ 865]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfiles_[[38;5;241m0[39m].size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   234           : [38;5;250m    [39miters[38;5;241m-[39m[38;5;241m>[39mpush_back(vset_[38;5;241m-[39m[38;5;241m>[39mtable_cache_[38;5;241m-[39m[38;5;241m>[39mNewIterator(
   235           : [38;5;250m        [39moptions,[38;5;250m [39mfiles_[[38;5;241m0[39m][i][38;5;241m-[39m[38;5;241m>[39mnumber,[38;5;250m [39mfiles_[[38;5;241m0[39m][i][38;5;241m-[39m[38;5;241m>[39mfile_size));
   236           : [38;5;250m  [39m}
   237           : 
   238           : [38;5;250m  [39m[38;5;66;03m// For levels > 0, we can use a concatenating iterator that sequentially[39;00m
   239           : [38;5;250m  [39m[38;5;66;03m// walks through the non-overlapping files in the level, opening them[39;00m
   240           : [38;5;250m  [39m[38;5;66;03m// lazily.[39;00m
   241           : [38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels;[38;5;250m [39mlevel[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{
[91mâ†’  242 [734 â†’ 729]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mfiles_[level].empty())[38;5;250m [39m{[0m
   243           : [38;5;250m      [39miters[38;5;241m-[39m[38;5;241m>[39mpush_back(NewConcatenatingIterator(options,[38;5;250m [39mlevel));
   244           : [38;5;250m    [39m}
   245           : [38;5;250m  [39m}
   246           : }
   247           : 

........................................

   273           : [38;5;250m      [39m}
   274           : [38;5;250m    [39m}
   275           : [38;5;250m  [39m}
   276           : }
   277           : 
[91mâ†’  278 [3048 â†’ 3306]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mNewestFirst[39m(FileMetaData[38;5;241m*[39m[38;5;250m [39ma,[38;5;250m [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mb)[38;5;250m [39m{[0m
   279           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ma[38;5;241m-[39m[38;5;241m>[39mnumber[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mb[38;5;241m-[39m[38;5;241m>[39mnumber;
   280           : }
   281           : 
   282           : [38;5;125mvoid[39m[38;5;250m [39mVersion[38;5;241m:[39m[38;5;241m:[39mForEachOverlapping(Slice[38;5;250m [39muser_key,[38;5;250m [39mSlice[38;5;250m [39minternal_key,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg,
   283           : [38;5;250m                                 [39m[38;5;125mbool[39m[38;5;250m [39m([38;5;241m*[39mfunc)([38;5;125mvoid[39m[38;5;241m*[39m,[38;5;250m [39m[38;5;125mint[39m,[38;5;250m [39mFileMetaData[38;5;241m*[39m))[38;5;250m [39m{

........................................

   284           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39mucmp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mvset_[38;5;241m-[39m[38;5;241m>[39micmp_.user_comparator();
   285           : 
   286           : [38;5;250m  [39m[38;5;66;03m// Search level-0 in order from newest to oldest.[39;00m
   287           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;250m [39mtmp;
   288           : [38;5;250m  [39mtmp.reserve(files_[[38;5;241m0[39m].size());
[91mâ†’  289 [7673 â†’ 7802]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125muint32_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfiles_[[38;5;241m0[39m].size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   290           : [38;5;250m    [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfiles_[[38;5;241m0[39m][i];
[91mâ†’  291 [7673 â†’ 7802]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(ucmp[38;5;241m-[39m[38;5;241m>[39mCompare(user_key,[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39msmallest.user_key())[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’  292 [5528 â†’ 5657]:[0m [91m[38;5;250m        [39mucmp[38;5;241m-[39m[38;5;241m>[39mCompare(user_key,[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39mlargest.user_key())[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   293           : [38;5;250m      [39mtmp.push_back(f);
[91mâ†’  294 [7673 â†’ 7802]:[0m [91m[38;5;250m    [39m}[0m
   295           : [38;5;250m  [39m}
   296           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mtmp.empty())[38;5;250m [39m{
   297           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39msort(tmp.begin(),[38;5;250m [39mtmp.end(),[38;5;250m [39mNewestFirst);
[91mâ†’  298 [5133 â†’ 5260]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125muint32_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mtmp.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
[91mâ†’  299 [1405 â†’ 1532]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39m([38;5;241m*[39mfunc)(arg,[38;5;250m [39m[38;5;241m0[39m,[38;5;250m [39mtmp[i]))[38;5;250m [39m{[0m
   300           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m;
[91mâ†’  301 [5133 â†’ 5260]:[0m [91m[38;5;250m      [39m}[0m
   302           : [38;5;250m    [39m}
[91mâ†’  303 [8526 â†’ 8399]:[0m [91m[38;5;250m  [39m}[0m
   304           : 
[91mâ†’  305 [8526 â†’ 8399]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Search other levels.[39;00m[0m
[91mâ†’  306 [44252 â†’ 44226]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels;[38;5;250m [39mlevel[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   307           : [38;5;250m    [39m[38;5;125msize_t[39m[38;5;250m [39mnum_files[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfiles_[level].size();
[91mâ†’  308 [6545 â†’ 6354]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(num_files[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m[38;5;28;01mcontinue[39;00m;[0m
   309           : 
[91mâ†’  310 [6545 â†’ 6354]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Binary search to find earliest index whose largest key >= internal_key.[39;00m[0m
[91mâ†’  311 [6545 â†’ 6354]:[0m [91m[38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mindex[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFindFile(vset_[38;5;241m-[39m[38;5;241m>[39micmp_,[38;5;250m [39mfiles_[level],[38;5;250m [39minternal_key);[0m
[91mâ†’  312 [5286 â†’ 5122]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(index[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mnum_files)[38;5;250m [39m{[0m
   313           : [38;5;250m      [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfiles_[level][index];
[91mâ†’  314 [498 â†’ 499]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(ucmp[38;5;241m-[39m[38;5;241m>[39mCompare(user_key,[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39msmallest.user_key())[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
[91mâ†’  315 [498 â†’ 499]:[0m [91m[38;5;250m        [39m[38;5;66;03m// All of "f" is past any data for user_key[39;00m[0m
[91mâ†’  316 [4788 â†’ 4623]:[0m [91m[38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
[91mâ†’  317 [1630 â†’ 1465]:[0m [91m[38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39m([38;5;241m*[39mfunc)(arg,[38;5;250m [39mlevel,[38;5;250m [39mf))[38;5;250m [39m{[0m
   318           : [38;5;250m          [39m[38;5;28;01mreturn[39;00m;
[91mâ†’  319 [4788 â†’ 4623]:[0m [91m[38;5;250m        [39m}[0m
[91mâ†’  320 [5286 â†’ 5122]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  321 [6545 â†’ 6354]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  322 [8526 â†’ 8399]:[0m [91m[38;5;250m  [39m}[0m
   323           : }
   324           : 
   325           : Status[38;5;250m [39mVersion[38;5;241m:[39m[38;5;241m:[39mGet([38;5;28;01mconst[39;00m[38;5;250m [39mReadOptions[38;5;241m&[39m[38;5;250m [39moptions,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mLookupKey[38;5;241m&[39m[38;5;250m [39mk,
   326           : [38;5;250m                    [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mvalue,[38;5;250m [39mGetStats[38;5;241m*[39m[38;5;250m [39mstats)[38;5;250m [39m{
   327           : [38;5;250m  [39mstats[38;5;241m-[39m[38;5;241m>[39mseek_file[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;

........................................

   398           : [38;5;250m  [39mForEachOverlapping(state.saver.user_key,[38;5;250m [39mstate.ikey,[38;5;250m [39m[38;5;241m&[39mstate,[38;5;250m [39m[38;5;241m&[39mState[38;5;241m:[39m[38;5;241m:[39mMatch);
   399           : 
   400           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstate.found[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39mstate.s[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mNotFound(Slice());
   401           : }
   402           : 
[91mâ†’  403 [3173 â†’ 3135]:[0m [91m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mVersion::UpdateStats[39m([38;5;28;01mconst[39;00m[38;5;250m [39mGetStats[38;5;241m&[39m[38;5;250m [39mstats)[38;5;250m [39m{[0m
   404           : [38;5;250m  [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstats.seek_file;
[91mâ†’  405 [2544 â†’ 2506]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(f[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   406           : [38;5;250m    [39mf[38;5;241m-[39m[38;5;241m>[39mallowed_seeks[38;5;241m-[39m[38;5;241m-[39m;
   407           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(f[38;5;241m-[39m[38;5;241m>[39mallowed_seeks[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mfile_to_compact_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
   408           : [38;5;250m      [39mfile_to_compact_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mf;
   409           : [38;5;250m      [39mfile_to_compact_level_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstats.seek_file_level;
   410           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  411 [2544 â†’ 2506]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  412 [3173 â†’ 3135]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  413 [3173 â†’ 3135]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;[0m
   414           : }
   415           : 
   416           : [38;5;125mbool[39m[38;5;250m [39m[38;5;21mVersion::RecordReadSample[39m(Slice[38;5;250m [39minternal_key)[38;5;250m [39m{
   417           : [38;5;250m  [39mParsedInternalKey[38;5;250m [39mikey;
   418           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mParseInternalKey(internal_key,[38;5;250m [39m[38;5;241m&[39mikey))[38;5;250m [39m{

........................................

   421           : 
   422           : [38;5;250m  [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;21;01mState[39;00m[38;5;250m [39m{
   423           : [38;5;250m    [39mGetStats[38;5;250m [39mstats;[38;5;250m  [39m[38;5;66;03m// Holds first matching file[39;00m
   424           : [38;5;250m    [39m[38;5;125mint[39m[38;5;250m [39mmatches;
   425           : 
[91mâ†’  426 [9376 â†’ 9338]:[0m [91m[38;5;250m    [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mMatch[39m([38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg,[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mlevel,[38;5;250m [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf)[38;5;250m [39m{[0m
   427           : [38;5;250m      [39mState[38;5;241m*[39m[38;5;250m [39mstate[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mState[38;5;241m*[39m[38;5;241m>[39m(arg);
   428           : [38;5;250m      [39mstate[38;5;241m-[39m[38;5;241m>[39mmatches[38;5;241m+[39m[38;5;241m+[39m;
   429           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(state[38;5;241m-[39m[38;5;241m>[39mmatches[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m)[38;5;250m [39m{
   430           : [38;5;250m        [39m[38;5;66;03m// Remember first match.[39;00m
   431           : [38;5;250m        [39mstate[38;5;241m-[39m[38;5;241m>[39mstats.seek_file[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mf;
   432           : [38;5;250m        [39mstate[38;5;241m-[39m[38;5;241m>[39mstats.seek_file_level[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlevel;
[91mâ†’  433 [9376 â†’ 9338]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  434 [9376 â†’ 9338]:[0m [91m[38;5;250m      [39m[38;5;66;03m// We can stop iterating once we have a second match.[39;00m[0m
   435           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstate[38;5;241m-[39m[38;5;241m>[39mmatches[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m2[39m;
   436           : [38;5;250m    [39m}
   437           : [38;5;250m  [39m};
   438           : 
   439           : [38;5;250m  [39mState[38;5;250m [39mstate;

........................................

   442           : 
   443           : [38;5;250m  [39m[38;5;66;03m// Must have at least two matches since we want to merge across[39;00m
   444           : [38;5;250m  [39m[38;5;66;03m// files. But what if we have a single file that contains many[39;00m
   445           : [38;5;250m  [39m[38;5;66;03m// overwrites and deletions?  Should we have another mechanism for[39;00m
   446           : [38;5;250m  [39m[38;5;66;03m// finding such files?[39;00m
[91mâ†’  447 [2524 â†’ 2486]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(state.matches[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m2[39m)[38;5;250m [39m{[0m
[91mâ†’  448 [2524 â†’ 2486]:[0m [91m[38;5;250m    [39m[38;5;66;03m// 1MB cost is about 1 seek (see comment in Builder::Apply).[39;00m[0m
   449           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mUpdateStats(state.stats);
[91mâ†’  450 [6758 â†’ 6796]:[0m [91m[38;5;250m  [39m}[0m
   451           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
   452           : }
   453           : 
   454           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mVersion::Ref[39m()[38;5;250m [39m{[38;5;250m [39m[38;5;241m+[39m[38;5;241m+[39mrefs_;[38;5;250m [39m}
   455           : 
[91mâ†’  456 [16630 â†’ 16620]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mVersion::Unref[39m()[38;5;250m [39m{[0m
[91mâ†’  457 [16630 â†’ 16620]:[0m [91m[38;5;250m  [39massert([38;5;28;01mthis[39;00m[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mvset_[38;5;241m-[39m[38;5;241m>[39mdummy_versions_);[0m
[91mâ†’  458 [16630 â†’ 16620]:[0m [91m[38;5;250m  [39massert(refs_[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m);[0m
[91mâ†’  459 [16630 â†’ 16620]:[0m [91m[38;5;250m  [39m[38;5;241m-[39m[38;5;241m-[39mrefs_;[0m
[91mâ†’  460 [6843 â†’ 6841]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(refs_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   461           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[38;5;250m [39m[38;5;28;01mthis[39;00m;
[91mâ†’  462 [16630 â†’ 16620]:[0m [91m[38;5;250m  [39m}[0m
   463           : }
   464           : 
   465           : [38;5;125mbool[39m[38;5;250m [39mVersion[38;5;241m:[39m[38;5;241m:[39mOverlapInLevel([38;5;125mint[39m[38;5;250m [39mlevel,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39msmallest_user_key,
[91mâ†’  466 [6862 â†’ 6856]:[0m [91m[38;5;250m                             [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39mlargest_user_key)[38;5;250m [39m{[0m
   467           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mSomeFileOverlapsRange(vset_[38;5;241m-[39m[38;5;241m>[39micmp_,[38;5;250m [39m(level[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m),[38;5;250m [39mfiles_[level],
   468           : [38;5;250m                               [39msmallest_user_key,[38;5;250m [39mlargest_user_key);
   469           : }
   470           : 
   471           : [38;5;125mint[39m[38;5;250m [39mVersion[38;5;241m:[39m[38;5;241m:[39mPickLevelForMemTableOutput([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39msmallest_user_key,
[91mâ†’  472 [828 â†’ 825]:[0m [91m[38;5;250m                                        [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mlargest_user_key)[38;5;250m [39m{[0m
   473           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’  474 [765 â†’ 763]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mOverlapInLevel([38;5;241m0[39m,[38;5;250m [39m[38;5;241m&[39msmallest_user_key,[38;5;250m [39m[38;5;241m&[39mlargest_user_key))[38;5;250m [39m{[0m
   475           : [38;5;250m    [39m[38;5;66;03m// Push to next level if there is no overlap in next level,[39;00m
[91mâ†’  476 [765 â†’ 763]:[0m [91m[38;5;250m    [39m[38;5;66;03m// and the #bytes overlapping in the level after that are limited.[39;00m[0m
   477           : [38;5;250m    [39mInternalKey[38;5;250m [39m[38;5;21mstart[39m(smallest_user_key,[38;5;250m [39mkMaxSequenceNumber,[38;5;250m [39mkValueTypeForSeek);
   478           : [38;5;250m    [39mInternalKey[38;5;250m [39m[38;5;21mlimit[39m(largest_user_key,[38;5;250m [39m[38;5;241m0[39m,[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39mValueType[38;5;241m>[39m([38;5;241m0[39m));
   479           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;250m [39moverlaps;
[91mâ†’  480 [1426 â†’ 1423]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(level[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkMaxMemCompactLevel)[38;5;250m [39m{[0m
[91mâ†’  481 [151 â†’ 150]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(OverlapInLevel(level[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m,[38;5;250m [39m[38;5;241m&[39msmallest_user_key,[38;5;250m [39m[38;5;241m&[39mlargest_user_key))[38;5;250m [39m{[0m
   482           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
[91mâ†’  483 [1275 â†’ 1273]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  484 [1275 â†’ 1273]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(level[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m2[39m[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels)[38;5;250m [39m{[0m
[91mâ†’  485 [1275 â†’ 1273]:[0m [91m[38;5;250m        [39m[38;5;66;03m// Check that file does not overlap too many grandparent bytes.[39;00m[0m
   486           : [38;5;250m        [39mGetOverlappingInputs(level[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m2[39m,[38;5;250m [39m[38;5;241m&[39mstart,[38;5;250m [39m[38;5;241m&[39mlimit,[38;5;250m [39m[38;5;241m&[39moverlaps);
   487           : [38;5;250m        [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint64_t[39m[38;5;250m [39msum[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mTotalFileSize(overlaps);
[91mâ†’  488 [ 67 â†’  66]:[0m [91m[38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(sum[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mMaxGrandParentOverlapBytes(vset_[38;5;241m-[39m[38;5;241m>[39moptions_))[38;5;250m [39m{[0m
   489           : [38;5;250m          [39m[38;5;28;01mbreak[39;00m;
[91mâ†’  490 [1275 â†’ 1273]:[0m [91m[38;5;250m        [39m}[0m
[91mâ†’  491 [1208 â†’ 1207]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  492 [1208 â†’ 1207]:[0m [91m[38;5;250m      [39mlevel[38;5;241m+[39m[38;5;241m+[39m;[0m
[91mâ†’  493 [765 â†’ 763]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  494 [828 â†’ 825]:[0m [91m[38;5;250m  [39m}[0m
   495           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mlevel;
   496           : }
   497           : 
   498           : [38;5;66;03m// Store in "*inputs" all files in "level" that overlap [begin,end][39;00m
   499           : [38;5;125mvoid[39m[38;5;250m [39mVersion[38;5;241m:[39m[38;5;241m:[39mGetOverlappingInputs([38;5;125mint[39m[38;5;250m [39mlevel,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKey[38;5;241m*[39m[38;5;250m [39mbegin,
   500           : [38;5;250m                                   [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKey[38;5;241m*[39m[38;5;250m [39mend,
[91mâ†’  501 [3488 â†’ 3477]:[0m [91m[38;5;250m                                   [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m*[39m[38;5;250m [39minputs)[38;5;250m [39m{[0m
[91mâ†’  502 [3488 â†’ 3477]:[0m [91m[38;5;250m  [39massert(level[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’  503 [3488 â†’ 3477]:[0m [91m[38;5;250m  [39massert(level[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels);[0m
[91mâ†’  504 [3488 â†’ 3477]:[0m [91m[38;5;250m  [39minputs[38;5;241m-[39m[38;5;241m>[39mclear();[0m
   505           : [38;5;250m  [39mSlice[38;5;250m [39muser_begin,[38;5;250m [39muser_end;
[91mâ†’  506 [3488 â†’ 3477]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(begin[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   507           : [38;5;250m    [39muser_begin[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbegin[38;5;241m-[39m[38;5;241m>[39muser_key();
[91mâ†’  508 [3488 â†’ 3477]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  509 [3488 â†’ 3477]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(end[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   510           : [38;5;250m    [39muser_end[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mend[38;5;241m-[39m[38;5;241m>[39muser_key();
[91mâ†’  511 [3488 â†’ 3477]:[0m [91m[38;5;250m  [39m}[0m
   512           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39muser_cmp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mvset_[38;5;241m-[39m[38;5;241m>[39micmp_.user_comparator();
[91mâ†’  513 [1597 â†’ 1589]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfiles_[level].size();)[38;5;250m [39m{[0m
   514           : [38;5;250m    [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfiles_[level][i[38;5;241m+[39m[38;5;241m+[39m];
   515           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;250m [39mfile_start[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39msmallest.user_key();
   516           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;250m [39mfile_limit[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39mlargest.user_key();
   517           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(begin[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39muser_cmp[38;5;241m-[39m[38;5;241m>[39mCompare(file_limit,[38;5;250m [39muser_begin)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   518           : [38;5;250m      [39m[38;5;66;03m// "f" is completely before specified range; skip it[39;00m
   519           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(end[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39muser_cmp[38;5;241m-[39m[38;5;241m>[39mCompare(file_start,[38;5;250m [39muser_end)[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   520           : [38;5;250m      [39m[38;5;66;03m// "f" is completely after specified range; skip it[39;00m
[91mâ†’  521 [1139 â†’ 1131]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   522           : [38;5;250m      [39minputs[38;5;241m-[39m[38;5;241m>[39mpush_back(f);
   523           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(level[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   524           : [38;5;250m        [39m[38;5;66;03m// Level-0 files may overlap each other.  So check if the newly[39;00m
   525           : [38;5;250m        [39m[38;5;66;03m// added file has expanded the range.  If so, restart search.[39;00m
   526           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(begin[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39muser_cmp[38;5;241m-[39m[38;5;241m>[39mCompare(file_start,[38;5;250m [39muser_begin)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{

........................................

   531           : [38;5;250m                   [39muser_cmp[38;5;241m-[39m[38;5;241m>[39mCompare(file_limit,[38;5;250m [39muser_end)[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   532           : [38;5;250m          [39muser_end[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfile_limit;
   533           : [38;5;250m          [39minputs[38;5;241m-[39m[38;5;241m>[39mclear();
   534           : [38;5;250m          [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
   535           : [38;5;250m        [39m}
[91mâ†’  536 [1139 â†’ 1131]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  537 [1597 â†’ 1589]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  538 [3488 â†’ 3477]:[0m [91m[38;5;250m  [39m}[0m
   539           : }
   540           : 
   541           : std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mVersion::DebugString[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{
   542           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mr;
   543           : [38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels;[38;5;250m [39mlevel[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{

........................................

   571           : [38;5;250m [39m[38;5;28;01mprivate[39;00m[38;5;241m:[39m
   572           : [38;5;250m  [39m[38;5;66;03m// Helper to sort by v->files_[file_number].smallest[39;00m
   573           : [38;5;250m  [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;21;01mBySmallestKey[39;00m[38;5;250m [39m{
   574           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKeyComparator[38;5;241m*[39m[38;5;250m [39minternal_comparator;
   575           : 
[91mâ†’  576 [1395 â†’ 1400]:[0m [91m[38;5;250m    [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21moperator[39m()(FileMetaData[38;5;241m*[39m[38;5;250m [39mf1,[38;5;250m [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf2)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
   577           : [38;5;250m      [39m[38;5;125mint[39m[38;5;250m [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minternal_comparator[38;5;241m-[39m[38;5;241m>[39mCompare(f1[38;5;241m-[39m[38;5;241m>[39msmallest,[38;5;250m [39mf2[38;5;241m-[39m[38;5;241m>[39msmallest);
[91mâ†’  578 [1365 â†’ 1370]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   579           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(r[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m);
   580           : [38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   581           : [38;5;250m        [39m[38;5;66;03m// Break ties by file number[39;00m
   582           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(f1[38;5;241m-[39m[38;5;241m>[39mnumber[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mf2[38;5;241m-[39m[38;5;241m>[39mnumber);
[91mâ†’  583 [1395 â†’ 1400]:[0m [91m[38;5;250m      [39m}[0m
   584           : [38;5;250m    [39m}
   585           : [38;5;250m  [39m};
   586           : 
   587           : [38;5;250m  [39m[38;5;28;01mtypedef[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mset[38;5;241m<[39mFileMetaData[38;5;241m*[39m,[38;5;250m [39mBySmallestKey[38;5;241m>[39m[38;5;250m [39mFileSet;
   588           : [38;5;250m  [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;21;01mLevelState[39;00m[38;5;250m [39m{

........................................

   594           : [38;5;250m  [39mVersion[38;5;241m*[39m[38;5;250m [39mbase_;
   595           : [38;5;250m  [39mLevelState[38;5;250m [39mlevels_[config[38;5;241m:[39m[38;5;241m:[39mkNumLevels];
   596           : 
   597           : [38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;241m:[39m
   598           : [38;5;250m  [39m[38;5;66;03m// Initialize a builder with the files from *base and other info from *vset[39;00m
[91mâ†’  599 [5008 â†’ 5006]:[0m [91m[38;5;250m  [39mBuilder(VersionSet[38;5;241m*[39m[38;5;250m [39mvset,[38;5;250m [39mVersion[38;5;241m*[39m[38;5;250m [39mbase)[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mvset_(vset),[38;5;250m [39mbase_(base)[38;5;250m [39m{[0m
   600           : [38;5;250m    [39mbase_[38;5;241m-[39m[38;5;241m>[39mRef();
   601           : [38;5;250m    [39mBySmallestKey[38;5;250m [39mcmp;
   602           : [38;5;250m    [39mcmp.internal_comparator[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mvset_[38;5;241m-[39m[38;5;241m>[39micmp_;
[91mâ†’  603 [35056 â†’ 35042]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels;[38;5;250m [39mlevel[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   604           : [38;5;250m      [39mlevels_[level].added_files[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mFileSet(cmp);
[91mâ†’  605 [5008 â†’ 5006]:[0m [91m[38;5;250m    [39m}[0m
   606           : [38;5;250m  [39m}
   607           : 
[91mâ†’  608 [5008 â†’ 5006]:[0m [91m[38;5;250m  [39m[38;5;241m~[39mBuilder()[38;5;250m [39m{[0m
[91mâ†’  609 [35056 â†’ 35042]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels;[38;5;250m [39mlevel[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   610           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39mFileSet[38;5;241m*[39m[38;5;250m [39madded[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlevels_[level].added_files;
   611           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;250m [39mto_unref;
   612           : [38;5;250m      [39mto_unref.reserve(added[38;5;241m-[39m[38;5;241m>[39msize());
[91mâ†’  613 [35056 â†’ 35042]:[0m [91m[38;5;250m      [39m[38;5;28;01mfor[39;00m[38;5;250m [39m(FileSet[38;5;241m:[39m[38;5;241m:[39mconst_iterator[38;5;250m [39mit[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39madded[38;5;241m-[39m[38;5;241m>[39mbegin();[38;5;250m [39mit[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39madded[38;5;241m-[39m[38;5;241m>[39mend();[0m
[91mâ†’  614 [2205 â†’ 2202]:[0m [91m[38;5;250m           [39m[38;5;241m+[39m[38;5;241m+[39mit)[38;5;250m [39m{[0m
   615           : [38;5;250m        [39mto_unref.push_back([38;5;241m*[39mit);
[91mâ†’  616 [35056 â†’ 35042]:[0m [91m[38;5;250m      [39m}[0m
   617           : [38;5;250m      [39m[38;5;28;01mdelete[39;00m[38;5;250m [39madded;
[91mâ†’  618 [2205 â†’ 2202]:[0m [91m[38;5;250m      [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125muint32_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mto_unref.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   619           : [38;5;250m        [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mto_unref[i];
   620           : [38;5;250m        [39mf[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;241m-[39m[38;5;241m-[39m;
   621           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(f[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   622           : [38;5;250m          [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mf;
[91mâ†’  623 [2205 â†’ 2202]:[0m [91m[38;5;250m        [39m}[0m
[91mâ†’  624 [35056 â†’ 35042]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  625 [5008 â†’ 5006]:[0m [91m[38;5;250m    [39m}[0m
   626           : [38;5;250m    [39mbase_[38;5;241m-[39m[38;5;241m>[39mUnref();
   627           : [38;5;250m  [39m}
   628           : 
   629           : [38;5;250m  [39m[38;5;66;03m// Apply all of the edits in *edit to the current state.[39;00m
[91mâ†’  630 [6054 â†’ 6050]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mApply[39m(VersionEdit[38;5;241m*[39m[38;5;250m [39medit)[38;5;250m [39m{[0m
[91mâ†’  631 [6054 â†’ 6050]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Update compaction pointers[39;00m[0m
[91mâ†’  632 [441 â†’ 442]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39medit[38;5;241m-[39m[38;5;241m>[39mcompact_pointers_.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   633           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39medit[38;5;241m-[39m[38;5;241m>[39mcompact_pointers_[i].first;
   634           : [38;5;250m      [39mvset_[38;5;241m-[39m[38;5;241m>[39mcompact_pointer_[level][38;5;250m [39m[38;5;241m=[39m
   635           : [38;5;250m          [39medit[38;5;241m-[39m[38;5;241m>[39mcompact_pointers_[i].second.Encode().ToString();
[91mâ†’  636 [6054 â†’ 6050]:[0m [91m[38;5;250m    [39m}[0m
   637           : 
[91mâ†’  638 [6054 â†’ 6050]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Delete files[39;00m[0m
[91mâ†’  639 [705 â†’ 708]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01mauto[39;00m[38;5;241m&[39m[38;5;250m [39mdeleted_file_set_kvp[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39medit[38;5;241m-[39m[38;5;241m>[39mdeleted_files_)[38;5;250m [39m{[0m
   640           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdeleted_file_set_kvp.first;
   641           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mnumber[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdeleted_file_set_kvp.second;
   642           : [38;5;250m      [39mlevels_[level].deleted_files.insert(number);
[91mâ†’  643 [6054 â†’ 6050]:[0m [91m[38;5;250m    [39m}[0m
   644           : 
[91mâ†’  645 [6054 â†’ 6050]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Add new files[39;00m[0m
[91mâ†’  646 [2205 â†’ 2202]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39medit[38;5;241m-[39m[38;5;241m>[39mnew_files_.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   647           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39medit[38;5;241m-[39m[38;5;241m>[39mnew_files_[i].first;
   648           : [38;5;250m      [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mFileMetaData(edit[38;5;241m-[39m[38;5;241m>[39mnew_files_[i].second);
   649           : [38;5;250m      [39mf[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;
   650           : 
   651           : [38;5;250m      [39m[38;5;66;03m// We arrange to automatically compact this file after[39;00m

........................................

   658           : [38;5;250m      [39m[38;5;66;03m//         10-12MB written to next level[39;00m
   659           : [38;5;250m      [39m[38;5;66;03m// This implies that 25 seeks cost the same as the compaction[39;00m
   660           : [38;5;250m      [39m[38;5;66;03m// of 1MB of data.  I.e., one seek costs approximately the[39;00m
   661           : [38;5;250m      [39m[38;5;66;03m// same as the compaction of 40KB of data.  We are a little[39;00m
   662           : [38;5;250m      [39m[38;5;66;03m// conservative and allow approximately one seek for every 16KB[39;00m
[91mâ†’  663 [2205 â†’ 2202]:[0m [91m[38;5;250m      [39m[38;5;66;03m// of data before triggering a compaction.[39;00m[0m
   664           : [38;5;250m      [39mf[38;5;241m-[39m[38;5;241m>[39mallowed_seeks[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mint[39m[38;5;241m>[39m((f[38;5;241m-[39m[38;5;241m>[39mfile_size[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39m[38;5;241m16384U[39m));
[91mâ†’  665 [2205 â†’ 2202]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(f[38;5;241m-[39m[38;5;241m>[39mallowed_seeks[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m100[39m)[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39mallowed_seeks[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m100[39m;[0m
[91mâ†’  666 [2205 â†’ 2202]:[0m [91m[0m
   667           : [38;5;250m      [39mlevels_[level].deleted_files.erase(f[38;5;241m-[39m[38;5;241m>[39mnumber);
   668           : [38;5;250m      [39mlevels_[level].added_files[38;5;241m-[39m[38;5;241m>[39minsert(f);
[91mâ†’  669 [6054 â†’ 6050]:[0m [91m[38;5;250m    [39m}[0m
   670           : [38;5;250m  [39m}
   671           : 
   672           : [38;5;250m  [39m[38;5;66;03m// Save the current state in *v.[39;00m
[91mâ†’  673 [5008 â†’ 5006]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSaveTo[39m(Version[38;5;241m*[39m[38;5;250m [39mv)[38;5;250m [39m{[0m
   674           : [38;5;250m    [39mBySmallestKey[38;5;250m [39mcmp;
   675           : [38;5;250m    [39mcmp.internal_comparator[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mvset_[38;5;241m-[39m[38;5;241m>[39micmp_;
[91mâ†’  676 [35056 â†’ 35042]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels;[38;5;250m [39mlevel[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   677           : [38;5;250m      [39m[38;5;66;03m// Merge the set of added files with the set of pre-existing files.[39;00m
[91mâ†’  678 [35056 â†’ 35042]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Drop any deleted files.  Store the result in *v.[39;00m[0m
   679           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39mbase_files[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbase_[38;5;241m-[39m[38;5;241m>[39mfiles_[level];
   680           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mconst_iterator[38;5;250m [39mbase_iter[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbase_files.begin();
   681           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mconst_iterator[38;5;250m [39mbase_end[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbase_files.end();
   682           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39mFileSet[38;5;241m*[39m[38;5;250m [39madded_files[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlevels_[level].added_files;
   683           : [38;5;250m      [39mv[38;5;241m-[39m[38;5;241m>[39mfiles_[level].reserve(base_files.size()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39madded_files[38;5;241m-[39m[38;5;241m>[39msize());
[91mâ†’  684 [2205 â†’ 2202]:[0m [91m[38;5;250m      [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01mauto[39;00m[38;5;241m&[39m[38;5;250m [39madded_file[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;241m*[39madded_files)[38;5;250m [39m{[0m
[91mâ†’  685 [2205 â†’ 2202]:[0m [91m[38;5;250m        [39m[38;5;66;03m// Add all smaller files listed in base_[39;00m[0m
   686           : [38;5;250m        [39m[38;5;28;01mfor[39;00m[38;5;250m [39m(std[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mconst_iterator[38;5;250m [39mbpos[38;5;250m [39m[38;5;241m=[39m
   687           : [38;5;250m                 [39mstd[38;5;241m:[39m[38;5;241m:[39mupper_bound(base_iter,[38;5;250m [39mbase_end,[38;5;250m [39madded_file,[38;5;250m [39mcmp);
[91mâ†’  688 [182 â†’ 181]:[0m [91m[38;5;250m             [39mbase_iter[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mbpos;[38;5;250m [39m[38;5;241m+[39m[38;5;241m+[39mbase_iter)[38;5;250m [39m{[0m
   689           : [38;5;250m          [39mMaybeAddFile(v,[38;5;250m [39mlevel,[38;5;250m [39m[38;5;241m*[39mbase_iter);
[91mâ†’  690 [2205 â†’ 2202]:[0m [91m[38;5;250m        [39m}[0m
[91mâ†’  691 [2205 â†’ 2202]:[0m [91m[0m
   692           : [38;5;250m        [39mMaybeAddFile(v,[38;5;250m [39mlevel,[38;5;250m [39madded_file);
[91mâ†’  693 [35056 â†’ 35042]:[0m [91m[38;5;250m      [39m}[0m
   694           : 
[91mâ†’  695 [35056 â†’ 35042]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Add remaining base files[39;00m[0m
[91mâ†’  696 [1936 â†’ 1937]:[0m [91m[38;5;250m      [39m[38;5;28;01mfor[39;00m[38;5;250m [39m(;[38;5;250m [39mbase_iter[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mbase_end;[38;5;250m [39m[38;5;241m+[39m[38;5;241m+[39mbase_iter)[38;5;250m [39m{[0m
   697           : [38;5;250m        [39mMaybeAddFile(v,[38;5;250m [39mlevel,[38;5;250m [39m[38;5;241m*[39mbase_iter);
[91mâ†’  698 [35056 â†’ 35042]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  699 [35056 â†’ 35042]:[0m [91m[0m
   700           : [38;5;130m#[39m[38;5;130mifndef NDEBUG[39m
[91mâ†’  701 [35056 â†’ 35042]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Make sure there is no overlap in levels > 0[39;00m[0m
[91mâ†’  702 [30048 â†’ 30036]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(level[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
[91mâ†’  703 [439 â†’ 438]:[0m [91m[38;5;250m        [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125muint32_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mv[38;5;241m-[39m[38;5;241m>[39mfiles_[level].size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   704           : [38;5;250m          [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKey[38;5;241m&[39m[38;5;250m [39mprev_end[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;241m-[39m[38;5;241m>[39mfiles_[level][i[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m][38;5;241m-[39m[38;5;241m>[39mlargest;
   705           : [38;5;250m          [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKey[38;5;241m&[39m[38;5;250m [39mthis_begin[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;241m-[39m[38;5;241m>[39mfiles_[level][i][38;5;241m-[39m[38;5;241m>[39msmallest;
   706           : [38;5;250m          [39m[38;5;28;01mif[39;00m[38;5;250m [39m(vset_[38;5;241m-[39m[38;5;241m>[39micmp_.Compare(prev_end,[38;5;250m [39mthis_begin)[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   707           : [38;5;250m            [39mfprintf(stderr,[38;5;250m [39m[38;5;124m"[39m[38;5;124moverlapping ranges in same level %s vs. %s[39m[38;5;130;01m\n[39;00m[38;5;124m"[39m,
   708           : [38;5;250m                    [39mprev_end.DebugString().c_str(),
   709           : [38;5;250m                    [39mthis_begin.DebugString().c_str());
   710           : [38;5;250m            [39mabort();
[91mâ†’  711 [439 â†’ 438]:[0m [91m[38;5;250m          [39m}[0m
[91mâ†’  712 [30048 â†’ 30036]:[0m [91m[38;5;250m        [39m}[0m
[91mâ†’  713 [35056 â†’ 35042]:[0m [91m[38;5;250m      [39m}[0m
   714           : [38;5;130m#[39m[38;5;130mendif[39m
[91mâ†’  715 [5008 â†’ 5006]:[0m [91m[38;5;250m    [39m}[0m
   716           : [38;5;250m  [39m}
   717           : 
[91mâ†’  718 [4323 â†’ 4320]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mMaybeAddFile[39m(Version[38;5;241m*[39m[38;5;250m [39mv,[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mlevel,[38;5;250m [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf)[38;5;250m [39m{[0m
[91mâ†’  719 [705 â†’ 708]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(levels_[level].deleted_files.count(f[38;5;241m-[39m[38;5;241m>[39mnumber)[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
[91mâ†’  720 [705 â†’ 708]:[0m [91m[38;5;250m      [39m[38;5;66;03m// File is deleted: do nothing[39;00m[0m
[91mâ†’  721 [3618 â†’ 3612]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   722           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m*[39m[38;5;250m [39mfiles[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mv[38;5;241m-[39m[38;5;241m>[39mfiles_[level];
[91mâ†’  723 [439 â†’ 438]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(level[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m![39mfiles[38;5;241m-[39m[38;5;241m>[39mempty())[38;5;250m [39m{[0m
[91mâ†’  724 [439 â†’ 438]:[0m [91m[38;5;250m        [39m[38;5;66;03m// Must not overlap[39;00m[0m
   725           : [38;5;250m        [39massert(vset_[38;5;241m-[39m[38;5;241m>[39micmp_.Compare(([38;5;241m*[39mfiles)[files[38;5;241m-[39m[38;5;241m>[39msize()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m][38;5;241m-[39m[38;5;241m>[39mlargest,
   726           : [38;5;250m                                    [39mf[38;5;241m-[39m[38;5;241m>[39msmallest)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m);
[91mâ†’  727 [3618 â†’ 3612]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  728 [3618 â†’ 3612]:[0m [91m[38;5;250m      [39mf[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;241m+[39m[38;5;241m+[39m;[0m
   729           : [38;5;250m      [39mfiles[38;5;241m-[39m[38;5;241m>[39mpush_back(f);
[91mâ†’  730 [4323 â†’ 4320]:[0m [91m[38;5;250m    [39m}[0m
   731           : [38;5;250m  [39m}
   732           : };
   733           : 
   734           : VersionSet[38;5;241m:[39m[38;5;241m:[39mVersionSet([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mdbname,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mOptions[38;5;241m*[39m[38;5;250m [39moptions,
   735           : [38;5;250m                       [39mTableCache[38;5;241m*[39m[38;5;250m [39mtable_cache,

........................................

   756           : [38;5;250m  [39massert(dummy_versions_.next_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mdummy_versions_);[38;5;250m  [39m[38;5;66;03m// List must be empty[39;00m
   757           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mdescriptor_log_;
   758           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mdescriptor_file_;
   759           : }
   760           : 
[91mâ†’  761 [6843 â†’ 6841]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mVersionSet::AppendVersion[39m(Version[38;5;241m*[39m[38;5;250m [39mv)[38;5;250m [39m{[0m
[91mâ†’  762 [6843 â†’ 6841]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Make "v" current[39;00m[0m
   763           : [38;5;250m  [39massert(v[38;5;241m-[39m[38;5;241m>[39mrefs_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);
[91mâ†’  764 [6843 â†’ 6841]:[0m [91m[38;5;250m  [39massert(v[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mcurrent_);[0m
[91mâ†’  765 [5008 â†’ 5006]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(current_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   766           : [38;5;250m    [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mUnref();
[91mâ†’  767 [6843 â†’ 6841]:[0m [91m[38;5;250m  [39m}[0m
   768           : [38;5;250m  [39mcurrent_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv;
   769           : [38;5;250m  [39mv[38;5;241m-[39m[38;5;241m>[39mRef();
   770           : 
[91mâ†’  771 [6843 â†’ 6841]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Append to linked list[39;00m[0m
   772           : [38;5;250m  [39mv[38;5;241m-[39m[38;5;241m>[39mprev_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdummy_versions_.prev_;
   773           : [38;5;250m  [39mv[38;5;241m-[39m[38;5;241m>[39mnext_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mdummy_versions_;
   774           : [38;5;250m  [39mv[38;5;241m-[39m[38;5;241m>[39mprev_[38;5;241m-[39m[38;5;241m>[39mnext_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv;
   775           : [38;5;250m  [39mv[38;5;241m-[39m[38;5;241m>[39mnext_[38;5;241m-[39m[38;5;241m>[39mprev_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv;
   776           : }
   777           : 
[91mâ†’  778 [3173 â†’ 3171]:[0m [91mStatus[38;5;250m [39m[38;5;21mVersionSet::LogAndApply[39m(VersionEdit[38;5;241m*[39m[38;5;250m [39medit,[38;5;250m [39mport[38;5;241m:[39m[38;5;241m:[39mMutex[38;5;241m*[39m[38;5;250m [39mmu)[38;5;250m [39m{[0m
[91mâ†’  779 [2821 â†’ 2818]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(edit[38;5;241m-[39m[38;5;241m>[39mhas_log_number_)[38;5;250m [39m{[0m
[91mâ†’  780 [2821 â†’ 2818]:[0m [91m[38;5;250m    [39massert(edit[38;5;241m-[39m[38;5;241m>[39mlog_number_[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mlog_number_);[0m
[91mâ†’  781 [2821 â†’ 2818]:[0m [91m[38;5;250m    [39massert(edit[38;5;241m-[39m[38;5;241m>[39mlog_number_[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mnext_file_number_);[0m
[91mâ†’  782 [352 â†’ 353]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   783           : [38;5;250m    [39medit[38;5;241m-[39m[38;5;241m>[39mSetLogNumber(log_number_);
[91mâ†’  784 [3173 â†’ 3171]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  785 [3173 â†’ 3171]:[0m [91m[0m
[91mâ†’  786 [352 â†’ 353]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39medit[38;5;241m-[39m[38;5;241m>[39mhas_prev_log_number_)[38;5;250m [39m{[0m
   787           : [38;5;250m    [39medit[38;5;241m-[39m[38;5;241m>[39mSetPrevLogNumber(prev_log_number_);
[91mâ†’  788 [3173 â†’ 3171]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  789 [3173 â†’ 3171]:[0m [91m[0m
   790           : [38;5;250m  [39medit[38;5;241m-[39m[38;5;241m>[39mSetNextFile(next_file_number_);
   791           : [38;5;250m  [39medit[38;5;241m-[39m[38;5;241m>[39mSetLastSequence(last_sequence_);
[91mâ†’  792 [3173 â†’ 3171]:[0m [91m[0m
   793           : [38;5;250m  [39mVersion[38;5;241m*[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mVersion([38;5;28;01mthis[39;00m);
   794           : [38;5;250m  [39m{
   795           : [38;5;250m    [39mBuilder[38;5;250m [39m[38;5;21mbuilder[39m([38;5;28;01mthis[39;00m,[38;5;250m [39mcurrent_);
   796           : [38;5;250m    [39mbuilder.Apply(edit);
   797           : [38;5;250m    [39mbuilder.SaveTo(v);
   798           : [38;5;250m  [39m}
   799           : [38;5;250m  [39mFinalize(v);
   800           : 
   801           : [38;5;250m  [39m[38;5;66;03m// Initialize new descriptor log file if necessary by creating[39;00m
[91mâ†’  802 [3173 â†’ 3171]:[0m [91m[38;5;250m  [39m[38;5;66;03m// a temporary file that contains a snapshot of the current version.[39;00m[0m
   803           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mnew_manifest_file;
   804           : [38;5;250m  [39mStatus[38;5;250m [39ms;
   805           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(descriptor_log_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
   806           : [38;5;250m    [39m[38;5;66;03m// No reason to unlock *mu here since we only hit this path in the[39;00m
   807           : [38;5;250m    [39m[38;5;66;03m// first call to LogAndApply (when opening the database).[39;00m

........................................

   811           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39menv_[38;5;241m-[39m[38;5;241m>[39mNewWritableFile(new_manifest_file,[38;5;250m [39m[38;5;241m&[39mdescriptor_file_);
   812           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{
   813           : [38;5;250m      [39mdescriptor_log_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mlog[38;5;241m:[39m[38;5;241m:[39mWriter(descriptor_file_);
   814           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mWriteSnapshot(descriptor_log_);
   815           : [38;5;250m    [39m}
[91mâ†’  816 [3173 â†’ 3171]:[0m [91m[38;5;250m  [39m}[0m
   817           : 
[91mâ†’  818 [3173 â†’ 3171]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Unlock during expensive MANIFEST log write[39;00m[0m
[91mâ†’  819 [3173 â†’ 3171]:[0m [91m[38;5;250m  [39m{[0m
   820           : [38;5;250m    [39mmu[38;5;241m-[39m[38;5;241m>[39mUnlock();
   821           : 
[91mâ†’  822 [3173 â†’ 3171]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Write new record to MANIFEST log[39;00m[0m
[91mâ†’  823 [3173 â†’ 3171]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   824           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mrecord;
   825           : [38;5;250m      [39medit[38;5;241m-[39m[38;5;241m>[39mEncodeTo([38;5;241m&[39mrecord);
   826           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdescriptor_log_[38;5;241m-[39m[38;5;241m>[39mAddRecord(record);
[91mâ†’  827 [3173 â†’ 3171]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   828           : [38;5;250m        [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdescriptor_file_[38;5;241m-[39m[38;5;241m>[39mSync();
[91mâ†’  829 [3173 â†’ 3171]:[0m [91m[38;5;250m      [39m}[0m
   830           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39ms.ok())[38;5;250m [39m{
   831           : [38;5;250m        [39mLog(options_[38;5;241m-[39m[38;5;241m>[39minfo_log,[38;5;250m [39m[38;5;124m"[39m[38;5;124mMANIFEST write: %s[39m[38;5;130;01m\n[39;00m[38;5;124m"[39m,[38;5;250m [39ms.ToString().c_str());
[91mâ†’  832 [3173 â†’ 3171]:[0m [91m[38;5;250m      [39m}[0m
   833           : [38;5;250m    [39m}
   834           : 
   835           : [38;5;250m    [39m[38;5;66;03m// If we just created a new descriptor file, install it by writing a[39;00m
[91mâ†’  836 [3173 â†’ 3171]:[0m [91m[38;5;250m    [39m[38;5;66;03m// new CURRENT file that points to it.[39;00m[0m
   837           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m![39mnew_manifest_file.empty())[38;5;250m [39m{
   838           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSetCurrentFile(env_,[38;5;250m [39mdbname_,[38;5;250m [39mmanifest_file_number_);
[91mâ†’  839 [3173 â†’ 3171]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  840 [3173 â†’ 3171]:[0m [91m[0m
   841           : [38;5;250m    [39mmu[38;5;241m-[39m[38;5;241m>[39mLock();
   842           : [38;5;250m  [39m}
   843           : 
[91mâ†’  844 [3173 â†’ 3171]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Install the new version[39;00m[0m
[91mâ†’  845 [3173 â†’ 3171]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   846           : [38;5;250m    [39mAppendVersion(v);
   847           : [38;5;250m    [39mlog_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39medit[38;5;241m-[39m[38;5;241m>[39mlog_number_;
   848           : [38;5;250m    [39mprev_log_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39medit[38;5;241m-[39m[38;5;241m>[39mprev_log_number_;
   849           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   850           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mv;

........................................

   853           : [38;5;250m      [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mdescriptor_file_;
   854           : [38;5;250m      [39mdescriptor_log_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
   855           : [38;5;250m      [39mdescriptor_file_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
   856           : [38;5;250m      [39menv_[38;5;241m-[39m[38;5;241m>[39mDeleteFile(new_manifest_file);
   857           : [38;5;250m    [39m}
[91mâ†’  858 [3173 â†’ 3171]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  859 [3173 â†’ 3171]:[0m [91m[0m
   860           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
   861           : }
   862           : 
   863           : Status[38;5;250m [39m[38;5;21mVersionSet::Recover[39m([38;5;125mbool[39m[38;5;241m*[39m[38;5;250m [39msave_manifest)[38;5;250m [39m{
   864           : [38;5;250m  [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;21;01mLogReporter[39;00m[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;250m [39mlog[38;5;241m:[39m[38;5;241m:[39mReader[38;5;241m:[39m[38;5;241m:[39mReporter[38;5;250m [39m{

........................................

   905           : [38;5;250m    [39mreporter.status[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39ms;
   906           : [38;5;250m    [39mlog[38;5;241m:[39m[38;5;241m:[39mReader[38;5;250m [39mreader(file,[38;5;250m [39m[38;5;241m&[39mreporter,[38;5;250m [39m[38;5;28mtrue[39m[38;5;250m [39m[38;5;66;03m/*checksum*/[39;00m,
   907           : [38;5;250m                       [39m[38;5;241m0[39m[38;5;250m [39m[38;5;66;03m/*initial_offset*/[39;00m);
   908           : [38;5;250m    [39mSlice[38;5;250m [39mrecord;
   909           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mscratch;
[91mâ†’  910 [2881 â†’ 2879]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(reader.ReadRecord([38;5;241m&[39mrecord,[38;5;250m [39m[38;5;241m&[39mscratch)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39ms.ok())[38;5;250m [39m{[0m
   911           : [38;5;250m      [39mVersionEdit[38;5;250m [39medit;
   912           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39medit.DecodeFrom(record);
[91mâ†’  913 [2881 â†’ 2879]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
[91mâ†’  914 [2881 â†’ 2879]:[0m [91m[38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(edit.has_comparator_[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
   915           : [38;5;250m            [39medit.comparator_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39micmp_.user_comparator()[38;5;241m-[39m[38;5;241m>[39mName())[38;5;250m [39m{
   916           : [38;5;250m          [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mInvalidArgument(
   917           : [38;5;250m              [39medit.comparator_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124m does not match existing comparator [39m[38;5;124m"[39m,
   918           : [38;5;250m              [39micmp_.user_comparator()[38;5;241m-[39m[38;5;241m>[39mName());
[91mâ†’  919 [2881 â†’ 2879]:[0m [91m[38;5;250m        [39m}[0m
   920           : [38;5;250m      [39m}
[91mâ†’  921 [2881 â†’ 2879]:[0m [91m[0m
[91mâ†’  922 [2881 â†’ 2879]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   923           : [38;5;250m        [39mbuilder.Apply([38;5;241m&[39medit);
[91mâ†’  924 [2881 â†’ 2879]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  925 [2881 â†’ 2879]:[0m [91m[0m
[91mâ†’  926 [2157 â†’ 2155]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(edit.has_log_number_)[38;5;250m [39m{[0m
   927           : [38;5;250m        [39mlog_number[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39medit.log_number_;
   928           : [38;5;250m        [39mhave_log_number[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  929 [2881 â†’ 2879]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  930 [2881 â†’ 2879]:[0m [91m[0m
[91mâ†’  931 [1046 â†’ 1044]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(edit.has_prev_log_number_)[38;5;250m [39m{[0m
   932           : [38;5;250m        [39mprev_log_number[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39medit.prev_log_number_;
   933           : [38;5;250m        [39mhave_prev_log_number[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  934 [2881 â†’ 2879]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  935 [2881 â†’ 2879]:[0m [91m[0m
[91mâ†’  936 [2157 â†’ 2155]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(edit.has_next_file_number_)[38;5;250m [39m{[0m
   937           : [38;5;250m        [39mnext_file[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39medit.next_file_number_;
   938           : [38;5;250m        [39mhave_next_file[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  939 [2881 â†’ 2879]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  940 [2881 â†’ 2879]:[0m [91m[0m
[91mâ†’  941 [2157 â†’ 2155]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(edit.has_last_sequence_)[38;5;250m [39m{[0m
   942           : [38;5;250m        [39mlast_sequence[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39medit.last_sequence_;
   943           : [38;5;250m        [39mhave_last_sequence[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  944 [2881 â†’ 2879]:[0m [91m[38;5;250m      [39m}[0m
   945           : [38;5;250m    [39m}
   946           : [38;5;250m  [39m}
   947           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mfile;
   948           : [38;5;250m  [39mfile[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
   949           : 

........................................

  1016           : [38;5;250m  [39mdescriptor_log_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mlog[38;5;241m:[39m[38;5;241m:[39mWriter(descriptor_file_,[38;5;250m [39mmanifest_size);
  1017           : [38;5;250m  [39mmanifest_file_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmanifest_number;
  1018           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
  1019           : }
  1020           : 
[91mâ†’ 1021 [4519 â†’ 4521]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mVersionSet::MarkFileNumberUsed[39m([38;5;125muint64_t[39m[38;5;250m [39mnumber)[38;5;250m [39m{[0m
  1022           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(next_file_number_[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39mnumber)[38;5;250m [39m{
  1023           : [38;5;250m    [39mnext_file_number_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnumber[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m;
[91mâ†’ 1024 [4519 â†’ 4521]:[0m [91m[38;5;250m  [39m}[0m
  1025           : }
  1026           : 
[91mâ†’ 1027 [5008 â†’ 5006]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mVersionSet::Finalize[39m(Version[38;5;241m*[39m[38;5;250m [39mv)[38;5;250m [39m{[0m
[91mâ†’ 1028 [5008 â†’ 5006]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Precomputed best level for next compaction[39;00m[0m
  1029           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mbest_level[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m-1[39m;
  1030           : [38;5;250m  [39m[38;5;125mdouble[39m[38;5;250m [39mbest_score[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m-1[39m;
[91mâ†’ 1031 [5008 â†’ 5006]:[0m [91m[0m
[91mâ†’ 1032 [30048 â†’ 30036]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m;[38;5;250m [39mlevel[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
  1033           : [38;5;250m    [39m[38;5;125mdouble[39m[38;5;250m [39mscore;
[91mâ†’ 1034 [5008 â†’ 5006]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(level[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
  1035           : [38;5;250m      [39m[38;5;66;03m// We treat level-0 specially by bounding the number of files[39;00m
  1036           : [38;5;250m      [39m[38;5;66;03m// instead of number of bytes for two reasons:[39;00m
  1037           : [38;5;250m      [39m[38;5;66;03m//[39;00m
  1038           : [38;5;250m      [39m[38;5;66;03m// (1) With larger write-buffer sizes, it is nice not to do too[39;00m
  1039           : [38;5;250m      [39m[38;5;66;03m// many level-0 compactions.[39;00m

........................................

  1040           : [38;5;250m      [39m[38;5;66;03m//[39;00m
  1041           : [38;5;250m      [39m[38;5;66;03m// (2) The files in level-0 are merged on every read and[39;00m
  1042           : [38;5;250m      [39m[38;5;66;03m// therefore we wish to avoid too many files when the individual[39;00m
  1043           : [38;5;250m      [39m[38;5;66;03m// file size is small (perhaps because of a small write-buffer[39;00m
  1044           : [38;5;250m      [39m[38;5;66;03m// setting, or very high compression ratios, or lots of[39;00m
[91mâ†’ 1045 [5008 â†’ 5006]:[0m [91m[38;5;250m      [39m[38;5;66;03m// overwrites/deletions).[39;00m[0m
  1046           : [38;5;250m      [39mscore[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;241m-[39m[38;5;241m>[39mfiles_[level].size()[38;5;250m [39m[38;5;241m/[39m
  1047           : [38;5;250m              [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mdouble[39m[38;5;241m>[39m(config[38;5;241m:[39m[38;5;241m:[39mkL0_CompactionTrigger);
[91mâ†’ 1048 [25040 â†’ 25030]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
[91mâ†’ 1049 [25040 â†’ 25030]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Compute the ratio of current size to size limit.[39;00m[0m
  1050           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mlevel_bytes[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mTotalFileSize(v[38;5;241m-[39m[38;5;241m>[39mfiles_[level]);
  1051           : [38;5;250m      [39mscore[38;5;250m [39m[38;5;241m=[39m
  1052           : [38;5;250m          [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mdouble[39m[38;5;241m>[39m(level_bytes)[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39mMaxBytesForLevel(options_,[38;5;250m [39mlevel);
[91mâ†’ 1053 [30048 â†’ 30036]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’ 1054 [30048 â†’ 30036]:[0m [91m[0m
[91mâ†’ 1055 [6217 â†’ 6208]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(score[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mbest_score)[38;5;250m [39m{[0m
  1056           : [38;5;250m      [39mbest_level[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlevel;
  1057           : [38;5;250m      [39mbest_score[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mscore;
[91mâ†’ 1058 [30048 â†’ 30036]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’ 1059 [5008 â†’ 5006]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’ 1060 [5008 â†’ 5006]:[0m [91m[0m
  1061           : [38;5;250m  [39mv[38;5;241m-[39m[38;5;241m>[39mcompaction_level_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbest_level;
  1062           : [38;5;250m  [39mv[38;5;241m-[39m[38;5;241m>[39mcompaction_score_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbest_score;
  1063           : }
  1064           : 
  1065           : Status[38;5;250m [39m[38;5;21mVersionSet::WriteSnapshot[39m(log[38;5;241m:[39m[38;5;241m:[39mWriter[38;5;241m*[39m[38;5;250m [39mlog)[38;5;250m [39m{

........................................

  1079           : [38;5;250m  [39m}
  1080           : 
  1081           : [38;5;250m  [39m[38;5;66;03m// Save files[39;00m
  1082           : [38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels;[38;5;250m [39mlevel[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{
  1083           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39mfiles[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mfiles_[level];
[91mâ†’ 1084 [465 â†’ 463]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfiles.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
  1085           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfiles[i];
  1086           : [38;5;250m      [39medit.AddFile(level,[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39mnumber,[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39mfile_size,[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39msmallest,[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39mlargest);
  1087           : [38;5;250m    [39m}
  1088           : [38;5;250m  [39m}
  1089           : 

........................................

  1090           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mrecord;
  1091           : [38;5;250m  [39medit.EncodeTo([38;5;241m&[39mrecord);
  1092           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mlog[38;5;241m-[39m[38;5;241m>[39mAddRecord(record);
  1093           : }
  1094           : 
[91mâ†’ 1095 [4753 â†’ 4754]:[0m [91m[38;5;125mint[39m[38;5;250m [39m[38;5;21mVersionSet::NumLevelFiles[39m([38;5;125mint[39m[38;5;250m [39mlevel)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’ 1096 [4753 â†’ 4754]:[0m [91m[38;5;250m  [39massert(level[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’ 1097 [4753 â†’ 4754]:[0m [91m[38;5;250m  [39massert(level[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels);[0m
[91mâ†’ 1098 [4753 â†’ 4754]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mfiles_[level].size();[0m
  1099           : }
  1100           : 
[91mâ†’ 1101 [386 â†’ 383]:[0m [91m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mVersionSet::LevelSummary[39m(LevelSummaryStorage[38;5;241m*[39m[38;5;250m [39mscratch)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’ 1102 [386 â†’ 383]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Update code if kNumLevels changes[39;00m[0m
  1103           : [38;5;250m  [39m[38;5;28;01mstatic_assert[39;00m(config[38;5;241m:[39m[38;5;241m:[39mkNumLevels[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m7[39m,[38;5;250m [39m[38;5;124m"[39m[38;5;124m"[39m);
  1104           : [38;5;250m  [39msnprintf(scratch[38;5;241m-[39m[38;5;241m>[39mbuffer,[38;5;250m [39m[38;5;28;01msizeof[39;00m(scratch[38;5;241m-[39m[38;5;241m>[39mbuffer),
  1105           : [38;5;250m           [39m[38;5;124m"[39m[38;5;124mfiles[ %d %d %d %d %d %d %d ][39m[38;5;124m"[39m,[38;5;250m [39m[38;5;125mint[39m(current_[38;5;241m-[39m[38;5;241m>[39mfiles_[[38;5;241m0[39m].size()),
  1106           : [38;5;250m           [39m[38;5;125mint[39m(current_[38;5;241m-[39m[38;5;241m>[39mfiles_[[38;5;241m1[39m].size()),[38;5;250m [39m[38;5;125mint[39m(current_[38;5;241m-[39m[38;5;241m>[39mfiles_[[38;5;241m2[39m].size()),
  1107           : [38;5;250m           [39m[38;5;125mint[39m(current_[38;5;241m-[39m[38;5;241m>[39mfiles_[[38;5;241m3[39m].size()),[38;5;250m [39m[38;5;125mint[39m(current_[38;5;241m-[39m[38;5;241m>[39mfiles_[[38;5;241m4[39m].size()),

........................................

  1139           : [38;5;250m    [39m}
  1140           : [38;5;250m  [39m}
  1141           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;
  1142           : }
  1143           : 
[91mâ†’ 1144 [4978 â†’ 4976]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mVersionSet::AddLiveFiles[39m(std[38;5;241m:[39m[38;5;241m:[39mset[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m[38;5;241m*[39m[38;5;250m [39mlive)[38;5;250m [39m{[0m
[91mâ†’ 1145 [4978 â†’ 4976]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m(Version[38;5;241m*[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdummy_versions_.next_;[38;5;250m [39mv[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mdummy_versions_;[0m
[91mâ†’ 1146 [5003 â†’ 5002]:[0m [91m[38;5;250m       [39mv[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;241m-[39m[38;5;241m>[39mnext_)[38;5;250m [39m{[0m
[91mâ†’ 1147 [35021 â†’ 35014]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels;[38;5;250m [39mlevel[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
  1148           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39mfiles[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;241m-[39m[38;5;241m>[39mfiles_[level];
[91mâ†’ 1149 [3613 â†’ 3608]:[0m [91m[38;5;250m      [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfiles.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
  1150           : [38;5;250m        [39mlive[38;5;241m-[39m[38;5;241m>[39minsert(files[i][38;5;241m-[39m[38;5;241m>[39mnumber);
[91mâ†’ 1151 [35021 â†’ 35014]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’ 1152 [5003 â†’ 5002]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’ 1153 [4978 â†’ 4976]:[0m [91m[38;5;250m  [39m}[0m
  1154           : }
  1155           : 
  1156           : [38;5;125mint64_t[39m[38;5;250m [39m[38;5;21mVersionSet::NumLevelBytes[39m([38;5;125mint[39m[38;5;250m [39mlevel)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{
  1157           : [38;5;250m  [39massert(level[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);
  1158           : [38;5;250m  [39massert(level[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels);

........................................

  1178           : 
  1179           : [38;5;66;03m// Stores the minimal range that covers all entries in inputs in[39;00m
  1180           : [38;5;66;03m// *smallest, *largest.[39;00m
  1181           : [38;5;66;03m// REQUIRES: inputs is not empty[39;00m
  1182           : [38;5;125mvoid[39m[38;5;250m [39mVersionSet[38;5;241m:[39m[38;5;241m:[39mGetRange([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39minputs,
[91mâ†’ 1183 [792 â†’ 786]:[0m [91m[38;5;250m                          [39mInternalKey[38;5;241m*[39m[38;5;250m [39msmallest,[38;5;250m [39mInternalKey[38;5;241m*[39m[38;5;250m [39mlargest)[38;5;250m [39m{[0m
[91mâ†’ 1184 [792 â†’ 786]:[0m [91m[38;5;250m  [39massert([38;5;241m![39minputs.empty());[0m
[91mâ†’ 1185 [792 â†’ 786]:[0m [91m[38;5;250m  [39msmallest[38;5;241m-[39m[38;5;241m>[39mClear();[0m
  1186           : [38;5;250m  [39mlargest[38;5;241m-[39m[38;5;241m>[39mClear();
[91mâ†’ 1187 [1158 â†’ 1149]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39minputs.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
  1188           : [38;5;250m    [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minputs[i];
[91mâ†’ 1189 [792 â†’ 786]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(i[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
  1190           : [38;5;250m      [39m[38;5;241m*[39msmallest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39msmallest;
  1191           : [38;5;250m      [39m[38;5;241m*[39mlargest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39mlargest;
[91mâ†’ 1192 [366 â†’ 363]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
  1193           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(icmp_.Compare(f[38;5;241m-[39m[38;5;241m>[39msmallest,[38;5;250m [39m[38;5;241m*[39msmallest)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
  1194           : [38;5;250m        [39m[38;5;241m*[39msmallest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39msmallest;
[91mâ†’ 1195 [366 â†’ 363]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’ 1196 [308 â†’ 305]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(icmp_.Compare(f[38;5;241m-[39m[38;5;241m>[39mlargest,[38;5;250m [39m[38;5;241m*[39mlargest)[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
  1197           : [38;5;250m        [39m[38;5;241m*[39mlargest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39mlargest;
[91mâ†’ 1198 [366 â†’ 363]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’ 1199 [1158 â†’ 1149]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’ 1200 [792 â†’ 786]:[0m [91m[38;5;250m  [39m}[0m
  1201           : }
  1202           : 
  1203           : [38;5;66;03m// Stores the minimal range that covers all entries in inputs1 and inputs2[39;00m
  1204           : [38;5;66;03m// in *smallest, *largest.[39;00m
  1205           : [38;5;66;03m// REQUIRES: inputs is not empty[39;00m
  1206           : [38;5;125mvoid[39m[38;5;250m [39mVersionSet[38;5;241m:[39m[38;5;241m:[39mGetRange2([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39minputs1,
  1207           : [38;5;250m                           [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39minputs2,
[91mâ†’ 1208 [390 â†’ 387]:[0m [91m[38;5;250m                           [39mInternalKey[38;5;241m*[39m[38;5;250m [39msmallest,[38;5;250m [39mInternalKey[38;5;241m*[39m[38;5;250m [39mlargest)[38;5;250m [39m{[0m
  1209           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;250m [39mall[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minputs1;
  1210           : [38;5;250m  [39mall.insert(all.end(),[38;5;250m [39minputs2.begin(),[38;5;250m [39minputs2.end());
  1211           : [38;5;250m  [39mGetRange(all,[38;5;250m [39msmallest,[38;5;250m [39mlargest);
  1212           : }
  1213           : 
[91mâ†’ 1214 [356 â†’ 353]:[0m [91mIterator[38;5;241m*[39m[38;5;250m [39m[38;5;21mVersionSet::MakeInputIterator[39m(Compaction[38;5;241m*[39m[38;5;250m [39mc)[38;5;250m [39m{[0m
  1215           : [38;5;250m  [39mReadOptions[38;5;250m [39moptions;
  1216           : [38;5;250m  [39moptions.verify_checksums[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39moptions_[38;5;241m-[39m[38;5;241m>[39mparanoid_checks;
  1217           : [38;5;250m  [39moptions.fill_cache[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
  1218           : 
  1219           : [38;5;250m  [39m[38;5;66;03m// Level-0 files have to be merged together.  For other levels,[39;00m
  1220           : [38;5;250m  [39m[38;5;66;03m// we will make a concatenating iterator per level.[39;00m
[91mâ†’ 1221 [356 â†’ 353]:[0m [91m[38;5;250m  [39m[38;5;66;03m// TODO(opt): use concatenating iterator for level-0 if there is no overlap[39;00m[0m
[91mâ†’ 1222 [356 â†’ 353]:[0m [91m[38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mspace[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(c[38;5;241m-[39m[38;5;241m>[39mlevel()[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m].size()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;241m2[39m);[0m
  1223           : [38;5;250m  [39mIterator[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mlist[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mIterator[38;5;241m*[39m[space];
  1224           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mnum[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’ 1225 [712 â†’ 706]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mwhich[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mwhich[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m2[39m;[38;5;250m [39mwhich[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
[91mâ†’ 1226 [539 â†’ 533]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mc[38;5;241m-[39m[38;5;241m>[39minputs_[which].empty())[38;5;250m [39m{[0m
  1227           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(c[38;5;241m-[39m[38;5;241m>[39mlevel()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mwhich[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
  1228           : [38;5;250m        [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39mfiles[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mc[38;5;241m-[39m[38;5;241m>[39minputs_[which];
  1229           : [38;5;250m        [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfiles.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{
  1230           : [38;5;250m          [39mlist[num[38;5;241m+[39m[38;5;241m+[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mtable_cache_[38;5;241m-[39m[38;5;241m>[39mNewIterator(options,[38;5;250m [39mfiles[i][38;5;241m-[39m[38;5;241m>[39mnumber,
  1231           : [38;5;250m                                                  [39mfiles[i][38;5;241m-[39m[38;5;241m>[39mfile_size);
  1232           : [38;5;250m        [39m}
[91mâ†’ 1233 [347 â†’ 341]:[0m [91m[38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
[91mâ†’ 1234 [347 â†’ 341]:[0m [91m[38;5;250m        [39m[38;5;66;03m// Create concatenating iterator for the files from this level[39;00m[0m
  1235           : [38;5;250m        [39mlist[num[38;5;241m+[39m[38;5;241m+[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mNewTwoLevelIterator(
  1236           : [38;5;250m            [39m[38;5;28;01mnew[39;00m[38;5;250m [39mVersion[38;5;241m:[39m[38;5;241m:[39mLevelFileNumIterator(icmp_,[38;5;250m [39m[38;5;241m&[39mc[38;5;241m-[39m[38;5;241m>[39minputs_[which]),
  1237           : [38;5;250m            [39m[38;5;241m&[39mGetFileIterator,[38;5;250m [39mtable_cache_,[38;5;250m [39moptions);
[91mâ†’ 1238 [539 â†’ 533]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’ 1239 [712 â†’ 706]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’ 1240 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
  1241           : [38;5;250m  [39massert(num[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39mspace);
[91mâ†’ 1242 [356 â†’ 353]:[0m [91m[38;5;250m  [39mIterator[38;5;241m*[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mNewMergingIterator([38;5;241m&[39micmp_,[38;5;250m [39mlist,[38;5;250m [39mnum);[0m
  1243           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mlist;
[91mâ†’ 1244 [356 â†’ 353]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;[0m
  1245           : }
  1246           : 
[91mâ†’ 1247 [112 â†’ 109]:[0m [91mCompaction[38;5;241m*[39m[38;5;250m [39m[38;5;21mVersionSet::PickCompaction[39m()[38;5;250m [39m{[0m
  1248           : [38;5;250m  [39mCompaction[38;5;241m*[39m[38;5;250m [39mc;
  1249           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mlevel;
  1250           : 
  1251           : [38;5;250m  [39m[38;5;66;03m// We prefer compactions triggered by too much data in a level over[39;00m
[91mâ†’ 1252 [112 â†’ 109]:[0m [91m[38;5;250m  [39m[38;5;66;03m// the compactions triggered by seeks.[39;00m[0m
  1253           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39msize_compaction[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(current_[38;5;241m-[39m[38;5;241m>[39mcompaction_score_[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m);
  1254           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39mseek_compaction[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(current_[38;5;241m-[39m[38;5;241m>[39mfile_to_compact_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);
[91mâ†’ 1255 [112 â†’ 109]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(size_compaction)[38;5;250m [39m{[0m
  1256           : [38;5;250m    [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mcompaction_level_;
[91mâ†’ 1257 [112 â†’ 109]:[0m [91m[38;5;250m    [39massert(level[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’ 1258 [112 â†’ 109]:[0m [91m[38;5;250m    [39massert(level[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels);[0m
[91mâ†’ 1259 [112 â†’ 109]:[0m [91m[38;5;250m    [39mc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mCompaction(options_,[38;5;250m [39mlevel);[0m
  1260           : 
[91mâ†’ 1261 [112 â†’ 109]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Pick the first file that comes after compact_pointer_[level][39;00m[0m
[91mâ†’ 1262 [113 â†’ 110]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mfiles_[level].size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
  1263           : [38;5;250m      [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mfiles_[level][i];
[91mâ†’ 1264 [113 â†’ 110]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(compact_pointer_[level].empty()[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[0m
[91mâ†’ 1265 [108 â†’ 105]:[0m [91m[38;5;250m          [39micmp_.Compare(f[38;5;241m-[39m[38;5;241m>[39mlargest.Encode(),[38;5;250m [39mcompact_pointer_[level])[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
  1266           : [38;5;250m        [39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m].push_back(f);
  1267           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
[91mâ†’ 1268 [113 â†’ 110]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’ 1269 [112 â†’ 109]:[0m [91m[38;5;250m    [39m}[0m
  1270           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(c[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m].empty())[38;5;250m [39m{
  1271           : [38;5;250m      [39m[38;5;66;03m// Wrap-around to the beginning of the key space[39;00m
  1272           : [38;5;250m      [39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m].push_back(current_[38;5;241m-[39m[38;5;241m>[39mfiles_[level][[38;5;241m0[39m]);
[91mâ†’ 1273 [112 â†’ 109]:[0m [91m[38;5;250m    [39m}[0m
  1274           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(seek_compaction)[38;5;250m [39m{
  1275           : [38;5;250m    [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mfile_to_compact_level_;
  1276           : [38;5;250m    [39mc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mCompaction(options_,[38;5;250m [39mlevel);
  1277           : [38;5;250m    [39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m].push_back(current_[38;5;241m-[39m[38;5;241m>[39mfile_to_compact_);
  1278           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
  1279           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’ 1280 [112 â†’ 109]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’ 1281 [112 â†’ 109]:[0m [91m[0m
[91mâ†’ 1282 [112 â†’ 109]:[0m [91m[38;5;250m  [39mc[38;5;241m-[39m[38;5;241m>[39minput_version_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcurrent_;[0m
  1283           : [38;5;250m  [39mc[38;5;241m-[39m[38;5;241m>[39minput_version_[38;5;241m-[39m[38;5;241m>[39mRef();
  1284           : 
[91mâ†’ 1285 [112 â†’ 109]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Files in level 0 may overlap each other, so pick up all overlapping ones[39;00m[0m
  1286           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(level[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
  1287           : [38;5;250m    [39mInternalKey[38;5;250m [39msmallest,[38;5;250m [39mlargest;
  1288           : [38;5;250m    [39mGetRange(c[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m],[38;5;250m [39m[38;5;241m&[39msmallest,[38;5;250m [39m[38;5;241m&[39mlargest);
  1289           : [38;5;250m    [39m[38;5;66;03m// Note that the next call will discard the file we placed in[39;00m
  1290           : [38;5;250m    [39m[38;5;66;03m// c->inputs_[0] earlier and replace it with an overlapping set[39;00m
  1291           : [38;5;250m    [39m[38;5;66;03m// which will include the picked file.[39;00m
  1292           : [38;5;250m    [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mGetOverlappingInputs([38;5;241m0[39m,[38;5;250m [39m[38;5;241m&[39msmallest,[38;5;250m [39m[38;5;241m&[39mlargest,[38;5;250m [39m[38;5;241m&[39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m]);
  1293           : [38;5;250m    [39massert([38;5;241m![39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m].empty());
[91mâ†’ 1294 [112 â†’ 109]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’ 1295 [112 â†’ 109]:[0m [91m[0m
[91mâ†’ 1296 [112 â†’ 109]:[0m [91m[38;5;250m  [39mSetupOtherInputs(c);[0m
[91mâ†’ 1297 [112 â†’ 109]:[0m [91m[0m
  1298           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mc;
  1299           : }
  1300           : 
  1301           : [38;5;66;03m// Finds the largest key in a vector of files. Returns true if files it not[39;00m
  1302           : [38;5;66;03m// empty.[39;00m
  1303           : [38;5;125mbool[39m[38;5;250m [39mFindLargestKey([38;5;28;01mconst[39;00m[38;5;250m [39mInternalKeyComparator[38;5;241m&[39m[38;5;250m [39micmp,
  1304           : [38;5;250m                    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39mfiles,
[91mâ†’ 1305 [569 â†’ 563]:[0m [91m[38;5;250m                    [39mInternalKey[38;5;241m*[39m[38;5;250m [39mlargest_key)[38;5;250m [39m{[0m
  1306           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(files.empty())[38;5;250m [39m{
  1307           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’ 1308 [569 â†’ 563]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’ 1309 [569 â†’ 563]:[0m [91m[38;5;250m  [39m[38;5;241m*[39mlargest_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfiles[[38;5;241m0[39m][38;5;241m-[39m[38;5;241m>[39mlargest;[0m
  1310           : [38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfiles.size();[38;5;250m [39m[38;5;241m+[39m[38;5;241m+[39mi)[38;5;250m [39m{
  1311           : [38;5;250m    [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfiles[i];
  1312           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(icmp.Compare(f[38;5;241m-[39m[38;5;241m>[39mlargest,[38;5;250m [39m[38;5;241m*[39mlargest_key)[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
  1313           : [38;5;250m      [39m[38;5;241m*[39mlargest_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mf[38;5;241m-[39m[38;5;241m>[39mlargest;
  1314           : [38;5;250m    [39m}
[91mâ†’ 1315 [569 â†’ 563]:[0m [91m[38;5;250m  [39m}[0m
  1316           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
  1317           : }
  1318           : 
  1319           : [38;5;66;03m// Finds minimum file b2=(l2, u2) in level file for which l2 > u1 and[39;00m
  1320           : [38;5;66;03m// user_key(l2) = user_key(u1)[39;00m
  1321           : FileMetaData[38;5;241m*[39m[38;5;250m [39mFindSmallestBoundaryFile(
  1322           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKeyComparator[38;5;241m&[39m[38;5;250m [39micmp,
  1323           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39mlevel_files,
[91mâ†’ 1324 [569 â†’ 563]:[0m [91m[38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKey[38;5;241m&[39m[38;5;250m [39mlargest_key)[38;5;250m [39m{[0m
  1325           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39muser_cmp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39micmp.user_comparator();
  1326           : [38;5;250m  [39mFileMetaData[38;5;241m*[39m[38;5;250m [39msmallest_boundary_file[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’ 1327 [731 â†’ 725]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mlevel_files.size();[38;5;250m [39m[38;5;241m+[39m[38;5;241m+[39mi)[38;5;250m [39m{[0m
  1328           : [38;5;250m    [39mFileMetaData[38;5;241m*[39m[38;5;250m [39mf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlevel_files[i];
[91mâ†’ 1329 [731 â†’ 725]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(icmp.Compare(f[38;5;241m-[39m[38;5;241m>[39msmallest,[38;5;250m [39mlargest_key)[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
  1330           : [38;5;250m        [39muser_cmp[38;5;241m-[39m[38;5;241m>[39mCompare(f[38;5;241m-[39m[38;5;241m>[39msmallest.user_key(),[38;5;250m [39mlargest_key.user_key())[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m
  1331           : [38;5;250m            [39m[38;5;241m0[39m)[38;5;250m [39m{
  1332           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(smallest_boundary_file[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m
  1333           : [38;5;250m          [39micmp.Compare(f[38;5;241m-[39m[38;5;241m>[39msmallest,[38;5;250m [39msmallest_boundary_file[38;5;241m-[39m[38;5;241m>[39msmallest)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
  1334           : [38;5;250m        [39msmallest_boundary_file[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mf;
  1335           : [38;5;250m      [39m}
[91mâ†’ 1336 [731 â†’ 725]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’ 1337 [569 â†’ 563]:[0m [91m[38;5;250m  [39m}[0m
  1338           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39msmallest_boundary_file;
  1339           : }
  1340           : 
  1341           : [38;5;66;03m// Extracts the largest file b1 from |compaction_files| and then searches for a[39;00m
  1342           : [38;5;66;03m// b2 in |level_files| for which user_key(u1) = user_key(l2). If it finds such a[39;00m

........................................

  1352           : [38;5;66;03m// parameters:[39;00m
  1353           : [38;5;66;03m//   in     level_files:      List of files to search for boundary files.[39;00m
  1354           : [38;5;66;03m//   in/out compaction_files: List of files to extend by adding boundary files.[39;00m
  1355           : [38;5;125mvoid[39m[38;5;250m [39mAddBoundaryInputs([38;5;28;01mconst[39;00m[38;5;250m [39mInternalKeyComparator[38;5;241m&[39m[38;5;250m [39micmp,
  1356           : [38;5;250m                       [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m&[39m[38;5;250m [39mlevel_files,
[91mâ†’ 1357 [569 â†’ 563]:[0m [91m[38;5;250m                       [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;241m*[39m[38;5;250m [39mcompaction_files)[38;5;250m [39m{[0m
  1358           : [38;5;250m  [39mInternalKey[38;5;250m [39mlargest_key;
  1359           : 
[91mâ†’ 1360 [569 â†’ 563]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Quick return if compaction_files is empty.[39;00m[0m
  1361           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mFindLargestKey(icmp,[38;5;250m [39m[38;5;241m*[39mcompaction_files,[38;5;250m [39m[38;5;241m&[39mlargest_key))[38;5;250m [39m{
  1362           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m;
[91mâ†’ 1363 [569 â†’ 563]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’ 1364 [569 â†’ 563]:[0m [91m[0m
[91mâ†’ 1365 [569 â†’ 563]:[0m [91m[38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39mcontinue_searching[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;[0m
[91mâ†’ 1366 [569 â†’ 563]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(continue_searching)[38;5;250m [39m{[0m
  1367           : [38;5;250m    [39mFileMetaData[38;5;241m*[39m[38;5;250m [39msmallest_boundary_file[38;5;250m [39m[38;5;241m=[39m
  1368           : [38;5;250m        [39mFindSmallestBoundaryFile(icmp,[38;5;250m [39mlevel_files,[38;5;250m [39mlargest_key);
  1369           : 
[91mâ†’ 1370 [569 â†’ 563]:[0m [91m[38;5;250m    [39m[38;5;66;03m// If a boundary file was found advance largest_key, otherwise we're done.[39;00m[0m
  1371           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(smallest_boundary_file[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mNULL[39m)[38;5;250m [39m{
  1372           : [38;5;250m      [39mcompaction_files[38;5;241m-[39m[38;5;241m>[39mpush_back(smallest_boundary_file);
  1373           : [38;5;250m      [39mlargest_key[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39msmallest_boundary_file[38;5;241m-[39m[38;5;241m>[39mlargest;
[91mâ†’ 1374 [569 â†’ 563]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
  1375           : [38;5;250m      [39mcontinue_searching[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’ 1376 [569 â†’ 563]:[0m [91m[38;5;250m    [39m}[0m
  1377           : [38;5;250m  [39m}
  1378           : }
  1379           : 
[91mâ†’ 1380 [386 â†’ 383]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mVersionSet::SetupOtherInputs[39m(Compaction[38;5;241m*[39m[38;5;250m [39mc)[38;5;250m [39m{[0m
  1381           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mlevel[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mc[38;5;241m-[39m[38;5;241m>[39mlevel();
  1382           : [38;5;250m  [39mInternalKey[38;5;250m [39msmallest,[38;5;250m [39mlargest;
[91mâ†’ 1383 [386 â†’ 383]:[0m [91m[0m
  1384           : [38;5;250m  [39mAddBoundaryInputs(icmp_,[38;5;250m [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mfiles_[level],[38;5;250m [39m[38;5;241m&[39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m]);
  1385           : [38;5;250m  [39mGetRange(c[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m],[38;5;250m [39m[38;5;241m&[39msmallest,[38;5;250m [39m[38;5;241m&[39mlargest);
[91mâ†’ 1386 [386 â†’ 383]:[0m [91m[0m
  1387           : [38;5;250m  [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mGetOverlappingInputs(level[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m,[38;5;250m [39m[38;5;241m&[39msmallest,[38;5;250m [39m[38;5;241m&[39mlargest,
  1388           : [38;5;250m                                 [39m[38;5;241m&[39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m1[39m]);
  1389           : 
[91mâ†’ 1390 [386 â†’ 383]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Get entire range covered by compaction[39;00m[0m
  1391           : [38;5;250m  [39mInternalKey[38;5;250m [39mall_start,[38;5;250m [39mall_limit;
  1392           : [38;5;250m  [39mGetRange2(c[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m],[38;5;250m [39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m1[39m],[38;5;250m [39m[38;5;241m&[39mall_start,[38;5;250m [39m[38;5;241m&[39mall_limit);
  1393           : 
  1394           : [38;5;250m  [39m[38;5;66;03m// See if we can grow the number of inputs in "level" without[39;00m
[91mâ†’ 1395 [386 â†’ 383]:[0m [91m[38;5;250m  [39m[38;5;66;03m// changing the number of "level+1" files we pick up.[39;00m[0m
[91mâ†’ 1396 [183 â†’ 180]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m1[39m].empty())[38;5;250m [39m{[0m
  1397           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;250m [39mexpanded0;
  1398           : [38;5;250m    [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mGetOverlappingInputs(level,[38;5;250m [39m[38;5;241m&[39mall_start,[38;5;250m [39m[38;5;241m&[39mall_limit,[38;5;250m [39m[38;5;241m&[39mexpanded0);
  1399           : [38;5;250m    [39mAddBoundaryInputs(icmp_,[38;5;250m [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mfiles_[level],[38;5;250m [39m[38;5;241m&[39mexpanded0);
  1400           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint64_t[39m[38;5;250m [39minputs0_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mTotalFileSize(c[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m]);
  1401           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint64_t[39m[38;5;250m [39minputs1_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mTotalFileSize(c[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m1[39m]);
  1402           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint64_t[39m[38;5;250m [39mexpanded0_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mTotalFileSize(expanded0);
[91mâ†’ 1403 [183 â†’ 180]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(expanded0.size()[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m].size()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
  1404           : [38;5;250m        [39minputs1_size[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mexpanded0_size[38;5;250m [39m[38;5;241m<[39m
  1405           : [38;5;250m            [39mExpandedCompactionByteSizeLimit(options_))[38;5;250m [39m{
  1406           : [38;5;250m      [39mInternalKey[38;5;250m [39mnew_start,[38;5;250m [39mnew_limit;
  1407           : [38;5;250m      [39mGetRange(expanded0,[38;5;250m [39m[38;5;241m&[39mnew_start,[38;5;250m [39m[38;5;241m&[39mnew_limit);
  1408           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mFileMetaData[38;5;241m*[39m[38;5;241m>[39m[38;5;250m [39mexpanded1;

........................................

  1418           : [38;5;250m        [39mlargest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnew_limit;
  1419           : [38;5;250m        [39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mexpanded0;
  1420           : [38;5;250m        [39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m1[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mexpanded1;
  1421           : [38;5;250m        [39mGetRange2(c[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m0[39m],[38;5;250m [39mc[38;5;241m-[39m[38;5;241m>[39minputs_[[38;5;241m1[39m],[38;5;250m [39m[38;5;241m&[39mall_start,[38;5;250m [39m[38;5;241m&[39mall_limit);
  1422           : [38;5;250m      [39m}
[91mâ†’ 1423 [183 â†’ 180]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’ 1424 [386 â†’ 383]:[0m [91m[38;5;250m  [39m}[0m
  1425           : 
  1426           : [38;5;250m  [39m[38;5;66;03m// Compute the set of grandparent files that overlap this compaction[39;00m
[91mâ†’ 1427 [386 â†’ 383]:[0m [91m[38;5;250m  [39m[38;5;66;03m// (parent == level+1; grandparent == level+2)[39;00m[0m
[91mâ†’ 1428 [386 â†’ 383]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(level[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m2[39m[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels)[38;5;250m [39m{[0m
  1429           : [38;5;250m    [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mGetOverlappingInputs(level[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m2[39m,[38;5;250m [39m[38;5;241m&[39mall_start,[38;5;250m [39m[38;5;241m&[39mall_limit,
  1430           : [38;5;250m                                   [39m[38;5;241m&[39mc[38;5;241m-[39m[38;5;241m>[39mgrandparents_);
[91mâ†’ 1431 [386 â†’ 383]:[0m [91m[38;5;250m  [39m}[0m
  1432           : 
  1433           : [38;5;250m  [39m[38;5;66;03m// Update the place where we will do the next compaction for this level.[39;00m
  1434           : [38;5;250m  [39m[38;5;66;03m// We update this immediately instead of waiting for the VersionEdit[39;00m
  1435           : [38;5;250m  [39m[38;5;66;03m// to be applied so that if the compaction fails, we will try a different[39;00m
[91mâ†’ 1436 [386 â†’ 383]:[0m [91m[38;5;250m  [39m[38;5;66;03m// key range next time.[39;00m[0m
  1437           : [38;5;250m  [39mcompact_pointer_[level][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlargest.Encode().ToString();
  1438           : [38;5;250m  [39mc[38;5;241m-[39m[38;5;241m>[39medit_.SetCompactPointer(level,[38;5;250m [39mlargest);
  1439           : }
  1440           : 
  1441           : Compaction[38;5;241m*[39m[38;5;250m [39mVersionSet[38;5;241m:[39m[38;5;241m:[39mCompactRange([38;5;125mint[39m[38;5;250m [39mlevel,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKey[38;5;241m*[39m[38;5;250m [39mbegin,

........................................

  1475           : [38;5;250m    [39m[38;5;241m:[39m[38;5;250m [39mlevel_(level),
  1476           : [38;5;250m      [39mmax_output_file_size_(MaxFileSizeForLevel(options,[38;5;250m [39mlevel)),
  1477           : [38;5;250m      [39minput_version_([38;5;28;01mnullptr[39;00m),
  1478           : [38;5;250m      [39mgrandparent_index_([38;5;241m0[39m),
  1479           : [38;5;250m      [39mseen_key_([38;5;28mfalse[39m),
[91mâ†’ 1480 [386 â†’ 383]:[0m [91m[38;5;250m      [39moverlapped_bytes_([38;5;241m0[39m)[38;5;250m [39m{[0m
[91mâ†’ 1481 [2702 â†’ 2681]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mconfig[38;5;241m:[39m[38;5;241m:[39mkNumLevels;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
  1482           : [38;5;250m    [39mlevel_ptrs_[i][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’ 1483 [386 â†’ 383]:[0m [91m[38;5;250m  [39m}[0m
  1484           : }
  1485           : 
[91mâ†’ 1486 [386 â†’ 383]:[0m [91mCompaction[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mCompaction()[38;5;250m [39m{[0m
  1487           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(input_version_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
  1488           : [38;5;250m    [39minput_version_[38;5;241m-[39m[38;5;241m>[39mUnref();
[91mâ†’ 1489 [386 â†’ 383]:[0m [91m[38;5;250m  [39m}[0m
  1490           : }
  1491           : 
[91mâ†’ 1492 [112 â†’ 109]:[0m [91m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mCompaction::IsTrivialMove[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
  1493           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mVersionSet[38;5;241m*[39m[38;5;250m [39mvset[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minput_version_[38;5;241m-[39m[38;5;241m>[39mvset_;
  1494           : [38;5;250m  [39m[38;5;66;03m// Avoid a move if there is lots of overlapping grandparent data.[39;00m
  1495           : [38;5;250m  [39m[38;5;66;03m// Otherwise, the move could create a parent file that will require[39;00m
[91mâ†’ 1496 [112 â†’ 109]:[0m [91m[38;5;250m  [39m[38;5;66;03m// a very expensive merge later on.[39;00m[0m
[91mâ†’ 1497 [112 â†’ 109]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(num_input_files([38;5;241m0[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mnum_input_files([38;5;241m1[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
  1498           : [38;5;250m          [39mTotalFileSize(grandparents_)[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m
[91mâ†’ 1499 [112 â†’ 109]:[0m [91m[38;5;250m              [39mMaxGrandParentOverlapBytes(vset[38;5;241m-[39m[38;5;241m>[39moptions_));[0m
  1500           : }
  1501           : 
[91mâ†’ 1502 [322 â†’ 323]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mCompaction::AddInputDeletions[39m(VersionEdit[38;5;241m*[39m[38;5;250m [39medit)[38;5;250m [39m{[0m
[91mâ†’ 1503 [644 â†’ 646]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mwhich[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mwhich[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m2[39m;[38;5;250m [39mwhich[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
[91mâ†’ 1504 [556 â†’ 559]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39minputs_[which].size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
  1505           : [38;5;250m      [39medit[38;5;241m-[39m[38;5;241m>[39mDeleteFile(level_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mwhich,[38;5;250m [39minputs_[which][i][38;5;241m-[39m[38;5;241m>[39mnumber);
[91mâ†’ 1506 [644 â†’ 646]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’ 1507 [322 â†’ 323]:[0m [91m[38;5;250m  [39m}[0m
  1508           : }
  1509           : 
  1510           : [38;5;125mbool[39m[38;5;250m [39m[38;5;21mCompaction::IsBaseLevelForKey[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39muser_key)[38;5;250m [39m{
  1511           : [38;5;250m  [39m[38;5;66;03m// Maybe use binary search to find right entry instead of linear search?[39;00m
  1512           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39muser_cmp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minput_version_[38;5;241m-[39m[38;5;241m>[39mvset_[38;5;241m-[39m[38;5;241m>[39micmp_.user_comparator();

........................................

  1526           : [38;5;250m    [39m}
  1527           : [38;5;250m  [39m}
  1528           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
  1529           : }
  1530           : 
[91mâ†’ 1531 [737 â†’ 738]:[0m [91m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mCompaction::ShouldStopBefore[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39minternal_key)[38;5;250m [39m{[0m
  1532           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mVersionSet[38;5;241m*[39m[38;5;250m [39mvset[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minput_version_[38;5;241m-[39m[38;5;241m>[39mvset_;
[91mâ†’ 1533 [737 â†’ 738]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Scan to find earliest grandparent file that contains key.[39;00m[0m
  1534           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mInternalKeyComparator[38;5;241m*[39m[38;5;250m [39micmp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mvset[38;5;241m-[39m[38;5;241m>[39micmp_;
[91mâ†’ 1535 [778 â†’ 779]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(grandparent_index_[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mgrandparents_.size()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
  1536           : [38;5;250m         [39micmp[38;5;241m-[39m[38;5;241m>[39mCompare(internal_key,
  1537           : [38;5;250m                       [39mgrandparents_[grandparent_index_][38;5;241m-[39m[38;5;241m>[39mlargest.Encode())[38;5;250m [39m[38;5;241m>[39m
  1538           : [38;5;250m             [39m[38;5;241m0[39m)[38;5;250m [39m{
  1539           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(seen_key_)[38;5;250m [39m{
  1540           : [38;5;250m      [39moverlapped_bytes_[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mgrandparents_[grandparent_index_][38;5;241m-[39m[38;5;241m>[39mfile_size;
  1541           : [38;5;250m    [39m}
  1542           : [38;5;250m    [39mgrandparent_index_[38;5;241m+[39m[38;5;241m+[39m;
[91mâ†’ 1543 [737 â†’ 738]:[0m [91m[38;5;250m  [39m}[0m
  1544           : [38;5;250m  [39mseen_key_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’ 1545 [737 â†’ 738]:[0m [91m[0m
  1546           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(overlapped_bytes_[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mMaxGrandParentOverlapBytes(vset[38;5;241m-[39m[38;5;241m>[39moptions_))[38;5;250m [39m{
  1547           : [38;5;250m    [39m[38;5;66;03m// Too much overlap for current output; start new output[39;00m
  1548           : [38;5;250m    [39moverlapped_bytes_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
  1549           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’ 1550 [706 â†’ 707]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
  1551           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’ 1552 [737 â†’ 738]:[0m [91m[38;5;250m  [39m}[0m
  1553           : }
  1554           : 
[91mâ†’ 1555 [356 â†’ 353]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mCompaction::ReleaseInputs[39m()[38;5;250m [39m{[0m
[91mâ†’ 1556 [356 â†’ 353]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(input_version_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
  1557           : [38;5;250m    [39minput_version_[38;5;241m-[39m[38;5;241m>[39mUnref();
  1558           : [38;5;250m    [39minput_version_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’ 1559 [356 â†’ 353]:[0m [91m[38;5;250m  [39m}[0m
  1560           : }
  1561           : 
  1562           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/version_set.h ===
Lines with coverage differences:

Lines with different hit counts: 215, 216, 217, 252, 254

Detailed differences with context:
============================================================
   210           : 
   211           : [38;5;250m  [39m[38;5;66;03m// Return the last sequence number.[39;00m
   212           : [38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39m[38;5;21mLastSequence[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mlast_sequence_;[38;5;250m [39m}
   213           : 
   214           : [38;5;250m  [39m[38;5;66;03m// Set the last sequence number to s.[39;00m
[91mâ†’  215 [3225 â†’ 3229]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSetLastSequence[39m([38;5;125muint64_t[39m[38;5;250m [39ms)[38;5;250m [39m{[0m
[91mâ†’  216 [3225 â†’ 3229]:[0m [91m[38;5;250m    [39massert(s[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mlast_sequence_);[0m
[91mâ†’  217 [3225 â†’ 3229]:[0m [91m[38;5;250m    [39mlast_sequence_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39ms;[0m
   218           : [38;5;250m  [39m}
   219           : 
   220           : [38;5;250m  [39m[38;5;66;03m// Mark the specified file number as used.[39;00m
   221           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mMarkFileNumberUsed[39m([38;5;125muint64_t[39m[38;5;250m [39mnumber);
   222           : 

........................................

   247           : [38;5;250m  [39m[38;5;66;03m// Create an iterator that reads over the compaction inputs for "*c".[39;00m
   248           : [38;5;250m  [39m[38;5;66;03m// The caller should delete the iterator when no longer needed.[39;00m
   249           : [38;5;250m  [39mIterator[38;5;241m*[39m[38;5;250m [39m[38;5;21mMakeInputIterator[39m(Compaction[38;5;241m*[39m[38;5;250m [39mc);
   250           : 
   251           : [38;5;250m  [39m[38;5;66;03m// Returns true iff some level needs a compaction.[39;00m
[91mâ†’  252 [4030 â†’ 4039]:[0m [91m[38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mNeedsCompaction[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
   253           : [38;5;250m    [39mVersion[38;5;241m*[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcurrent_;
[91mâ†’  254 [4030 â†’ 4039]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(v[38;5;241m-[39m[38;5;241m>[39mcompaction_score_[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m)[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39m(v[38;5;241m-[39m[38;5;241m>[39mfile_to_compact_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mnullptr);[0m
   255           : [38;5;250m  [39m}
   256           : 
   257           : [38;5;250m  [39m[38;5;66;03m// Add all files listed in any live version to *live.[39;00m
   258           : [38;5;250m  [39m[38;5;66;03m// May also mutate some internal state.[39;00m
   259           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mAddLiveFiles[39m(std[38;5;241m:[39m[38;5;241m:[39mset[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m[38;5;241m*[39m[38;5;250m [39mlive);

=== File: /root/leveldb-fuzzing/leveldb-subtree/db/write_batch.cc ===
Lines with coverage differences:

Lines with different hit counts: 35, 42, 46, 47, 48, 51, 56, 57, 58, 62, 63, 72, 74, 77, 79, 82, 90, 121, 132, 139, 140, 141

Detailed differences with context:
============================================================
    30           : 
    31           : WriteBatch[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mWriteBatch()[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mdefault[39;00m;
    32           : 
    33           : WriteBatch[38;5;241m:[39m[38;5;241m:[39mHandler[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mHandler()[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mdefault[39;00m;
    34           : 
[91mâ†’   35 [5450 â†’ 5452]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mWriteBatch::Clear[39m()[38;5;250m [39m{[0m
    36           : [38;5;250m  [39mrep_.clear();
    37           : [38;5;250m  [39mrep_.resize(kHeader);
    38           : }
    39           : 
    40           : [38;5;125msize_t[39m[38;5;250m [39m[38;5;21mWriteBatch::ApproximateSize[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mrep_.size();[38;5;250m [39m}
    41           : 
[91mâ†’   42 [3759 â†’ 3761]:[0m [91mStatus[38;5;250m [39m[38;5;21mWriteBatch::Iterate[39m(Handler[38;5;241m*[39m[38;5;250m [39mhandler)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
    43           : [38;5;250m  [39mSlice[38;5;250m [39m[38;5;21minput[39m(rep_);
    44           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(input.size()[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mkHeader)[38;5;250m [39m{
    45           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mmalformed WriteBatch (too small)[39m[38;5;124m"[39m);
[91mâ†’   46 [3759 â†’ 3761]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   47 [3759 â†’ 3761]:[0m [91m[0m
[91mâ†’   48 [3759 â†’ 3761]:[0m [91m[38;5;250m  [39minput.remove_prefix(kHeader);[0m
    49           : [38;5;250m  [39mSlice[38;5;250m [39mkey,[38;5;250m [39mvalue;
    50           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mfound[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’   51 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;241m![39minput.empty())[38;5;250m [39m{[0m
    52           : [38;5;250m    [39mfound[38;5;241m+[39m[38;5;241m+[39m;
    53           : [38;5;250m    [39m[38;5;125mchar[39m[38;5;250m [39mtag[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minput[[38;5;241m0[39m];
    54           : [38;5;250m    [39minput.remove_prefix([38;5;241m1[39m);
    55           : [38;5;250m    [39m[38;5;28;01mswitch[39;00m[38;5;250m [39m(tag)[38;5;250m [39m{
[91mâ†’   56 [1614 â†’ 1616]:[0m [91m[38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkTypeValue[39m:[0m
[91mâ†’   57 [1614 â†’ 1616]:[0m [91m[38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetLengthPrefixedSlice([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mkey)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’   58 [1614 â†’ 1616]:[0m [91m[38;5;250m            [39mGetLengthPrefixedSlice([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mvalue))[38;5;250m [39m{[0m
    59           : [38;5;250m          [39mhandler[38;5;241m-[39m[38;5;241m>[39mPut(key,[38;5;250m [39mvalue);
    60           : [38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
    61           : [38;5;250m          [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mbad WriteBatch Put[39m[38;5;124m"[39m);
[91mâ†’   62 [1614 â†’ 1616]:[0m [91m[38;5;250m        [39m}[0m
[91mâ†’   63 [1614 â†’ 1616]:[0m [91m[38;5;250m        [39m[38;5;28;01mbreak[39;00m;[0m
    64           : [38;5;250m      [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkTypeDeletion[39m:
    65           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetLengthPrefixedSlice([38;5;241m&[39minput,[38;5;250m [39m[38;5;241m&[39mkey))[38;5;250m [39m{
    66           : [38;5;250m          [39mhandler[38;5;241m-[39m[38;5;241m>[39mDelete(key);
    67           : [38;5;250m        [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
    68           : [38;5;250m          [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mbad WriteBatch Delete[39m[38;5;124m"[39m);
    69           : [38;5;250m        [39m}
    70           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
    71           : [38;5;250m      [39m[38;5;28;01mdefault[39;00m[38;5;241m:[39m
[91mâ†’   72 [3779 â†’ 3781]:[0m [91m[38;5;250m        [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124munknown WriteBatch tag[39m[38;5;124m"[39m);[0m
    73           : [38;5;250m    [39m}
[91mâ†’   74 [3759 â†’ 3761]:[0m [91m[38;5;250m  [39m}[0m
    75           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(found[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mWriteBatchInternal[38;5;241m:[39m[38;5;241m:[39mCount([38;5;28;01mthis[39;00m))[38;5;250m [39m{
    76           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mWriteBatch has wrong count[39m[38;5;124m"[39m);
[91mâ†’   77 [3759 â†’ 3761]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
    78           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
[91mâ†’   79 [3759 â†’ 3761]:[0m [91m[38;5;250m  [39m}[0m
    80           : }
    81           : 
[91mâ†’   82 [10365 â†’ 10369]:[0m [91m[38;5;125mint[39m[38;5;250m [39m[38;5;21mWriteBatchInternal::Count[39m([38;5;28;01mconst[39;00m[38;5;250m [39mWriteBatch[38;5;241m*[39m[38;5;250m [39mb)[38;5;250m [39m{[0m
    83           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mDecodeFixed32(b[38;5;241m-[39m[38;5;241m>[39mrep_.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m8[39m);
    84           : }
    85           : 
    86           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mWriteBatchInternal::SetCount[39m(WriteBatch[38;5;241m*[39m[38;5;250m [39mb,[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mn)[38;5;250m [39m{
    87           : [38;5;250m  [39mEncodeFixed32([38;5;241m&[39mb[38;5;241m-[39m[38;5;241m>[39mrep_[[38;5;241m8[39m],[38;5;250m [39mn);
    88           : }
    89           : 
[91mâ†’   90 [4752 â†’ 4756]:[0m [91mSequenceNumber[38;5;250m [39m[38;5;21mWriteBatchInternal::Sequence[39m([38;5;28;01mconst[39;00m[38;5;250m [39mWriteBatch[38;5;241m*[39m[38;5;250m [39mb)[38;5;250m [39m{[0m
    91           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mSequenceNumber(DecodeFixed64(b[38;5;241m-[39m[38;5;241m>[39mrep_.data()));
    92           : }
    93           : 
    94           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mWriteBatchInternal::SetSequence[39m(WriteBatch[38;5;241m*[39m[38;5;250m [39mb,[38;5;250m [39mSequenceNumber[38;5;250m [39mseq)[38;5;250m [39m{
    95           : [38;5;250m  [39mEncodeFixed64([38;5;241m&[39mb[38;5;241m-[39m[38;5;241m>[39mrep_[[38;5;241m0[39m],[38;5;250m [39mseq);

........................................

   116           : [38;5;28;01mclass[39;00m[38;5;250m [39m[38;5;21;01mMemTableInserter[39;00m[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;250m [39mWriteBatch[38;5;241m:[39m[38;5;241m:[39mHandler[38;5;250m [39m{
   117           : [38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;241m:[39m
   118           : [38;5;250m  [39mSequenceNumber[38;5;250m [39msequence_;
   119           : [38;5;250m  [39mMemTable[38;5;241m*[39m[38;5;250m [39mmem_;
   120           : 
[91mâ†’  121 [1614 â†’ 1616]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPut[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mvalue)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   122           : [38;5;250m    [39mmem_[38;5;241m-[39m[38;5;241m>[39mAdd(sequence_,[38;5;250m [39mkTypeValue,[38;5;250m [39mkey,[38;5;250m [39mvalue);
   123           : [38;5;250m    [39msequence_[38;5;241m+[39m[38;5;241m+[39m;
   124           : [38;5;250m  [39m}
   125           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDelete[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   126           : [38;5;250m    [39mmem_[38;5;241m-[39m[38;5;241m>[39mAdd(sequence_,[38;5;250m [39mkTypeDeletion,[38;5;250m [39mkey,[38;5;250m [39mSlice());

........................................

   127           : [38;5;250m    [39msequence_[38;5;241m+[39m[38;5;241m+[39m;
   128           : [38;5;250m  [39m}
   129           : };
   130           : }[38;5;250m  [39m[38;5;66;03m// namespace[39;00m
   131           : 
[91mâ†’  132 [3759 â†’ 3761]:[0m [91mStatus[38;5;250m [39m[38;5;21mWriteBatchInternal::InsertInto[39m([38;5;28;01mconst[39;00m[38;5;250m [39mWriteBatch[38;5;241m*[39m[38;5;250m [39mb,[38;5;250m [39mMemTable[38;5;241m*[39m[38;5;250m [39mmemtable)[38;5;250m [39m{[0m
   133           : [38;5;250m  [39mMemTableInserter[38;5;250m [39minserter;
   134           : [38;5;250m  [39minserter.sequence_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mWriteBatchInternal[38;5;241m:[39m[38;5;241m:[39mSequence(b);
   135           : [38;5;250m  [39minserter.mem_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmemtable;
   136           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mb[38;5;241m-[39m[38;5;241m>[39mIterate([38;5;241m&[39minserter);
   137           : }
   138           : 
[91mâ†’  139 [993 â†’ 995]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mWriteBatchInternal::SetContents[39m(WriteBatch[38;5;241m*[39m[38;5;250m [39mb,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mcontents)[38;5;250m [39m{[0m
[91mâ†’  140 [993 â†’ 995]:[0m [91m[38;5;250m  [39massert(contents.size()[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mkHeader);[0m
[91mâ†’  141 [993 â†’ 995]:[0m [91m[38;5;250m  [39mb[38;5;241m-[39m[38;5;241m>[39mrep_.assign(contents.data(),[38;5;250m [39mcontents.size());[0m
   142           : }
   143           : 
   144           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mWriteBatchInternal::Append[39m(WriteBatch[38;5;241m*[39m[38;5;250m [39mdst,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mWriteBatch[38;5;241m*[39m[38;5;250m [39msrc)[38;5;250m [39m{
   145           : [38;5;250m  [39mSetCount(dst,[38;5;250m [39mCount(dst)[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mCount(src));
   146           : [38;5;250m  [39massert(src[38;5;241m-[39m[38;5;241m>[39mrep_.size()[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mkHeader);

=== File: /root/leveldb-fuzzing/leveldb-subtree/include/leveldb/iterator.h ===
Lines with coverage differences:

Lines with different hit counts: 90, 91, 92

Detailed differences with context:
============================================================
    85           : [38;5;250m  [39m[38;5;66;03m// The list's head node is inlined in the iterator.[39;00m
    86           : [38;5;250m  [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;21;01mCleanupNode[39;00m[38;5;250m [39m{
    87           : [38;5;250m    [39m[38;5;66;03m// True if the node is not used. Only head nodes might be unused.[39;00m
    88           : [38;5;250m    [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mIsEmpty[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mfunction[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mnullptr;[38;5;250m [39m}
    89           : [38;5;250m    [39m[38;5;66;03m// Invokes the cleanup function.[39;00m
[91mâ†’   90 [8619 â†’ 8604]:[0m [91m[38;5;250m    [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mRun[39m()[38;5;250m [39m{[0m
[91mâ†’   91 [8619 â†’ 8604]:[0m [91m[38;5;250m      [39massert(function[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mnullptr);[0m
[91mâ†’   92 [8619 â†’ 8604]:[0m [91m[38;5;250m      [39m([38;5;241m*[39mfunction)(arg1,[38;5;250m [39marg2);[0m
    93           : [38;5;250m    [39m}
    94           : 
    95           : [38;5;250m    [39m[38;5;66;03m// The head node is used if the function pointer is not null.[39;00m
    96           : [38;5;250m    [39mCleanupFunction[38;5;250m [39mfunction;
    97           : [38;5;250m    [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg1;

=== File: /root/leveldb-fuzzing/leveldb-subtree/include/leveldb/slice.h ===
Lines with coverage differences:

Lines with different hit counts: 60, 61, 62, 66, 72, 73, 74, 88, 89, 97, 98, 99, 104, 105, 107, 108, 109, 110, 111, 112

Detailed differences with context:
============================================================
    55           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mbegin[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mdata();[38;5;250m [39m}
    56           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mend[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mdata()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39msize();[38;5;250m [39m}
    57           : 
    58           : [38;5;250m  [39m[38;5;66;03m// Return the ith byte in the referenced data.[39;00m
    59           : [38;5;250m  [39m[38;5;66;03m// REQUIRES: n < size()[39;00m
[91mâ†’   60 [10128 â†’ 10083]:[0m [91m[38;5;250m  [39m[38;5;125mchar[39m[38;5;250m [39moperator[]([38;5;125msize_t[39m[38;5;250m [39mn)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’   61 [10128 â†’ 10083]:[0m [91m[38;5;250m    [39massert(n[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39msize());[0m
[91mâ†’   62 [10128 â†’ 10083]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mdata_[n];[0m
    63           : [38;5;250m  [39m}
    64           : 
    65           : [38;5;250m  [39m[38;5;66;03m// Change this slice to refer to an empty array[39;00m
[91mâ†’   66 [91374 â†’ 92522]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mclear[39m()[38;5;250m [39m{[0m
    67           : [38;5;250m    [39mdata_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124m"[39m;
    68           : [38;5;250m    [39msize_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
    69           : [38;5;250m  [39m}
    70           : 
    71           : [38;5;250m  [39m[38;5;66;03m// Drop the first "n" bytes from this slice.[39;00m
[91mâ†’   72 [135882 â†’ 137016]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mremove_prefix[39m([38;5;125msize_t[39m[38;5;250m [39mn)[38;5;250m [39m{[0m
[91mâ†’   73 [135882 â†’ 137016]:[0m [91m[38;5;250m    [39massert(n[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39msize());[0m
[91mâ†’   74 [135882 â†’ 137016]:[0m [91m[38;5;250m    [39mdata_[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mn;[0m
    75           : [38;5;250m    [39msize_[38;5;250m [39m[38;5;241m-[39m[38;5;241m=[39m[38;5;250m [39mn;
    76           : [38;5;250m  [39m}
    77           : 
    78           : [38;5;250m  [39m[38;5;66;03m// Return a string that contains the copy of the referenced data.[39;00m
    79           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mToString[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring(data_,[38;5;250m [39msize_);[38;5;250m [39m}

........................................

    83           : [38;5;250m  [39m[38;5;66;03m//   == 0 iff "*this" == "b",[39;00m
    84           : [38;5;250m  [39m[38;5;66;03m//   >  0 iff "*this" >  "b"[39;00m
    85           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39m[38;5;21mcompare[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mb)[38;5;250m [39m[38;5;28;01mconst[39;00m;
    86           : 
    87           : [38;5;250m  [39m[38;5;66;03m// Return true iff "x" is a prefix of "*this"[39;00m
[91mâ†’   88 [40383 â†’ 40371]:[0m [91m[38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mstarts_with[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mx)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’   89 [40383 â†’ 40371]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m((size_[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mx.size_)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m(memcmp(data_,[38;5;250m [39mx.data_,[38;5;250m [39mx.size_)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m));[0m
    90           : [38;5;250m  [39m}
    91           : 
    92           : [38;5;250m [39mprivate[38;5;241m:[39m
    93           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mdata_;
    94           : [38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39msize_;
    95           : };
    96           : 
[91mâ†’   97 [172969 â†’ 172876]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39moperator[38;5;241m=[39m[38;5;241m=[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mx,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39my)[38;5;250m [39m{[0m
[91mâ†’   98 [172969 â†’ 172876]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m((x.size()[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39my.size())[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’   99 [172969 â†’ 172876]:[0m [91m[38;5;250m          [39m(memcmp(x.data(),[38;5;250m [39my.data(),[38;5;250m [39mx.size())[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m));[0m
   100           : }
   101           : 
   102           : [38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39moperator[38;5;241m![39m[38;5;241m=[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mx,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39my)[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;241m![39m(x[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39my);[38;5;250m [39m}
   103           : 
[91mâ†’  104 [51633 â†’ 51459]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39m[38;5;21mSlice::compare[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mb)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’  105 [51633 â†’ 51459]:[0m [91m[38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mmin_len[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(size_[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mb.size_)[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39msize_[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mb.size_;[0m
   106           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmemcmp(data_,[38;5;250m [39mb.data_,[38;5;250m [39mmin_len);
[91mâ†’  107 [44705 â†’ 44536]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
[91mâ†’  108 [5596 â†’ 5595]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(size_[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mb.size_)[0m
[91mâ†’  109 [39109 â†’ 38941]:[0m [91m[38;5;250m      [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m-1[39m;[0m
[91mâ†’  110 [6324 â†’ 6308]:[0m [91m[38;5;250m    [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(size_[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mb.size_)[0m
[91mâ†’  111 [44705 â†’ 44536]:[0m [91m[38;5;250m      [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m+[39m[38;5;241m1[39m;[0m
[91mâ†’  112 [51633 â†’ 51459]:[0m [91m[38;5;250m  [39m}[0m
   113           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mr;
   114           : }
   115           : 
   116           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m
   117           : 

=== File: /root/leveldb-fuzzing/leveldb-subtree/include/leveldb/status.h ===
Lines with coverage differences:

Lines with different hit counts: 52, 103, 104, 108, 110, 111, 113, 119

Detailed differences with context:
============================================================
    47           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus(kNotSupported,[38;5;250m [39mmsg,[38;5;250m [39mmsg2);
    48           : [38;5;250m  [39m}
    49           : [38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39mStatus[38;5;250m [39m[38;5;21mInvalidArgument[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mmsg,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mmsg2[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice())[38;5;250m [39m{
    50           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus(kInvalidArgument,[38;5;250m [39mmsg,[38;5;250m [39mmsg2);
    51           : [38;5;250m  [39m}
[91mâ†’   52 [2695 â†’ 2691]:[0m [91m[38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39mStatus[38;5;250m [39m[38;5;21mIOError[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mmsg,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mmsg2[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice())[38;5;250m [39m{[0m
    53           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus(kIOError,[38;5;250m [39mmsg,[38;5;250m [39mmsg2);
    54           : [38;5;250m  [39m}
    55           : 
    56           : [38;5;250m  [39m[38;5;66;03m// Returns true iff the status indicates success.[39;00m
    57           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mok[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(state_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mnullptr);[38;5;250m [39m}

........................................

    98           : [38;5;250m  [39m[38;5;66;03m//    state_[4]    == code[39;00m
    99           : [38;5;250m  [39m[38;5;66;03m//    state_[5..]  == message[39;00m
   100           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mstate_;
   101           : };
   102           : 
[91mâ†’  103 [30972 â†’ 30907]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mStatus([38;5;28;01mconst[39;00m[38;5;250m [39mStatus[38;5;241m&[39m[38;5;250m [39mrhs)[38;5;250m [39m{[0m
[91mâ†’  104 [30972 â†’ 30907]:[0m [91m[38;5;250m  [39mstate_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(rhs.state_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mnullptr)[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39mnullptr[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mCopyState(rhs.state_);[0m
   105           : }
   106           : 
   107           : [38;5;66;03m// NOLINTBEGIN(bugprone-unhandled-self-assignment)[39;00m
[91mâ†’  108 [136 â†’ 132]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39mStatus[38;5;241m&[39m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39moperator[38;5;241m=[39m([38;5;28;01mconst[39;00m[38;5;250m [39mStatus[38;5;241m&[39m[38;5;250m [39mrhs)[38;5;250m [39m{[0m
   109           : [38;5;250m  [39m[38;5;66;03m// The following condition catches both aliasing (when this == &rhs),[39;00m
[91mâ†’  110 [136 â†’ 132]:[0m [91m[38;5;250m  [39m[38;5;66;03m// and the common case where both rhs and *this are ok.[39;00m[0m
[91mâ†’  111 [136 â†’ 132]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(state_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mrhs.state_)[38;5;250m [39m{[0m
   112           : [38;5;250m    [39mdelete[][38;5;250m [39mstate_;
[91mâ†’  113 [136 â†’ 132]:[0m [91m[38;5;250m    [39mstate_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(rhs.state_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mnullptr)[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39mnullptr[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mCopyState(rhs.state_);[0m
   114           : [38;5;250m  [39m}
   115           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;241m*[39mthis;
   116           : }
   117           : [38;5;66;03m// NOLINTEND(bugprone-unhandled-self-assignment)[39;00m
   118           : 
[91mâ†’  119 [860804 â†’ 860705]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39mStatus[38;5;241m&[39m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39moperator[38;5;241m=[39m(Status[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mrhs)[38;5;250m [39mnoexcept[38;5;250m [39m{[0m
   120           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mswap(state_,[38;5;250m [39mrhs.state_);
   121           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;241m*[39mthis;
   122           : }
   123           : 
   124           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/port/port_stdcxx.h ===
Lines with coverage differences:

Lines with different hit counts: 73

Detailed differences with context:
============================================================
    68           : [38;5;250m  [39m[38;5;241m~[39mCondVar()[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mdefault[39;00m;
    69           : 
    70           : [38;5;250m  [39mCondVar([38;5;28;01mconst[39;00m[38;5;250m [39mCondVar[38;5;241m&[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdelete;
    71           : [38;5;250m  [39mCondVar[38;5;241m&[39m[38;5;250m [39moperator[38;5;241m=[39m([38;5;28;01mconst[39;00m[38;5;250m [39mCondVar[38;5;241m&[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdelete;
    72           : 
[91mâ†’   73 [4718 â†’ 4721]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mWait[39m()[38;5;250m [39m{[0m
    74           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39munique_lock[38;5;241m<[39mstd[38;5;241m:[39m[38;5;241m:[39mmutex[38;5;241m>[39m[38;5;250m [39mlock(mu_[38;5;241m-[39m[38;5;241m>[39mmu_,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39madopt_lock);
    75           : [38;5;250m    [39mcv_.wait(lock);
    76           : [38;5;250m    [39mlock.release();
    77           : [38;5;250m  [39m}
    78           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSignal[39m()[38;5;250m [39m{[38;5;250m [39mcv_.notify_one();[38;5;250m [39m}

=== File: /root/leveldb-fuzzing/leveldb-subtree/table/block.cc ===
Lines with coverage differences:

Lines with different hit counts: 20, 21, 22, 28, 31, 36, 38, 42, 45, 57, 58, 59, 62, 63, 65, 66, 67, 68, 69, 70, 73, 74, 91, 96, 100, 101, 102, 105, 110, 123, 129, 130, 131, 133, 134, 135, 164, 166, 190, 192, 193, 194, 197, 198, 200, 201, 204, 225, 234, 236, 237, 242, 246, 249, 255, 258, 259, 262, 264

Detailed differences with context:
============================================================
    15           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/coding.h"[39;00m
    16           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/logging.h"[39;00m
    17           : 
    18           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
    19           : 
[91mâ†’   20 [22889 â†’ 22836]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mBlock::NumRestarts[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’   21 [22889 â†’ 22836]:[0m [91m[38;5;250m  [39massert(size_[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m([38;5;125muint32_t[39m));[0m
[91mâ†’   22 [22889 â†’ 22836]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mDecodeFixed32(data_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39msize_[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m([38;5;125muint32_t[39m));[0m
    23           : }
    24           : 
    25           : Block[38;5;241m:[39m[38;5;241m:[39mBlock([38;5;28;01mconst[39;00m[38;5;250m [39mBlockContents[38;5;241m&[39m[38;5;250m [39mcontents)
    26           : [38;5;250m    [39m[38;5;241m:[39m[38;5;250m [39mdata_(contents.data.data()),
    27           : [38;5;250m      [39msize_(contents.data.size()),
[91mâ†’   28 [6869 â†’ 6852]:[0m [91m[38;5;250m      [39mowned_(contents.heap_allocated)[38;5;250m [39m{[0m
    29           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(size_[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m([38;5;125muint32_t[39m))[38;5;250m [39m{
    30           : [38;5;250m    [39msize_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m  [39m[38;5;66;03m// Error marker[39;00m
[91mâ†’   31 [6869 â†’ 6852]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
    32           : [38;5;250m    [39m[38;5;125msize_t[39m[38;5;250m [39mmax_restarts_allowed[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(size_[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m([38;5;125muint32_t[39m))[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m([38;5;125muint32_t[39m);
    33           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(NumRestarts()[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mmax_restarts_allowed)[38;5;250m [39m{
    34           : [38;5;250m      [39m[38;5;66;03m// The size is too small for NumRestarts()[39;00m
    35           : [38;5;250m      [39msize_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’   36 [6869 â†’ 6852]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
    37           : [38;5;250m      [39mrestart_offset_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39msize_[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m([38;5;241m1[39m[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mNumRestarts())[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m([38;5;125muint32_t[39m);
[91mâ†’   38 [6869 â†’ 6852]:[0m [91m[38;5;250m    [39m}[0m
    39           : [38;5;250m  [39m}
    40           : }
    41           : 
[91mâ†’   42 [6869 â†’ 6852]:[0m [91mBlock[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mBlock()[38;5;250m [39m{[0m
    43           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(owned_)[38;5;250m [39m{
    44           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mdata_;
[91mâ†’   45 [6869 â†’ 6852]:[0m [91m[38;5;250m  [39m}[0m
    46           : }
    47           : 
    48           : [38;5;66;03m// Helper routine: decode the next block entry starting at "p",[39;00m
    49           : [38;5;66;03m// storing the number of shared key bytes, non_shared key bytes,[39;00m
    50           : [38;5;66;03m// and the length of the value in "*shared", "*non_shared", and[39;00m

........................................

    52           : [38;5;66;03m//[39;00m
    53           : [38;5;66;03m// If any errors are detected, returns nullptr.  Otherwise, returns a[39;00m
    54           : [38;5;66;03m// pointer to the key delta (just past the three decoded values).[39;00m
    55           : [38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mDecodeEntry([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mp,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mlimit,
    56           : [38;5;250m                                      [39m[38;5;125muint32_t[39m[38;5;241m*[39m[38;5;250m [39mshared,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;241m*[39m[38;5;250m [39mnon_shared,
[91mâ†’   57 [8126 â†’ 8107]:[0m [91m[38;5;250m                                      [39m[38;5;125muint32_t[39m[38;5;241m*[39m[38;5;250m [39mvalue_length)[38;5;250m [39m{[0m
[91mâ†’   58 [8126 â†’ 8107]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(limit[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mp[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m3[39m)[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;[0m
[91mâ†’   59 [8126 â†’ 8107]:[0m [91m[38;5;250m  [39m[38;5;241m*[39mshared[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(p)[[38;5;241m0[39m];[0m
    60           : [38;5;250m  [39m[38;5;241m*[39mnon_shared[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(p)[[38;5;241m1[39m];
    61           : [38;5;250m  [39m[38;5;241m*[39mvalue_length[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(p)[[38;5;241m2[39m];
[91mâ†’   62 [6969 â†’ 6957]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(([38;5;241m*[39mshared[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39m[38;5;241m*[39mnon_shared[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39m[38;5;241m*[39mvalue_length)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m128[39m)[38;5;250m [39m{[0m
[91mâ†’   63 [6969 â†’ 6957]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Fast path: all three values are encoded in one byte each[39;00m[0m
    64           : [38;5;250m    [39mp[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m3[39m;
[91mâ†’   65 [1157 â†’ 1150]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
[91mâ†’   66 [1157 â†’ 1150]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m((p[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetVarint32Ptr(p,[38;5;250m [39mlimit,[38;5;250m [39mshared))[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;[0m
[91mâ†’   67 [1157 â†’ 1150]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m((p[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetVarint32Ptr(p,[38;5;250m [39mlimit,[38;5;250m [39mnon_shared))[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;[0m
[91mâ†’   68 [1157 â†’ 1150]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m((p[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetVarint32Ptr(p,[38;5;250m [39mlimit,[38;5;250m [39mvalue_length))[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;[0m
[91mâ†’   69 [8126 â†’ 8107]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   70 [8126 â†’ 8107]:[0m [91m[0m
    71           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m(limit[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mp)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m([38;5;241m*[39mnon_shared[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m*[39mvalue_length))[38;5;250m [39m{
    72           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’   73 [8126 â†’ 8107]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   74 [8126 â†’ 8107]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mp;[0m
    75           : }
    76           : 
    77           : [38;5;28;01mclass[39;00m[38;5;250m [39m[38;5;21;01mBlock[39;00m[38;5;241m:[39m[38;5;241m:[39mIter[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;250m [39mIterator[38;5;250m [39m{
    78           : [38;5;250m [39m[38;5;28;01mprivate[39;00m[38;5;241m:[39m
    79           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mcomparator_;

........................................

    86           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mrestart_index_;[38;5;250m  [39m[38;5;66;03m// Index of restart block in which current_ falls[39;00m
    87           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mkey_;
    88           : [38;5;250m  [39mSlice[38;5;250m [39mvalue_;
    89           : [38;5;250m  [39mStatus[38;5;250m [39mstatus_;
    90           : 
[91mâ†’   91 [3397 â†’ 3392]:[0m [91m[38;5;250m  [39m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39m[38;5;21mCompare[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39ma,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mb)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
    92           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mcomparator_[38;5;241m-[39m[38;5;241m>[39mCompare(a,[38;5;250m [39mb);
    93           : [38;5;250m  [39m}
    94           : 
    95           : [38;5;250m  [39m[38;5;66;03m// Return the offset in data_ just past the end of the current entry.[39;00m
[91mâ†’   96 [11990 â†’ 11971]:[0m [91m[38;5;250m  [39m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mNextEntryOffset[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
    97           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(value_.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mvalue_.size())[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mdata_;
    98           : [38;5;250m  [39m}
    99           : 
[91mâ†’  100 [7607 â†’ 7588]:[0m [91m[38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mGetRestartPoint[39m([38;5;125muint32_t[39m[38;5;250m [39mindex)[38;5;250m [39m{[0m
[91mâ†’  101 [7607 â†’ 7588]:[0m [91m[38;5;250m    [39massert(index[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mnum_restarts_);[0m
[91mâ†’  102 [7607 â†’ 7588]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mDecodeFixed32(data_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mrestarts_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mindex[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m([38;5;125muint32_t[39m));[0m
   103           : [38;5;250m  [39m}
   104           : 
[91mâ†’  105 [7264 â†’ 7245]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToRestartPoint[39m([38;5;125muint32_t[39m[38;5;250m [39mindex)[38;5;250m [39m{[0m
   106           : [38;5;250m    [39mkey_.clear();
   107           : [38;5;250m    [39mrestart_index_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mindex;
   108           : [38;5;250m    [39m[38;5;66;03m// current_ will be fixed by ParseNextKey();[39;00m
   109           : 
[91mâ†’  110 [7264 â†’ 7245]:[0m [91m[38;5;250m    [39m[38;5;66;03m// ParseNextKey() starts at the end of value_, so set value_ accordingly[39;00m[0m
   111           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39moffset[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetRestartPoint(index);
   112           : [38;5;250m    [39mvalue_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(data_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39moffset,[38;5;250m [39m[38;5;241m0[39m);
   113           : [38;5;250m  [39m}
   114           : 
   115           : [38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;241m:[39m

........................................

   118           : [38;5;250m      [39m[38;5;241m:[39m[38;5;250m [39mcomparator_(comparator),
   119           : [38;5;250m        [39mdata_(data),
   120           : [38;5;250m        [39mrestarts_(restarts),
   121           : [38;5;250m        [39mnum_restarts_(num_restarts),
   122           : [38;5;250m        [39mcurrent_(restarts_),
[91mâ†’  123 [9152 â†’ 9132]:[0m [91m[38;5;250m        [39mrestart_index_(num_restarts_)[38;5;250m [39m{[0m
   124           : [38;5;250m    [39massert(num_restarts_[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);
   125           : [38;5;250m  [39m}
   126           : 
   127           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mValid[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mcurrent_[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mrestarts_;[38;5;250m [39m}
   128           : [38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mstatus[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus_;[38;5;250m [39m}
[91mâ†’  129 [7377 â†’ 7358]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mkey[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’  130 [7377 â†’ 7358]:[0m [91m[38;5;250m    [39massert(Valid());[0m
[91mâ†’  131 [7377 â†’ 7358]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mkey_;[0m
   132           : [38;5;250m  [39m}
[91mâ†’  133 [8371 â†’ 8357]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mvalue[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’  134 [8371 â†’ 8357]:[0m [91m[38;5;250m    [39massert(Valid());[0m
[91mâ†’  135 [8371 â†’ 8357]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mvalue_;[0m
   136           : [38;5;250m  [39m}
   137           : 
   138           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mNext[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   139           : [38;5;250m    [39massert(Valid());
   140           : [38;5;250m    [39mParseNextKey();

........................................

   159           : [38;5;250m    [39m[38;5;28;01mdo[39;00m[38;5;250m [39m{
   160           : [38;5;250m      [39m[38;5;66;03m// Loop until end of current entry hits the start of original entry[39;00m
   161           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(ParseNextKey()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mNextEntryOffset()[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39moriginal);
   162           : [38;5;250m  [39m}
   163           : 
[91mâ†’  164 [3193 â†’ 3188]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeek[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mtarget)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   165           : [38;5;250m    [39m[38;5;66;03m// Binary search in restart array to find the last restart point[39;00m
[91mâ†’  166 [3193 â†’ 3188]:[0m [91m[38;5;250m    [39m[38;5;66;03m// with a key < target[39;00m[0m
   167           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mleft[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
   168           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mright[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnum_restarts_[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m;
   169           : [38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(left[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mright)[38;5;250m [39m{
   170           : [38;5;250m      [39m[38;5;125muint32_t[39m[38;5;250m [39mmid[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(left[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mright[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m)[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39m[38;5;241m2[39m;
   171           : [38;5;250m      [39m[38;5;125muint32_t[39m[38;5;250m [39mregion_offset[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetRestartPoint(mid);

........................................

   185           : [38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   186           : [38;5;250m        [39m[38;5;66;03m// Key at "mid" is >= "target".  Therefore all blocks at or[39;00m
   187           : [38;5;250m        [39m[38;5;66;03m// after "mid" are uninteresting.[39;00m
   188           : [38;5;250m        [39mright[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmid[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m;
   189           : [38;5;250m      [39m}
[91mâ†’  190 [3193 â†’ 3188]:[0m [91m[38;5;250m    [39m}[0m
   191           : 
[91mâ†’  192 [3193 â†’ 3188]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Linear search (within restart block) for first key >= target[39;00m[0m
[91mâ†’  193 [3193 â†’ 3188]:[0m [91m[38;5;250m    [39mSeekToRestartPoint(left);[0m
[91mâ†’  194 [3332 â†’ 3327]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;28mtrue[39m)[38;5;250m [39m{[0m
   195           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mParseNextKey())[38;5;250m [39m{
   196           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m;
[91mâ†’  197 [3332 â†’ 3327]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  198 [3193 â†’ 3188]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(Compare(key_,[38;5;250m [39mtarget)[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   199           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m;
[91mâ†’  200 [3332 â†’ 3327]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  201 [3193 â†’ 3188]:[0m [91m[38;5;250m    [39m}[0m
   202           : [38;5;250m  [39m}
   203           : 
[91mâ†’  204 [4071 â†’ 4057]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToFirst[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   205           : [38;5;250m    [39mSeekToRestartPoint([38;5;241m0[39m);
   206           : [38;5;250m    [39mParseNextKey();
   207           : [38;5;250m  [39m}
   208           : 
   209           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToLast[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{

........................................

   220           : [38;5;250m    [39mstatus_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mbad entry in block[39m[38;5;124m"[39m);
   221           : [38;5;250m    [39mkey_.clear();
   222           : [38;5;250m    [39mvalue_.clear();
   223           : [38;5;250m  [39m}
   224           : 
[91mâ†’  225 [11990 â†’ 11971]:[0m [91m[38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mParseNextKey[39m()[38;5;250m [39m{[0m
   226           : [38;5;250m    [39mcurrent_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mNextEntryOffset();
   227           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdata_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mcurrent_;
   228           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mlimit[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdata_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mrestarts_;[38;5;250m  [39m[38;5;66;03m// Restarts come right after data[39;00m
   229           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(p[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mlimit)[38;5;250m [39m{
   230           : [38;5;250m      [39m[38;5;66;03m// No more entries to return.  Mark as invalid.[39;00m
   231           : [38;5;250m      [39mcurrent_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mrestarts_;
   232           : [38;5;250m      [39mrestart_index_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnum_restarts_;
   233           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’  234 [8061 â†’ 8042]:[0m [91m[38;5;250m    [39m}[0m
   235           : 
[91mâ†’  236 [8061 â†’ 8042]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Decode next entry[39;00m[0m
[91mâ†’  237 [8061 â†’ 8042]:[0m [91m[38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mshared,[38;5;250m [39mnon_shared,[38;5;250m [39mvalue_length;[0m
   238           : [38;5;250m    [39mp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mDecodeEntry(p,[38;5;250m [39mlimit,[38;5;250m [39m[38;5;241m&[39mshared,[38;5;250m [39m[38;5;241m&[39mnon_shared,[38;5;250m [39m[38;5;241m&[39mvalue_length);
   239           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(p[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39mkey_.size()[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mshared)[38;5;250m [39m{
   240           : [38;5;250m      [39mCorruptionError();
   241           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’  242 [8061 â†’ 8042]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   243           : [38;5;250m      [39mkey_.resize(shared);
   244           : [38;5;250m      [39mkey_.append(p,[38;5;250m [39mnon_shared);
   245           : [38;5;250m      [39mvalue_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(p[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mnon_shared,[38;5;250m [39mvalue_length);
[91mâ†’  246 [8071 â†’ 8052]:[0m [91m[38;5;250m      [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(restart_index_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mnum_restarts_[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
   247           : [38;5;250m             [39mGetRestartPoint(restart_index_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mcurrent_)[38;5;250m [39m{
   248           : [38;5;250m        [39m[38;5;241m+[39m[38;5;241m+[39mrestart_index_;
[91mâ†’  249 [8061 â†’ 8042]:[0m [91m[38;5;250m      [39m}[0m
   250           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
   251           : [38;5;250m    [39m}
   252           : [38;5;250m  [39m}
   253           : };
   254           : 
[91mâ†’  255 [9152 â†’ 9132]:[0m [91mIterator[38;5;241m*[39m[38;5;250m [39m[38;5;21mBlock::NewIterator[39m([38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39mcomparator)[38;5;250m [39m{[0m
   256           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(size_[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m([38;5;125muint32_t[39m))[38;5;250m [39m{
   257           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mNewErrorIterator(Status[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mbad block contents[39m[38;5;124m"[39m));
[91mâ†’  258 [9152 â†’ 9132]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  259 [9152 â†’ 9132]:[0m [91m[38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mnum_restarts[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mNumRestarts();[0m
   260           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(num_restarts[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   261           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mNewEmptyIterator();
[91mâ†’  262 [9152 â†’ 9132]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   263           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mIter(comparator,[38;5;250m [39mdata_,[38;5;250m [39mrestart_offset_,[38;5;250m [39mnum_restarts);
[91mâ†’  264 [9152 â†’ 9132]:[0m [91m[38;5;250m  [39m}[0m
   265           : }
   266           : 
   267           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/table/block_builder.cc ===
Lines with coverage differences:

Lines with different hit counts: 42, 43, 44, 47, 56, 62, 63, 64, 66, 72, 74, 75, 76, 77, 78, 79, 80, 82, 84, 85, 86, 89, 92, 97, 101, 105

Detailed differences with context:
============================================================
    37           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/coding.h"[39;00m
    38           : 
    39           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
    40           : 
    41           : BlockBuilder[38;5;241m:[39m[38;5;241m:[39mBlockBuilder([38;5;28;01mconst[39;00m[38;5;250m [39mOptions[38;5;241m*[39m[38;5;250m [39moptions)
[91mâ†’   42 [5093 â†’ 5087]:[0m [91m[38;5;250m    [39m[38;5;241m:[39m[38;5;250m [39moptions_(options),[38;5;250m [39mrestarts_(),[38;5;250m [39mcounter_([38;5;241m0[39m),[38;5;250m [39mfinished_([38;5;28mfalse[39m)[38;5;250m [39m{[0m
[91mâ†’   43 [5093 â†’ 5087]:[0m [91m[38;5;250m  [39massert(options[38;5;241m-[39m[38;5;241m>[39mblock_restart_interval[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m);[0m
[91mâ†’   44 [5093 â†’ 5087]:[0m [91m[38;5;250m  [39mrestarts_.push_back([38;5;241m0[39m);[38;5;250m  [39m[38;5;66;03m// First restart point is at offset 0[39;00m[0m
    45           : }
    46           : 
[91mâ†’   47 [5210 â†’ 5200]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mBlockBuilder::Reset[39m()[38;5;250m [39m{[0m
    48           : [38;5;250m  [39mbuffer_.clear();
    49           : [38;5;250m  [39mrestarts_.clear();
    50           : [38;5;250m  [39mrestarts_.push_back([38;5;241m0[39m);[38;5;250m  [39m[38;5;66;03m// First restart point is at offset 0[39;00m
    51           : [38;5;250m  [39mcounter_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
    52           : [38;5;250m  [39mfinished_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
    53           : [38;5;250m  [39mlast_key_.clear();
    54           : }
    55           : 
[91mâ†’   56 [2324 â†’ 2303]:[0m [91m[38;5;125msize_t[39m[38;5;250m [39m[38;5;21mBlockBuilder::CurrentSizeEstimate[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
    57           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(buffer_.size()[38;5;250m [39m[38;5;241m+[39m[38;5;250m                       [39m[38;5;66;03m// Raw data buffer[39;00m
    58           : [38;5;250m          [39mrestarts_.size()[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m([38;5;125muint32_t[39m)[38;5;250m [39m[38;5;241m+[39m[38;5;250m  [39m[38;5;66;03m// Restart array[39;00m
    59           : [38;5;250m          [39m[38;5;28;01msizeof[39;00m([38;5;125muint32_t[39m));[38;5;250m                     [39m[38;5;66;03m// Restart array length[39;00m
    60           : }
    61           : 
[91mâ†’   62 [5210 â†’ 5200]:[0m [91mSlice[38;5;250m [39m[38;5;21mBlockBuilder::Finish[39m()[38;5;250m [39m{[0m
[91mâ†’   63 [5210 â†’ 5200]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Append restart array[39;00m[0m
[91mâ†’   64 [5328 â†’ 5314]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mrestarts_.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    65           : [38;5;250m    [39mPutFixed32([38;5;241m&[39mbuffer_,[38;5;250m [39mrestarts_[i]);
[91mâ†’   66 [5210 â†’ 5200]:[0m [91m[38;5;250m  [39m}[0m
    67           : [38;5;250m  [39mPutFixed32([38;5;241m&[39mbuffer_,[38;5;250m [39mrestarts_.size());
    68           : [38;5;250m  [39mfinished_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
    69           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mSlice(buffer_);
    70           : }
    71           : 
[91mâ†’   72 [5836 â†’ 5807]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mBlockBuilder::Add[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
    73           : [38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mlast_key_piece[39m(last_key_);
[91mâ†’   74 [5836 â†’ 5807]:[0m [91m[38;5;250m  [39massert([38;5;241m![39mfinished_);[0m
[91mâ†’   75 [5836 â†’ 5807]:[0m [91m[38;5;250m  [39massert(counter_[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39moptions_[38;5;241m-[39m[38;5;241m>[39mblock_restart_interval);[0m
[91mâ†’   76 [5836 â†’ 5807]:[0m [91m[38;5;250m  [39massert(buffer_.empty()[38;5;250m  [39m[38;5;66;03m// No values yet?[39;00m[0m
[91mâ†’   77 [5836 â†’ 5807]:[0m [91m[38;5;250m         [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39moptions_[38;5;241m-[39m[38;5;241m>[39mcomparator[38;5;241m-[39m[38;5;241m>[39mCompare(key,[38;5;250m [39mlast_key_piece)[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’   78 [5836 â†’ 5807]:[0m [91m[38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39mshared[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[0m
[91mâ†’   79 [5718 â†’ 5693]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(counter_[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39moptions_[38;5;241m-[39m[38;5;241m>[39mblock_restart_interval)[38;5;250m [39m{[0m
[91mâ†’   80 [5718 â†’ 5693]:[0m [91m[38;5;250m    [39m[38;5;66;03m// See how much sharing to do with previous string[39;00m[0m
    81           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mmin_length[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmin(last_key_piece.size(),[38;5;250m [39mkey.size());
[91mâ†’   82 [261 â†’ 254]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m((shared[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mmin_length)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m(last_key_piece[shared][38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mkey[shared]))[38;5;250m [39m{[0m
    83           : [38;5;250m      [39mshared[38;5;241m+[39m[38;5;241m+[39m;
[91mâ†’   84 [5718 â†’ 5693]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   85 [118 â†’ 114]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
[91mâ†’   86 [118 â†’ 114]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Restart compression[39;00m[0m
    87           : [38;5;250m    [39mrestarts_.push_back(buffer_.size());
    88           : [38;5;250m    [39mcounter_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’   89 [5836 â†’ 5807]:[0m [91m[38;5;250m  [39m}[0m
    90           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mnon_shared[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkey.size()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mshared;
    91           : 
[91mâ†’   92 [5836 â†’ 5807]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Add "<shared><non_shared><value_size>" to buffer_[39;00m[0m
    93           : [38;5;250m  [39mPutVarint32([38;5;241m&[39mbuffer_,[38;5;250m [39mshared);
    94           : [38;5;250m  [39mPutVarint32([38;5;241m&[39mbuffer_,[38;5;250m [39mnon_shared);
    95           : [38;5;250m  [39mPutVarint32([38;5;241m&[39mbuffer_,[38;5;250m [39mvalue.size());
    96           : 
[91mâ†’   97 [5836 â†’ 5807]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Add string delta to buffer_ followed by value[39;00m[0m
    98           : [38;5;250m  [39mbuffer_.append(key.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mshared,[38;5;250m [39mnon_shared);
    99           : [38;5;250m  [39mbuffer_.append(value.data(),[38;5;250m [39mvalue.size());
   100           : 
[91mâ†’  101 [5836 â†’ 5807]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Update state[39;00m[0m
   102           : [38;5;250m  [39mlast_key_.resize(shared);
   103           : [38;5;250m  [39mlast_key_.append(key.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mshared,[38;5;250m [39mnon_shared);
   104           : [38;5;250m  [39massert(Slice(last_key_)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mkey);
[91mâ†’  105 [5836 â†’ 5807]:[0m [91m[38;5;250m  [39mcounter_[38;5;241m+[39m[38;5;241m+[39m;[0m
   106           : }
   107           : 
   108           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/table/filter_block.cc ===
Lines with coverage differences:

Lines with different hit counts: 21, 23, 24, 26, 29, 35, 36, 38, 40, 42, 44, 45, 51, 53, 54, 57, 59, 60, 62, 66, 68, 71, 79, 81, 82, 84, 85

Detailed differences with context:
============================================================
    16           : [38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mkFilterBase[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39mkFilterBaseLg;
    17           : 
    18           : FilterBlockBuilder[38;5;241m:[39m[38;5;241m:[39mFilterBlockBuilder([38;5;28;01mconst[39;00m[38;5;250m [39mFilterPolicy[38;5;241m*[39m[38;5;250m [39mpolicy)
    19           : [38;5;250m    [39m[38;5;241m:[39m[38;5;250m [39mpolicy_(policy)[38;5;250m [39m{}
    20           : 
[91mâ†’   21 [3514 â†’ 3506]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mFilterBlockBuilder::StartBlock[39m([38;5;125muint64_t[39m[38;5;250m [39mblock_offset)[38;5;250m [39m{[0m
    22           : [38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39mfilter_index[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(block_offset[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39mkFilterBase);
[91mâ†’   23 [3514 â†’ 3506]:[0m [91m[38;5;250m  [39massert(filter_index[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mfilter_offsets_.size());[0m
[91mâ†’   24 [4510945 â†’ 4530191]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(filter_index[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mfilter_offsets_.size())[38;5;250m [39m{[0m
    25           : [38;5;250m    [39mGenerateFilter();
[91mâ†’   26 [3514 â†’ 3506]:[0m [91m[38;5;250m  [39m}[0m
    27           : }
    28           : 
[91mâ†’   29 [2324 â†’ 2303]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mFilterBlockBuilder::AddKey[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m{[0m
    30           : [38;5;250m  [39mSlice[38;5;250m [39mk[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkey;
    31           : [38;5;250m  [39mstart_.push_back(keys_.size());
    32           : [38;5;250m  [39mkeys_.append(k.data(),[38;5;250m [39mk.size());
    33           : }
    34           : 
[91mâ†’   35 [1697 â†’ 1695]:[0m [91mSlice[38;5;250m [39m[38;5;21mFilterBlockBuilder::Finish[39m()[38;5;250m [39m{[0m
[91mâ†’   36 [1061 â†’ 1055]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstart_.empty())[38;5;250m [39m{[0m
    37           : [38;5;250m    [39mGenerateFilter();
[91mâ†’   38 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m}[0m
    39           : 
[91mâ†’   40 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Append array of per-filter offsets[39;00m[0m
    41           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39marray_offset[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mresult_.size();
[91mâ†’   42 [4503824 â†’ 4523064]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mfilter_offsets_.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    43           : [38;5;250m    [39mPutFixed32([38;5;241m&[39mresult_,[38;5;250m [39mfilter_offsets_[i]);
[91mâ†’   44 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   45 [1697 â†’ 1695]:[0m [91m[0m
    46           : [38;5;250m  [39mPutFixed32([38;5;241m&[39mresult_,[38;5;250m [39marray_offset);
    47           : [38;5;250m  [39mresult_.push_back(kFilterBaseLg);[38;5;250m  [39m[38;5;66;03m// Save encoding parameter in result[39;00m
    48           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mSlice(result_);
    49           : }
    50           : 
[91mâ†’   51 [4512006 â†’ 4531246]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mFilterBlockBuilder::GenerateFilter[39m()[38;5;250m [39m{[0m
    52           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mnum_keys[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstart_.size();
[91mâ†’   53 [4510190 â†’ 4529436]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(num_keys[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
[91mâ†’   54 [4510190 â†’ 4529436]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Fast path if there are no keys for this filter[39;00m[0m
    55           : [38;5;250m    [39mfilter_offsets_.push_back(result_.size());
    56           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m;
[91mâ†’   57 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m}[0m
    58           : 
[91mâ†’   59 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Make list of keys from flattened key structure[39;00m[0m
[91mâ†’   60 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39mstart_.push_back(keys_.size());[38;5;250m  [39m[38;5;66;03m// Simplify length computation[39;00m[0m
    61           : [38;5;250m  [39mtmp_keys_.resize(num_keys);
[91mâ†’   62 [2324 â†’ 2303]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mnum_keys;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    63           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mbase[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkeys_.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mstart_[i];
    64           : [38;5;250m    [39m[38;5;125msize_t[39m[38;5;250m [39mlength[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstart_[i[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m][38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mstart_[i];
    65           : [38;5;250m    [39mtmp_keys_[i][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(base,[38;5;250m [39mlength);
[91mâ†’   66 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m}[0m
    67           : 
[91mâ†’   68 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Generate filter for current set of keys and append to result_.[39;00m[0m
    69           : [38;5;250m  [39mfilter_offsets_.push_back(result_.size());
    70           : [38;5;250m  [39mpolicy_[38;5;241m-[39m[38;5;241m>[39mCreateFilter([38;5;241m&[39mtmp_keys_[[38;5;241m0[39m],[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mint[39m[38;5;241m>[39m(num_keys),[38;5;250m [39m[38;5;241m&[39mresult_);
[91mâ†’   71 [1816 â†’ 1810]:[0m [91m[0m
    72           : [38;5;250m  [39mtmp_keys_.clear();
    73           : [38;5;250m  [39mkeys_.clear();
    74           : [38;5;250m  [39mstart_.clear();
    75           : }
    76           : 
    77           : FilterBlockReader[38;5;241m:[39m[38;5;241m:[39mFilterBlockReader([38;5;28;01mconst[39;00m[38;5;250m [39mFilterPolicy[38;5;241m*[39m[38;5;250m [39mpolicy,
    78           : [38;5;250m                                     [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mcontents)
[91mâ†’   79 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m[38;5;241m:[39m[38;5;250m [39mpolicy_(policy),[38;5;250m [39mdata_([38;5;28;01mnullptr[39;00m),[38;5;250m [39moffset_([38;5;28;01mnullptr[39;00m),[38;5;250m [39mnum_([38;5;241m0[39m),[38;5;250m [39mbase_lg_([38;5;241m0[39m)[38;5;250m [39m{[0m
    80           : [38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39mn[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcontents.size();
[91mâ†’   81 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(n[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m5[39m)[38;5;250m [39m[38;5;28;01mreturn[39;00m;[38;5;250m  [39m[38;5;66;03m// 1 byte for base_lg_ and 4 for start of offset array[39;00m[0m
[91mâ†’   82 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39mbase_lg_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcontents[n[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m];[0m
    83           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mlast_word[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mDecodeFixed32(contents.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mn[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m5[39m);
[91mâ†’   84 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(last_word[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mn[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m5[39m)[38;5;250m [39m[38;5;28;01mreturn[39;00m;[0m
[91mâ†’   85 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39mdata_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcontents.data();[0m
    86           : [38;5;250m  [39moffset_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdata_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mlast_word;
    87           : [38;5;250m  [39mnum_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(n[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m5[39m[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mlast_word)[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39m[38;5;241m4[39m;
    88           : }
    89           : 
    90           : [38;5;125mbool[39m[38;5;250m [39m[38;5;21mFilterBlockReader::KeyMayMatch[39m([38;5;125muint64_t[39m[38;5;250m [39mblock_offset,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m{

=== File: /root/leveldb-fuzzing/leveldb-subtree/table/format.cc ===
Lines with coverage differences:

Lines with different hit counts: 15, 16, 18, 19, 23, 24, 28, 31, 38, 39, 42, 50, 51, 52, 53, 55, 56, 57, 65, 71, 79, 83, 85, 86, 87, 94, 95, 96, 98, 99, 102, 111, 113, 135, 137, 138

Detailed differences with context:
============================================================
    10           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/coding.h"[39;00m
    11           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/crc32c.h"[39;00m
    12           : 
    13           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
    14           : 
[91mâ†’   15 [6906 â†’ 6894]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mBlockHandle::EncodeTo[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mdst)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’   16 [6906 â†’ 6894]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Sanity check that all fields have been set[39;00m[0m
    17           : [38;5;250m  [39massert(offset_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m~[39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m([38;5;241m0[39m));
[91mâ†’   18 [6906 â†’ 6894]:[0m [91m[38;5;250m  [39massert(size_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m~[39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m([38;5;241m0[39m));[0m
[91mâ†’   19 [6906 â†’ 6894]:[0m [91m[38;5;250m  [39mPutVarint64(dst,[38;5;250m [39moffset_);[0m
    20           : [38;5;250m  [39mPutVarint64(dst,[38;5;250m [39msize_);
    21           : }
    22           : 
[91mâ†’   23 [9550 â†’ 9528]:[0m [91mStatus[38;5;250m [39m[38;5;21mBlockHandle::DecodeFrom[39m(Slice[38;5;241m*[39m[38;5;250m [39minput)[38;5;250m [39m{[0m
[91mâ†’   24 [9550 â†’ 9528]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(GetVarint64(input,[38;5;250m [39m[38;5;241m&[39moffset_)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mGetVarint64(input,[38;5;250m [39m[38;5;241m&[39msize_))[38;5;250m [39m{[0m
    25           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
    26           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
    27           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mbad block handle[39m[38;5;124m"[39m);
[91mâ†’   28 [9550 â†’ 9528]:[0m [91m[38;5;250m  [39m}[0m
    29           : }
    30           : 
[91mâ†’   31 [1697 â†’ 1695]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mFooter::EncodeTo[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mdst)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
    32           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39moriginal_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdst[38;5;241m-[39m[38;5;241m>[39msize();
    33           : [38;5;250m  [39mmetaindex_handle_.EncodeTo(dst);
    34           : [38;5;250m  [39mindex_handle_.EncodeTo(dst);
    35           : [38;5;250m  [39mdst[38;5;241m-[39m[38;5;241m>[39mresize([38;5;241m2[39m[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39mBlockHandle[38;5;241m:[39m[38;5;241m:[39mkMaxEncodedLength);[38;5;250m  [39m[38;5;66;03m// Padding[39;00m
    36           : [38;5;250m  [39mPutFixed32(dst,[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m(kTableMagicNumber[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m0xffffffffu[39m));
    37           : [38;5;250m  [39mPutFixed32(dst,[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m(kTableMagicNumber[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m32[39m));
[91mâ†’   38 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39massert(dst[38;5;241m-[39m[38;5;241m>[39msize()[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39moriginal_size[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkEncodedLength);[0m
[91mâ†’   39 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m([38;5;125mvoid[39m)original_size;[38;5;250m  [39m[38;5;66;03m// Disable unused variable warning.[39;00m[0m
    40           : }
    41           : 
[91mâ†’   42 [2136 â†’ 2131]:[0m [91mStatus[38;5;250m [39m[38;5;21mFooter::DecodeFrom[39m(Slice[38;5;241m*[39m[38;5;250m [39minput)[38;5;250m [39m{[0m
    43           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mmagic_ptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minput[38;5;241m-[39m[38;5;241m>[39mdata()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkEncodedLength[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m8[39m;
    44           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mmagic_lo[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mDecodeFixed32(magic_ptr);
    45           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mmagic_hi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mDecodeFixed32(magic_ptr[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m4[39m);
    46           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mmagic[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(([38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m(magic_hi)[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m32[39m)[38;5;250m [39m[38;5;241m|[39m
    47           : [38;5;250m                          [39m([38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m(magic_lo)));
    48           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(magic[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mkTableMagicNumber)[38;5;250m [39m{
    49           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mnot an sstable (bad magic number)[39m[38;5;124m"[39m);
[91mâ†’   50 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   51 [2136 â†’ 2131]:[0m [91m[0m
[91mâ†’   52 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmetaindex_handle_.DecodeFrom(input);[0m
[91mâ†’   53 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(result.ok())[38;5;250m [39m{[0m
    54           : [38;5;250m    [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mindex_handle_.DecodeFrom(input);
[91mâ†’   55 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   56 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(result.ok())[38;5;250m [39m{[0m
[91mâ†’   57 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m[38;5;66;03m// We skip over any leftover data (just padding for now) in "input"[39;00m[0m
    58           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mend[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmagic_ptr[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m8[39m;
    59           : [38;5;250m    [39m[38;5;241m*[39minput[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(end,[38;5;250m [39minput[38;5;241m-[39m[38;5;241m>[39mdata()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39minput[38;5;241m-[39m[38;5;241m>[39msize()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mend);
    60           : [38;5;250m  [39m}
    61           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;
    62           : }
    63           : 
    64           : Status[38;5;250m [39mReadBlock(RandomAccessFile[38;5;241m*[39m[38;5;250m [39mfile,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mReadOptions[38;5;241m&[39m[38;5;250m [39moptions,
[91mâ†’   65 [9005 â†’ 8983]:[0m [91m[38;5;250m                 [39m[38;5;28;01mconst[39;00m[38;5;250m [39mBlockHandle[38;5;241m&[39m[38;5;250m [39mhandle,[38;5;250m [39mBlockContents[38;5;241m*[39m[38;5;250m [39mresult)[38;5;250m [39m{[0m
    66           : [38;5;250m  [39mresult[38;5;241m-[39m[38;5;241m>[39mdata[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice();
    67           : [38;5;250m  [39mresult[38;5;241m-[39m[38;5;241m>[39mcachable[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
    68           : [38;5;250m  [39mresult[38;5;241m-[39m[38;5;241m>[39mheap_allocated[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
    69           : 
    70           : [38;5;250m  [39m[38;5;66;03m// Read the block contents as well as the type/crc footer.[39;00m
[91mâ†’   71 [9005 â†’ 8983]:[0m [91m[38;5;250m  [39m[38;5;66;03m// See table_builder.cc for the code that built this structure.[39;00m[0m
    72           : [38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39mn[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125msize_t[39m[38;5;241m>[39m(handle.size());
    73           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mbuf[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39m[38;5;125mchar[39m[n[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkBlockTrailerSize];
    74           : [38;5;250m  [39mSlice[38;5;250m [39mcontents;
    75           : [38;5;250m  [39mStatus[38;5;250m [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfile[38;5;241m-[39m[38;5;241m>[39mRead(handle.offset(),[38;5;250m [39mn[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkBlockTrailerSize,[38;5;250m [39m[38;5;241m&[39mcontents,[38;5;250m [39mbuf);
    76           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39ms.ok())[38;5;250m [39m{
    77           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mbuf;
    78           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
[91mâ†’   79 [9005 â†’ 8983]:[0m [91m[38;5;250m  [39m}[0m
    80           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(contents.size()[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mn[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkBlockTrailerSize)[38;5;250m [39m{
    81           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mbuf;
    82           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mtruncated block read[39m[38;5;124m"[39m,[38;5;250m [39mfile[38;5;241m-[39m[38;5;241m>[39mGetName());
[91mâ†’   83 [9005 â†’ 8983]:[0m [91m[38;5;250m  [39m}[0m
    84           : 
[91mâ†’   85 [9005 â†’ 8983]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Check the crc of the type and the block contents[39;00m[0m
[91mâ†’   86 [9005 â†’ 8983]:[0m [91m[38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mdata[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcontents.data();[38;5;250m  [39m[38;5;66;03m// Pointer to where Read put the data[39;00m[0m
[91mâ†’   87 [7068 â†’ 7047]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(options.verify_checksums)[38;5;250m [39m{[0m
    88           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mcrc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc32c[38;5;241m:[39m[38;5;241m:[39mUnmask(DecodeFixed32(data[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mn[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m));
    89           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mactual[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc32c[38;5;241m:[39m[38;5;241m:[39mValue(data,[38;5;250m [39mn[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m);
    90           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(actual[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mcrc)[38;5;250m [39m{
    91           : [38;5;250m      [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mbuf;
    92           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mblock checksum mismatch[39m[38;5;124m"[39m,[38;5;250m [39mfile[38;5;241m-[39m[38;5;241m>[39mGetName());
    93           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
[91mâ†’   94 [7068 â†’ 7047]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   95 [9005 â†’ 8983]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   96 [9005 â†’ 8983]:[0m [91m[0m
    97           : [38;5;250m  [39m[38;5;28;01mswitch[39;00m[38;5;250m [39m(data[n])[38;5;250m [39m{
[91mâ†’   98 [9005 â†’ 8983]:[0m [91m[38;5;250m    [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkNoCompression[39m:[0m
[91mâ†’   99 [9005 â†’ 8983]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(data[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mbuf)[38;5;250m [39m{[0m
   100           : [38;5;250m        [39m[38;5;66;03m// File implementation gave us pointer to some other data.[39;00m
   101           : [38;5;250m        [39m[38;5;66;03m// Use it directly under the assumption that it will be live[39;00m
[91mâ†’  102 [9005 â†’ 8983]:[0m [91m[38;5;250m        [39m[38;5;66;03m// while the file is open.[39;00m[0m
   103           : [38;5;250m        [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mbuf;
   104           : [38;5;250m        [39mresult[38;5;241m-[39m[38;5;241m>[39mdata[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(data,[38;5;250m [39mn);
   105           : [38;5;250m        [39mresult[38;5;241m-[39m[38;5;241m>[39mheap_allocated[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
   106           : [38;5;250m        [39mresult[38;5;241m-[39m[38;5;241m>[39mcachable[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;[38;5;250m  [39m[38;5;66;03m// Do not double-cache[39;00m
   107           : [38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   108           : [38;5;250m        [39mresult[38;5;241m-[39m[38;5;241m>[39mdata[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(buf,[38;5;250m [39mn);
   109           : [38;5;250m        [39mresult[38;5;241m-[39m[38;5;241m>[39mheap_allocated[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   110           : [38;5;250m        [39mresult[38;5;241m-[39m[38;5;241m>[39mcachable[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  111 [9005 â†’ 8983]:[0m [91m[38;5;250m      [39m}[0m
   112           : 
[91mâ†’  113 [9005 â†’ 8983]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Ok[39;00m[0m
   114           : [38;5;250m      [39m[38;5;28;01mbreak[39;00m;
   115           : [38;5;250m    [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkSnappyCompression[39m:[38;5;250m [39m{
   116           : [38;5;250m      [39m[38;5;125msize_t[39m[38;5;250m [39mulength[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
   117           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mport[38;5;241m:[39m[38;5;241m:[39mSnappy_GetUncompressedLength(data,[38;5;250m [39mn,[38;5;250m [39m[38;5;241m&[39mulength))[38;5;250m [39m{
   118           : [38;5;250m        [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mbuf;

........................................

   130           : [38;5;250m      [39mresult[38;5;241m-[39m[38;5;241m>[39mcachable[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   131           : [38;5;250m      [39m[38;5;28;01mbreak[39;00m;
   132           : [38;5;250m    [39m}
   133           : [38;5;250m    [39m[38;5;28;01mdefault[39;00m[38;5;241m:[39m
   134           : [38;5;250m      [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mbuf;
[91mâ†’  135 [9005 â†’ 8983]:[0m [91m[38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mbad block type[39m[38;5;124m"[39m,[38;5;250m [39mfile[38;5;241m-[39m[38;5;241m>[39mGetName());[0m
   136           : [38;5;250m  [39m}
[91mâ†’  137 [9005 â†’ 8983]:[0m [91m[0m
[91mâ†’  138 [9005 â†’ 8983]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();[0m
   139           : }
   140           : 
   141           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/table/iterator.cc ===
Lines with coverage differences:

Lines with different hit counts: 9, 14, 15, 22, 23, 26, 27, 28, 29, 35

Detailed differences with context:
============================================================
     4           : 
     5           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"leveldb/iterator.h"[39;00m
     6           : 
     7           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
     8           : 
[91mâ†’    9 [22911 â†’ 22859]:[0m [91mIterator[38;5;241m:[39m[38;5;241m:[39mIterator()[38;5;250m [39m{[0m
    10           : [38;5;250m  [39mcleanup_head_.function[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
    11           : [38;5;250m  [39mcleanup_head_.next[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
    12           : }
    13           : 
[91mâ†’   14 [22910 â†’ 22859]:[0m [91mIterator[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mIterator()[38;5;250m [39m{[0m
[91mâ†’   15 [8619 â†’ 8604]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mcleanup_head_.IsEmpty())[38;5;250m [39m{[0m
    16           : [38;5;250m    [39mcleanup_head_.Run();
    17           : [38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m(CleanupNode[38;5;241m*[39m[38;5;250m [39mnode[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcleanup_head_.next;[38;5;250m [39mnode[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;)[38;5;250m [39m{
    18           : [38;5;250m      [39mnode[38;5;241m-[39m[38;5;241m>[39mRun();
    19           : [38;5;250m      [39mCleanupNode[38;5;241m*[39m[38;5;250m [39mnext_node[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnode[38;5;241m-[39m[38;5;241m>[39mnext;
    20           : [38;5;250m      [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mnode;
    21           : [38;5;250m      [39mnode[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnext_node;
[91mâ†’   22 [8619 â†’ 8604]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   23 [22910 â†’ 22859]:[0m [91m[38;5;250m  [39m}[0m
    24           : }
    25           : 
[91mâ†’   26 [8619 â†’ 8604]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mIterator::RegisterCleanup[39m(CleanupFunction[38;5;250m [39mfunc,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg1,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg2)[38;5;250m [39m{[0m
[91mâ†’   27 [8619 â†’ 8604]:[0m [91m[38;5;250m  [39massert(func[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);[0m
[91mâ†’   28 [8619 â†’ 8604]:[0m [91m[38;5;250m  [39mCleanupNode[38;5;241m*[39m[38;5;250m [39mnode;[0m
[91mâ†’   29 [8619 â†’ 8604]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(cleanup_head_.IsEmpty())[38;5;250m [39m{[0m
    30           : [38;5;250m    [39mnode[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mcleanup_head_;
    31           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
    32           : [38;5;250m    [39mnode[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mCleanupNode();
    33           : [38;5;250m    [39mnode[38;5;241m-[39m[38;5;241m>[39mnext[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcleanup_head_.next;
    34           : [38;5;250m    [39mcleanup_head_.next[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnode;
[91mâ†’   35 [8619 â†’ 8604]:[0m [91m[38;5;250m  [39m}[0m
    36           : [38;5;250m  [39mnode[38;5;241m-[39m[38;5;241m>[39mfunction[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfunc;
    37           : [38;5;250m  [39mnode[38;5;241m-[39m[38;5;241m>[39marg1[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39marg1;
    38           : [38;5;250m  [39mnode[38;5;241m-[39m[38;5;241m>[39marg2[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39marg2;
    39           : }
    40           : 

=== File: /root/leveldb-fuzzing/leveldb-subtree/table/iterator_wrapper.h ===
Lines with coverage differences:

Lines with different hit counts: 26, 29, 31, 33, 38, 39, 40, 42, 43, 44, 47, 48, 49, 51, 52, 53, 66, 67, 68, 78, 80, 82

Detailed differences with context:
============================================================
    21           : [38;5;250m  [39m[38;5;241m~[39mIteratorWrapper()[38;5;250m [39m{[38;5;250m [39mdelete[38;5;250m [39miter_;[38;5;250m [39m}
    22           : [38;5;250m  [39mIterator[38;5;241m*[39m[38;5;250m [39m[38;5;21miter[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39miter_;[38;5;250m [39m}
    23           : 
    24           : [38;5;250m  [39m[38;5;66;03m// Takes ownership of "iter" and will delete it when destroyed, or[39;00m
    25           : [38;5;250m  [39m[38;5;66;03m// when Set() is invoked again.[39;00m
[91mâ†’   26 [22092 â†’ 22025]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSet[39m(Iterator[38;5;241m*[39m[38;5;250m [39miter)[38;5;250m [39m{[0m
    27           : [38;5;250m    [39mdelete[38;5;250m [39miter_;
    28           : [38;5;250m    [39miter_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39miter;
[91mâ†’   29 [10451 â†’ 10424]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(iter_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mnullptr)[38;5;250m [39m{[0m
    30           : [38;5;250m      [39mvalid_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’   31 [11641 â†’ 11601]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
    32           : [38;5;250m      [39mUpdate();
[91mâ†’   33 [22092 â†’ 22025]:[0m [91m[38;5;250m    [39m}[0m
    34           : [38;5;250m  [39m}
    35           : 
    36           : [38;5;250m  [39m[38;5;66;03m// Iterator interface methods[39;00m
    37           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mValid[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mvalid_;[38;5;250m [39m}
[91mâ†’   38 [11178 â†’ 11158]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mkey[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’   39 [11178 â†’ 11158]:[0m [91m[38;5;250m    [39massert(Valid());[0m
[91mâ†’   40 [11178 â†’ 11158]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mkey_;[0m
    41           : [38;5;250m  [39m}
[91mâ†’   42 [9965 â†’ 9940]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mvalue[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’   43 [9965 â†’ 9940]:[0m [91m[38;5;250m    [39massert(Valid());[0m
[91mâ†’   44 [9965 â†’ 9940]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39miter_[38;5;241m-[39m[38;5;241m>[39mvalue();[0m
    45           : [38;5;250m  [39m}
    46           : [38;5;250m  [39m[38;5;66;03m// Methods below require iter() != nullptr[39;00m
[91mâ†’   47 [7692 â†’ 7676]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mstatus[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’   48 [7692 â†’ 7676]:[0m [91m[38;5;250m    [39massert(iter_);[0m
[91mâ†’   49 [7692 â†’ 7676]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39miter_[38;5;241m-[39m[38;5;241m>[39mstatus();[0m
    50           : [38;5;250m  [39m}
[91mâ†’   51 [9700 â†’ 9691]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mNext[39m()[38;5;250m [39m{[0m
[91mâ†’   52 [9700 â†’ 9691]:[0m [91m[38;5;250m    [39massert(iter_);[0m
[91mâ†’   53 [9700 â†’ 9691]:[0m [91m[38;5;250m    [39miter_[38;5;241m-[39m[38;5;241m>[39mNext();[0m
    54           : [38;5;250m    [39mUpdate();
    55           : [38;5;250m  [39m}
    56           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPrev[39m()[38;5;250m [39m{
    57           : [38;5;250m    [39massert(iter_);
    58           : [38;5;250m    [39miter_[38;5;241m-[39m[38;5;241m>[39mPrev();

........................................

    61           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeek[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mk)[38;5;250m [39m{
    62           : [38;5;250m    [39massert(iter_);
    63           : [38;5;250m    [39miter_[38;5;241m-[39m[38;5;241m>[39mSeek(k);
    64           : [38;5;250m    [39mUpdate();
    65           : [38;5;250m  [39m}
[91mâ†’   66 [8714 â†’ 8676]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToFirst[39m()[38;5;250m [39m{[0m
[91mâ†’   67 [8714 â†’ 8676]:[0m [91m[38;5;250m    [39massert(iter_);[0m
[91mâ†’   68 [8714 â†’ 8676]:[0m [91m[38;5;250m    [39miter_[38;5;241m-[39m[38;5;241m>[39mSeekToFirst();[0m
    69           : [38;5;250m    [39mUpdate();
    70           : [38;5;250m  [39m}
    71           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToLast[39m()[38;5;250m [39m{
    72           : [38;5;250m    [39massert(iter_);
    73           : [38;5;250m    [39miter_[38;5;241m-[39m[38;5;241m>[39mSeekToLast();
    74           : [38;5;250m    [39mUpdate();
    75           : [38;5;250m  [39m}
    76           : 
    77           : [38;5;250m [39mprivate[38;5;241m:[39m
[91mâ†’   78 [30054 â†’ 29967]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mUpdate[39m()[38;5;250m [39m{[0m
    79           : [38;5;250m    [39mvalid_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39miter_[38;5;241m-[39m[38;5;241m>[39mValid();
[91mâ†’   80 [10009 â†’ 9969]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(valid_)[38;5;250m [39m{[0m
    81           : [38;5;250m      [39mkey_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39miter_[38;5;241m-[39m[38;5;241m>[39mkey();
[91mâ†’   82 [30054 â†’ 29967]:[0m [91m[38;5;250m    [39m}[0m
    83           : [38;5;250m  [39m}
    84           : 
    85           : [38;5;250m  [39mIterator[38;5;241m*[39m[38;5;250m [39miter_;
    86           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39mvalid_;
    87           : [38;5;250m  [39mSlice[38;5;250m [39mkey_;

=== File: /root/leveldb-fuzzing/leveldb-subtree/table/merger.cc ===
Lines with coverage differences:

Lines with different hit counts: 21, 22, 24, 31, 32, 34, 55, 56, 62, 75, 76, 110, 111, 112, 115, 116, 117, 122, 126, 148, 150, 152, 153, 155, 157, 158, 159, 180, 181, 186, 188

Detailed differences with context:
============================================================
    16           : [38;5;250m  [39mMergingIterator([38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39mcomparator,[38;5;250m [39mIterator[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mchildren,[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mn)
    17           : [38;5;250m      [39m[38;5;241m:[39m[38;5;250m [39mcomparator_(comparator),
    18           : [38;5;250m        [39mchildren_([38;5;28;01mnew[39;00m[38;5;250m [39mIteratorWrapper[n]),
    19           : [38;5;250m        [39mn_(n),
    20           : [38;5;250m        [39mcurrent_([38;5;28;01mnullptr[39;00m),
[91mâ†’   21 [1460 â†’ 1457]:[0m [91m[38;5;250m        [39mdirection_(kForward)[38;5;250m [39m{[0m
[91mâ†’   22 [3551 â†’ 3546]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mn;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    23           : [38;5;250m      [39mchildren_[i].Set(children[i]);
[91mâ†’   24 [1460 â†’ 1457]:[0m [91m[38;5;250m    [39m}[0m
    25           : [38;5;250m  [39m}
    26           : 
    27           : [38;5;250m  [39m[38;5;241m~[39mMergingIterator()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mchildren_;[38;5;250m [39m}
    28           : 
    29           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mValid[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(current_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m);[38;5;250m [39m}
    30           : 
[91mâ†’   31 [1116 â†’ 1113]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToFirst[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’   32 [2711 â†’ 2706]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mn_;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    33           : [38;5;250m      [39mchildren_[i].SeekToFirst();
[91mâ†’   34 [1116 â†’ 1113]:[0m [91m[38;5;250m    [39m}[0m
    35           : [38;5;250m    [39mFindSmallest();
    36           : [38;5;250m    [39mdirection_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkForward;
    37           : [38;5;250m  [39m}
    38           : 
    39           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToLast[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{

........................................

    50           : [38;5;250m    [39m}
    51           : [38;5;250m    [39mFindSmallest();
    52           : [38;5;250m    [39mdirection_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkForward;
    53           : [38;5;250m  [39m}
    54           : 
[91mâ†’   55 [2860 â†’ 2861]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mNext[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’   56 [2860 â†’ 2861]:[0m [91m[38;5;250m    [39massert(Valid());[0m
    57           : 
    58           : [38;5;250m    [39m[38;5;66;03m// Ensure that all children are positioned after key().[39;00m
    59           : [38;5;250m    [39m[38;5;66;03m// If we are moving in the forward direction, it is already[39;00m
    60           : [38;5;250m    [39m[38;5;66;03m// true for all of the non-current_ children since current_ is[39;00m
    61           : [38;5;250m    [39m[38;5;66;03m// the smallest child and key() == current_->key().  Otherwise,[39;00m
[91mâ†’   62 [2860 â†’ 2861]:[0m [91m[38;5;250m    [39m[38;5;66;03m// we explicitly position the non-current_ children.[39;00m[0m
    63           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(direction_[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mkForward)[38;5;250m [39m{
    64           : [38;5;250m      [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mn_;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{
    65           : [38;5;250m        [39mIteratorWrapper[38;5;241m*[39m[38;5;250m [39mchild[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mchildren_[i];
    66           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(child[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mcurrent_)[38;5;250m [39m{
    67           : [38;5;250m          [39mchild[38;5;241m-[39m[38;5;241m>[39mSeek(key());

........................................

    70           : [38;5;250m            [39mchild[38;5;241m-[39m[38;5;241m>[39mNext();
    71           : [38;5;250m          [39m}
    72           : [38;5;250m        [39m}
    73           : [38;5;250m      [39m}
    74           : [38;5;250m      [39mdirection_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkForward;
[91mâ†’   75 [2860 â†’ 2861]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   76 [2860 â†’ 2861]:[0m [91m[0m
    77           : [38;5;250m    [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mNext();
    78           : [38;5;250m    [39mFindSmallest();
    79           : [38;5;250m  [39m}
    80           : 
    81           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPrev[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{

........................................

   105           : 
   106           : [38;5;250m    [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mPrev();
   107           : [38;5;250m    [39mFindLargest();
   108           : [38;5;250m  [39m}
   109           : 
[91mâ†’  110 [4206 â†’ 4207]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mkey[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’  111 [4206 â†’ 4207]:[0m [91m[38;5;250m    [39massert(Valid());[0m
[91mâ†’  112 [4206 â†’ 4207]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mkey();[0m
   113           : [38;5;250m  [39m}
   114           : 
[91mâ†’  115 [3049 â†’ 3048]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mvalue[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’  116 [3049 â†’ 3048]:[0m [91m[38;5;250m    [39massert(Valid());[0m
[91mâ†’  117 [3049 â†’ 3048]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mcurrent_[38;5;241m-[39m[38;5;241m>[39mvalue();[0m
   118           : [38;5;250m  [39m}
   119           : 
   120           : [38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mstatus[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   121           : [38;5;250m    [39mStatus[38;5;250m [39mstatus;
[91mâ†’  122 [687 â†’ 688]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mn_;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   123           : [38;5;250m      [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mchildren_[i].status();
   124           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   125           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
[91mâ†’  126 [687 â†’ 688]:[0m [91m[38;5;250m      [39m}[0m
   127           : [38;5;250m    [39m}
   128           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
   129           : [38;5;250m  [39m}
   130           : 
   131           : [38;5;250m [39m[38;5;28;01mprivate[39;00m[38;5;241m:[39m

........................................

   143           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mn_;
   144           : [38;5;250m  [39mIteratorWrapper[38;5;241m*[39m[38;5;250m [39mcurrent_;
   145           : [38;5;250m  [39mDirection[38;5;250m [39mdirection_;
   146           : };
   147           : 
[91mâ†’  148 [3976 â†’ 3974]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mMergingIterator::FindSmallest[39m()[38;5;250m [39m{[0m
   149           : [38;5;250m  [39mIteratorWrapper[38;5;241m*[39m[38;5;250m [39msmallest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’  150 [9994 â†’ 9995]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mn_;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
   151           : [38;5;250m    [39mIteratorWrapper[38;5;241m*[39m[38;5;250m [39mchild[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mchildren_[i];
[91mâ†’  152 [4409 â†’ 4404]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(child[38;5;241m-[39m[38;5;241m>[39mValid())[38;5;250m [39m{[0m
[91mâ†’  153 [2894 â†’ 2891]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(smallest[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   154           : [38;5;250m        [39msmallest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mchild;
[91mâ†’  155 [384 â†’ 385]:[0m [91m[38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(comparator_[38;5;241m-[39m[38;5;241m>[39mCompare(child[38;5;241m-[39m[38;5;241m>[39mkey(),[38;5;250m [39msmallest[38;5;241m-[39m[38;5;241m>[39mkey())[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   156           : [38;5;250m        [39msmallest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mchild;
[91mâ†’  157 [4409 â†’ 4404]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  158 [9994 â†’ 9995]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  159 [3976 â†’ 3974]:[0m [91m[38;5;250m  [39m}[0m
   160           : [38;5;250m  [39mcurrent_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39msmallest;
   161           : }
   162           : 
   163           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mMergingIterator::FindLargest[39m()[38;5;250m [39m{
   164           : [38;5;250m  [39mIteratorWrapper[38;5;241m*[39m[38;5;250m [39mlargest[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;

........................................

   175           : [38;5;250m  [39mcurrent_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlargest;
   176           : }
   177           : }[38;5;250m  [39m[38;5;66;03m// namespace[39;00m
   178           : 
   179           : Iterator[38;5;241m*[39m[38;5;250m [39mNewMergingIterator([38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39mcomparator,[38;5;250m [39mIterator[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mchildren,
[91mâ†’  180 [2504 â†’ 2501]:[0m [91m[38;5;250m                             [39m[38;5;125mint[39m[38;5;250m [39mn)[38;5;250m [39m{[0m
[91mâ†’  181 [2504 â†’ 2501]:[0m [91m[38;5;250m  [39massert(n[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);[0m
   182           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(n[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   183           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mNewEmptyIterator();
   184           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(n[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m)[38;5;250m [39m{
   185           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mchildren[[38;5;241m0[39m];
[91mâ†’  186 [1460 â†’ 1457]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   187           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mMergingIterator(comparator,[38;5;250m [39mchildren,[38;5;250m [39mn);
[91mâ†’  188 [2504 â†’ 2501]:[0m [91m[38;5;250m  [39m}[0m
   189           : }
   190           : 
   191           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/table/table.cc ===
Lines with coverage differences:

Lines with different hit counts: 21, 39, 43, 44, 45, 49, 50, 51, 53, 55, 56, 57, 59, 61, 64, 65, 67, 74, 80, 84, 87, 90, 91, 92, 94, 99, 100, 101, 106, 108, 113, 118, 121, 122, 123, 125, 129, 132, 138, 156, 161, 167, 168, 170, 178, 180, 185, 193, 195, 197, 199, 203, 206, 210

Detailed differences with context:
============================================================
    16           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/coding.h"[39;00m
    17           : 
    18           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
    19           : 
    20           : [38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;21;01mTable[39;00m[38;5;241m:[39m[38;5;241m:[39mRep[38;5;250m [39m{
[91mâ†’   21 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;241m~[39mRep()[38;5;250m [39m{[0m
    22           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mfilter;
    23           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mfilter_data;
    24           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mindex_block;
    25           : [38;5;250m  [39m}
    26           : 

........................................

    34           : [38;5;250m  [39mBlockHandle[38;5;250m [39mmetaindex_handle;[38;5;250m  [39m[38;5;66;03m// Handle to metaindex_block: saved from footer[39;00m
    35           : [38;5;250m  [39mBlock[38;5;241m*[39m[38;5;250m [39mindex_block;
    36           : };
    37           : 
    38           : Status[38;5;250m [39mTable[38;5;241m:[39m[38;5;241m:[39mOpen([38;5;28;01mconst[39;00m[38;5;250m [39mOptions[38;5;241m&[39m[38;5;250m [39moptions,[38;5;250m [39mRandomAccessFile[38;5;241m*[39m[38;5;250m [39mfile,
[91mâ†’   39 [2136 â†’ 2131]:[0m [91m[38;5;250m                   [39m[38;5;125muint64_t[39m[38;5;250m [39msize,[38;5;250m [39mTable[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mtable)[38;5;250m [39m{[0m
    40           : [38;5;250m  [39m[38;5;241m*[39mtable[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
    41           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(size[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mFooter[38;5;241m:[39m[38;5;241m:[39mkEncodedLength)[38;5;250m [39m{
    42           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mCorruption([38;5;124m"[39m[38;5;124mfile is too short to be an sstable[39m[38;5;124m"[39m);
[91mâ†’   43 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   44 [2136 â†’ 2131]:[0m [91m[0m
[91mâ†’   45 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;125mchar[39m[38;5;250m [39mfooter_space[Footer[38;5;241m:[39m[38;5;241m:[39mkEncodedLength];[0m
    46           : [38;5;250m  [39mSlice[38;5;250m [39mfooter_input;
    47           : [38;5;250m  [39mStatus[38;5;250m [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfile[38;5;241m-[39m[38;5;241m>[39mRead(size[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mFooter[38;5;241m:[39m[38;5;241m:[39mkEncodedLength,[38;5;250m [39mFooter[38;5;241m:[39m[38;5;241m:[39mkEncodedLength,
    48           : [38;5;250m                        [39m[38;5;241m&[39mfooter_input,[38;5;250m [39mfooter_space);
[91mâ†’   49 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39ms.ok())[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;[0m
[91mâ†’   50 [2136 â†’ 2131]:[0m [91m[0m
[91mâ†’   51 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39mFooter[38;5;250m [39mfooter;[0m
    52           : [38;5;250m  [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfooter.DecodeFrom([38;5;241m&[39mfooter_input);
[91mâ†’   53 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39ms.ok())[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;[0m
    54           : 
[91mâ†’   55 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Read the index block[39;00m[0m
[91mâ†’   56 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39mBlockContents[38;5;250m [39mindex_block_contents;[0m
[91mâ†’   57 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
    58           : [38;5;250m    [39mReadOptions[38;5;250m [39mopt;
[91mâ†’   59 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(options.paranoid_checks)[38;5;250m [39m{[0m
    60           : [38;5;250m      [39mopt.verify_checksums[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’   61 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m}[0m
    62           : [38;5;250m    [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mReadBlock(file,[38;5;250m [39mopt,[38;5;250m [39mfooter.index_handle(),[38;5;250m [39m[38;5;241m&[39mindex_block_contents);
    63           : [38;5;250m  [39m}
[91mâ†’   64 [2136 â†’ 2131]:[0m [91m[0m
[91mâ†’   65 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
    66           : [38;5;250m    [39m[38;5;66;03m// We've successfully read the footer and the index block: we're[39;00m
[91mâ†’   67 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m[38;5;66;03m// ready to serve requests.[39;00m[0m
    68           : [38;5;250m    [39mBlock[38;5;241m*[39m[38;5;250m [39mindex_block[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mBlock(index_block_contents);
    69           : [38;5;250m    [39mRep[38;5;241m*[39m[38;5;250m [39mrep[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mTable[38;5;241m:[39m[38;5;241m:[39mRep;
    70           : [38;5;250m    [39mrep[38;5;241m-[39m[38;5;241m>[39moptions[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39moptions;
    71           : [38;5;250m    [39mrep[38;5;241m-[39m[38;5;241m>[39mfile[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfile;
    72           : [38;5;250m    [39mrep[38;5;241m-[39m[38;5;241m>[39mmetaindex_handle[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfooter.metaindex_handle();
    73           : [38;5;250m    [39mrep[38;5;241m-[39m[38;5;241m>[39mindex_block[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mindex_block;
[91mâ†’   74 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39mrep[38;5;241m-[39m[38;5;241m>[39mcache_id[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(options.block_cache[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39moptions.block_cache[38;5;241m-[39m[38;5;241m>[39mNewId()[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;241m0[39m);[0m
    75           : [38;5;250m    [39mrep[38;5;241m-[39m[38;5;241m>[39mfilter_data[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
    76           : [38;5;250m    [39mrep[38;5;241m-[39m[38;5;241m>[39mfilter[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
    77           : [38;5;250m    [39m[38;5;241m*[39mtable[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mTable(rep);
    78           : [38;5;250m    [39m([38;5;241m*[39mtable)[38;5;241m-[39m[38;5;241m>[39mReadMeta(footer);
    79           : [38;5;250m  [39m}
[91mâ†’   80 [2136 â†’ 2131]:[0m [91m[0m
    81           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ms;
    82           : }
    83           : 
[91mâ†’   84 [2136 â†’ 2131]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTable::ReadMeta[39m([38;5;28;01mconst[39;00m[38;5;250m [39mFooter[38;5;241m&[39m[38;5;250m [39mfooter)[38;5;250m [39m{[0m
    85           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(rep_[38;5;241m-[39m[38;5;241m>[39moptions.filter_policy[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
    86           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m;[38;5;250m  [39m[38;5;66;03m// Do not need any metadata[39;00m
[91mâ†’   87 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
    88           : 
    89           : [38;5;250m  [39m[38;5;66;03m// TODO(sanjay): Skip this if footer.metaindex_handle() size indicates[39;00m
[91mâ†’   90 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;66;03m// it is an empty block.[39;00m[0m
[91mâ†’   91 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39mReadOptions[38;5;250m [39mopt;[0m
[91mâ†’   92 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(rep_[38;5;241m-[39m[38;5;241m>[39moptions.paranoid_checks)[38;5;250m [39m{[0m
    93           : [38;5;250m    [39mopt.verify_checksums[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’   94 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
    95           : [38;5;250m  [39mBlockContents[38;5;250m [39mcontents;
    96           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mReadBlock(rep_[38;5;241m-[39m[38;5;241m>[39mfile,[38;5;250m [39mopt,[38;5;250m [39mfooter.metaindex_handle(),[38;5;250m [39m[38;5;241m&[39mcontents).ok())[38;5;250m [39m{
    97           : [38;5;250m    [39m[38;5;66;03m// Do not propagate errors since meta info is not needed for operation[39;00m
    98           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m;
[91mâ†’   99 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  100 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39mBlock[38;5;241m*[39m[38;5;250m [39mmeta[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mBlock(contents);[0m
[91mâ†’  101 [2136 â†’ 2131]:[0m [91m[0m
   102           : [38;5;250m  [39mIterator[38;5;241m*[39m[38;5;250m [39miter[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmeta[38;5;241m-[39m[38;5;241m>[39mNewIterator(BytewiseComparator());
   103           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mkey[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mfilter.[39m[38;5;124m"[39m;
   104           : [38;5;250m  [39mkey.append(rep_[38;5;241m-[39m[38;5;241m>[39moptions.filter_policy[38;5;241m-[39m[38;5;241m>[39mName());
   105           : [38;5;250m  [39miter[38;5;241m-[39m[38;5;241m>[39mSeek(key);
[91mâ†’  106 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(iter[38;5;241m-[39m[38;5;241m>[39mValid()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39miter[38;5;241m-[39m[38;5;241m>[39mkey()[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mSlice(key))[38;5;250m [39m{[0m
   107           : [38;5;250m    [39mReadFilter(iter[38;5;241m-[39m[38;5;241m>[39mvalue());
[91mâ†’  108 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
   109           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39miter;
   110           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mmeta;
   111           : }
   112           : 
[91mâ†’  113 [2136 â†’ 2131]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTable::ReadFilter[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mfilter_handle_value)[38;5;250m [39m{[0m
   114           : [38;5;250m  [39mSlice[38;5;250m [39mv[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfilter_handle_value;
   115           : [38;5;250m  [39mBlockHandle[38;5;250m [39mfilter_handle;
   116           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mfilter_handle.DecodeFrom([38;5;241m&[39mv).ok())[38;5;250m [39m{
   117           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m;
[91mâ†’  118 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
   119           : 
   120           : [38;5;250m  [39m[38;5;66;03m// We might want to unify with ReadBlock() if we start[39;00m
[91mâ†’  121 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;66;03m// requiring checksum verification in Table::Open.[39;00m[0m
[91mâ†’  122 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39mReadOptions[38;5;250m [39mopt;[0m
[91mâ†’  123 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(rep_[38;5;241m-[39m[38;5;241m>[39moptions.paranoid_checks)[38;5;250m [39m{[0m
   124           : [38;5;250m    [39mopt.verify_checksums[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  125 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
   126           : [38;5;250m  [39mBlockContents[38;5;250m [39mblock;
   127           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mReadBlock(rep_[38;5;241m-[39m[38;5;241m>[39mfile,[38;5;250m [39mopt,[38;5;250m [39mfilter_handle,[38;5;250m [39m[38;5;241m&[39mblock).ok())[38;5;250m [39m{
   128           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m;
[91mâ†’  129 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
   130           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(block.heap_allocated)[38;5;250m [39m{
   131           : [38;5;250m    [39mrep_[38;5;241m-[39m[38;5;241m>[39mfilter_data[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mblock.data.data();[38;5;250m  [39m[38;5;66;03m// Will need to delete later[39;00m
[91mâ†’  132 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
   133           : [38;5;250m  [39mrep_[38;5;241m-[39m[38;5;241m>[39mfilter[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mFilterBlockReader(rep_[38;5;241m-[39m[38;5;241m>[39moptions.filter_policy,[38;5;250m [39mblock.data);
   134           : }
   135           : 
   136           : Table[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mTable()[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mrep_;[38;5;250m [39m}
   137           : 
[91mâ†’  138 [2597 â†’ 2590]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDeleteBlock[39m([38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mignored)[38;5;250m [39m{[0m
   139           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mBlock[38;5;241m*[39m[38;5;241m>[39m(arg);
   140           : }
   141           : 
   142           : [38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mDeleteCachedBlock[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mvalue)[38;5;250m [39m{
   143           : [38;5;250m  [39mBlock[38;5;241m*[39m[38;5;250m [39mblock[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mBlock[38;5;241m*[39m[38;5;241m>[39m(value);

........................................

   151           : }
   152           : 
   153           : [38;5;66;03m// Convert an index iterator value (i.e., an encoded BlockHandle)[39;00m
   154           : [38;5;66;03m// into an iterator over the contents of the corresponding block.[39;00m
   155           : Iterator[38;5;241m*[39m[38;5;250m [39mTable[38;5;241m:[39m[38;5;241m:[39mBlockReader([38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mReadOptions[38;5;241m&[39m[38;5;250m [39moptions,
[91mâ†’  156 [2597 â†’ 2590]:[0m [91m[38;5;250m                             [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mindex_value)[38;5;250m [39m{[0m
   157           : [38;5;250m  [39mTable[38;5;241m*[39m[38;5;250m [39mtable[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mTable[38;5;241m*[39m[38;5;241m>[39m(arg);
   158           : [38;5;250m  [39mCache[38;5;241m*[39m[38;5;250m [39mblock_cache[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mtable[38;5;241m-[39m[38;5;241m>[39mrep_[38;5;241m-[39m[38;5;241m>[39moptions.block_cache;
   159           : [38;5;250m  [39mBlock[38;5;241m*[39m[38;5;250m [39mblock[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
   160           : [38;5;250m  [39mCache[38;5;241m:[39m[38;5;241m:[39mHandle[38;5;241m*[39m[38;5;250m [39mcache_handle[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’  161 [2597 â†’ 2590]:[0m [91m[0m
   162           : [38;5;250m  [39mBlockHandle[38;5;250m [39mhandle;
   163           : [38;5;250m  [39mSlice[38;5;250m [39minput[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mindex_value;
   164           : [38;5;250m  [39mStatus[38;5;250m [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mhandle.DecodeFrom([38;5;241m&[39minput);
   165           : [38;5;250m  [39m[38;5;66;03m// We intentionally allow extra stuff in index_value so that we[39;00m
   166           : [38;5;250m  [39m[38;5;66;03m// can add more features in the future.[39;00m
[91mâ†’  167 [2597 â†’ 2590]:[0m [91m[0m
[91mâ†’  168 [2597 â†’ 2590]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   169           : [38;5;250m    [39mBlockContents[38;5;250m [39mcontents;
[91mâ†’  170 [2597 â†’ 2590]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(block_cache[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   171           : [38;5;250m      [39m[38;5;125mchar[39m[38;5;250m [39mcache_key_buffer[[38;5;241m16[39m];
   172           : [38;5;250m      [39mEncodeFixed64(cache_key_buffer,[38;5;250m [39mtable[38;5;241m-[39m[38;5;241m>[39mrep_[38;5;241m-[39m[38;5;241m>[39mcache_id);
   173           : [38;5;250m      [39mEncodeFixed64(cache_key_buffer[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m8[39m,[38;5;250m [39mhandle.offset());
   174           : [38;5;250m      [39mSlice[38;5;250m [39m[38;5;21mkey[39m(cache_key_buffer,[38;5;250m [39m[38;5;28;01msizeof[39;00m(cache_key_buffer));
   175           : [38;5;250m      [39mcache_handle[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mblock_cache[38;5;241m-[39m[38;5;241m>[39mLookup(key);
   176           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(cache_handle[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
   177           : [38;5;250m        [39mblock[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mBlock[38;5;241m*[39m[38;5;241m>[39m(block_cache[38;5;241m-[39m[38;5;241m>[39mValue(cache_handle));
[91mâ†’  178 [2597 â†’ 2590]:[0m [91m[38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   179           : [38;5;250m        [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mReadBlock(table[38;5;241m-[39m[38;5;241m>[39mrep_[38;5;241m-[39m[38;5;241m>[39mfile,[38;5;250m [39moptions,[38;5;250m [39mhandle,[38;5;250m [39m[38;5;241m&[39mcontents);
[91mâ†’  180 [2597 â†’ 2590]:[0m [91m[38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{[0m
   181           : [38;5;250m          [39mblock[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mBlock(contents);
   182           : [38;5;250m          [39m[38;5;28;01mif[39;00m[38;5;250m [39m(contents.cachable[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39moptions.fill_cache)[38;5;250m [39m{
   183           : [38;5;250m            [39mcache_handle[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mblock_cache[38;5;241m-[39m[38;5;241m>[39mInsert(key,[38;5;250m [39mblock,[38;5;250m [39mblock[38;5;241m-[39m[38;5;241m>[39msize(),
   184           : [38;5;250m                                               [39m[38;5;241m&[39mDeleteCachedBlock);
[91mâ†’  185 [2597 â†’ 2590]:[0m [91m[38;5;250m          [39m}[0m
   186           : [38;5;250m        [39m}
   187           : [38;5;250m      [39m}
   188           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   189           : [38;5;250m      [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mReadBlock(table[38;5;241m-[39m[38;5;241m>[39mrep_[38;5;241m-[39m[38;5;241m>[39mfile,[38;5;250m [39moptions,[38;5;250m [39mhandle,[38;5;250m [39m[38;5;241m&[39mcontents);
   190           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(s.ok())[38;5;250m [39m{
   191           : [38;5;250m        [39mblock[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mBlock(contents);
   192           : [38;5;250m      [39m}
[91mâ†’  193 [2597 â†’ 2590]:[0m [91m[38;5;250m    [39m}[0m
   194           : [38;5;250m  [39m}
[91mâ†’  195 [2597 â†’ 2590]:[0m [91m[0m
   196           : [38;5;250m  [39mIterator[38;5;241m*[39m[38;5;250m [39miter;
[91mâ†’  197 [2597 â†’ 2590]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(block[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   198           : [38;5;250m    [39miter[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mblock[38;5;241m-[39m[38;5;241m>[39mNewIterator(table[38;5;241m-[39m[38;5;241m>[39mrep_[38;5;241m-[39m[38;5;241m>[39moptions.comparator);
[91mâ†’  199 [2597 â†’ 2590]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(cache_handle[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   200           : [38;5;250m      [39miter[38;5;241m-[39m[38;5;241m>[39mRegisterCleanup([38;5;241m&[39mDeleteBlock,[38;5;250m [39mblock,[38;5;250m [39m[38;5;28;01mnullptr[39;00m);
   201           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   202           : [38;5;250m      [39miter[38;5;241m-[39m[38;5;241m>[39mRegisterCleanup([38;5;241m&[39mReleaseBlock,[38;5;250m [39mblock_cache,[38;5;250m [39mcache_handle);
[91mâ†’  203 [2597 â†’ 2590]:[0m [91m[38;5;250m    [39m}[0m
   204           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   205           : [38;5;250m    [39miter[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mNewErrorIterator(s);
[91mâ†’  206 [2597 â†’ 2590]:[0m [91m[38;5;250m  [39m}[0m
   207           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39miter;
   208           : }
   209           : 
[91mâ†’  210 [3874 â†’ 3866]:[0m [91mIterator[38;5;241m*[39m[38;5;250m [39m[38;5;21mTable::NewIterator[39m([38;5;28;01mconst[39;00m[38;5;250m [39mReadOptions[38;5;241m&[39m[38;5;250m [39moptions)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
   211           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mNewTwoLevelIterator(
   212           : [38;5;250m      [39mrep_[38;5;241m-[39m[38;5;241m>[39mindex_block[38;5;241m-[39m[38;5;241m>[39mNewIterator(rep_[38;5;241m-[39m[38;5;241m>[39moptions.comparator),
   213           : [38;5;250m      [39m[38;5;241m&[39mTable[38;5;241m:[39m[38;5;241m:[39mBlockReader,[38;5;250m [39m[38;5;28;01mconst_cast[39;00m[38;5;241m<[39mTable[38;5;241m*[39m[38;5;241m>[39m([38;5;28;01mthis[39;00m),[38;5;250m [39moptions);
   214           : }
   215           : 

=== File: /root/leveldb-fuzzing/leveldb-subtree/table/table_builder.cc ===
Lines with coverage differences:

Lines with different hit counts: 31, 32, 34, 66, 67, 69, 72, 73, 74, 94, 96, 97, 98, 100, 101, 102, 103, 104, 109, 110, 111, 113, 114, 118, 122, 125, 127, 128, 129, 130, 131, 132, 135, 136, 138, 141, 145, 147, 149, 152, 154, 170, 172, 178, 183, 190, 192, 198, 201, 202, 203, 206, 207, 210, 212, 213, 215, 216, 224, 228, 229, 230, 236, 240, 241, 248, 250

Detailed differences with context:
============================================================
    26           : [38;5;250m        [39moffset([38;5;241m0[39m),
    27           : [38;5;250m        [39mdata_block([38;5;241m&[39moptions),
    28           : [38;5;250m        [39mindex_block([38;5;241m&[39mindex_block_options),
    29           : [38;5;250m        [39mnum_entries([38;5;241m0[39m),
    30           : [38;5;250m        [39mclosed([38;5;28mfalse[39m),
[91mâ†’   31 [1698 â†’ 1696]:[0m [91m[38;5;250m        [39mfilter_block(opt.filter_policy[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[0m
[91mâ†’   32 [1698 â†’ 1696]:[0m [91m[38;5;250m                         [39m[38;5;241m?[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[0m
    33           : [38;5;250m                         [39m[38;5;241m:[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mFilterBlockBuilder(opt.filter_policy)),
[91mâ†’   34 [1698 â†’ 1696]:[0m [91m[38;5;250m        [39mpending_index_entry([38;5;28mfalse[39m)[38;5;250m [39m{[0m
    35           : [38;5;250m    [39mindex_block_options.block_restart_interval[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;
    36           : [38;5;250m  [39m}
    37           : 
    38           : [38;5;250m  [39mOptions[38;5;250m [39moptions;
    39           : [38;5;250m  [39mOptions[38;5;250m [39mindex_block_options;

........................................

    61           : 
    62           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mcompressed_output;
    63           : };
    64           : 
    65           : TableBuilder[38;5;241m:[39m[38;5;241m:[39mTableBuilder([38;5;28;01mconst[39;00m[38;5;250m [39mOptions[38;5;241m&[39m[38;5;250m [39moptions,[38;5;250m [39mWritableFile[38;5;241m*[39m[38;5;250m [39mfile)
[91mâ†’   66 [1698 â†’ 1696]:[0m [91m[38;5;250m    [39m[38;5;241m:[39m[38;5;250m [39mrep_([38;5;28;01mnew[39;00m[38;5;250m [39mRep(options,[38;5;250m [39mfile))[38;5;250m [39m{[0m
[91mâ†’   67 [1698 â†’ 1696]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(rep_[38;5;241m-[39m[38;5;241m>[39mfilter_block[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
    68           : [38;5;250m    [39mrep_[38;5;241m-[39m[38;5;241m>[39mfilter_block[38;5;241m-[39m[38;5;241m>[39mStartBlock([38;5;241m0[39m);
[91mâ†’   69 [1698 â†’ 1696]:[0m [91m[38;5;250m  [39m}[0m
    70           : }
    71           : 
[91mâ†’   72 [1698 â†’ 1696]:[0m [91mTableBuilder[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mTableBuilder()[38;5;250m [39m{[0m
[91mâ†’   73 [1698 â†’ 1696]:[0m [91m[38;5;250m  [39massert(rep_[38;5;241m-[39m[38;5;241m>[39mclosed);[38;5;250m  [39m[38;5;66;03m// Catch errors where caller forgot to call Finish()[39;00m[0m
[91mâ†’   74 [1698 â†’ 1696]:[0m [91m[38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mrep_[38;5;241m-[39m[38;5;241m>[39mfilter_block;[0m
    75           : [38;5;250m  [39m[38;5;28;01mdelete[39;00m[38;5;250m [39mrep_;
    76           : }
    77           : 
    78           : Status[38;5;250m [39m[38;5;21mTableBuilder::ChangeOptions[39m([38;5;28;01mconst[39;00m[38;5;250m [39mOptions[38;5;241m&[39m[38;5;250m [39moptions)[38;5;250m [39m{
    79           : [38;5;250m  [39m[38;5;66;03m// Note: if more fields are added to Options, update[39;00m

........................................

    89           : [38;5;250m  [39mrep_[38;5;241m-[39m[38;5;241m>[39mindex_block_options[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39moptions;
    90           : [38;5;250m  [39mrep_[38;5;241m-[39m[38;5;241m>[39mindex_block_options.block_restart_interval[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;
    91           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
    92           : }
    93           : 
[91mâ†’   94 [2324 â†’ 2303]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTableBuilder::Add[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
    95           : [38;5;250m  [39mRep[38;5;241m*[39m[38;5;250m [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mrep_;
[91mâ†’   96 [2324 â†’ 2303]:[0m [91m[38;5;250m  [39massert([38;5;241m![39mr[38;5;241m-[39m[38;5;241m>[39mclosed);[0m
[91mâ†’   97 [2324 â†’ 2303]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mok())[38;5;250m [39m[38;5;28;01mreturn[39;00m;[0m
[91mâ†’   98 [626 â†’ 607]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;241m-[39m[38;5;241m>[39mnum_entries[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
    99           : [38;5;250m    [39massert(r[38;5;241m-[39m[38;5;241m>[39moptions.comparator[38;5;241m-[39m[38;5;241m>[39mCompare(key,[38;5;250m [39mSlice(r[38;5;241m-[39m[38;5;241m>[39mlast_key))[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);
[91mâ†’  100 [2324 â†’ 2303]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  101 [2324 â†’ 2303]:[0m [91m[0m
[91mâ†’  102 [118 â†’ 114]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;241m-[39m[38;5;241m>[39mpending_index_entry)[38;5;250m [39m{[0m
[91mâ†’  103 [118 â†’ 114]:[0m [91m[38;5;250m    [39massert(r[38;5;241m-[39m[38;5;241m>[39mdata_block.empty());[0m
[91mâ†’  104 [118 â†’ 114]:[0m [91m[38;5;250m    [39mr[38;5;241m-[39m[38;5;241m>[39moptions.comparator[38;5;241m-[39m[38;5;241m>[39mFindShortestSeparator([38;5;241m&[39mr[38;5;241m-[39m[38;5;241m>[39mlast_key,[38;5;250m [39mkey);[0m
   105           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mhandle_encoding;
   106           : [38;5;250m    [39mr[38;5;241m-[39m[38;5;241m>[39mpending_handle.EncodeTo([38;5;241m&[39mhandle_encoding);
   107           : [38;5;250m    [39mr[38;5;241m-[39m[38;5;241m>[39mindex_block.Add(r[38;5;241m-[39m[38;5;241m>[39mlast_key,[38;5;250m [39mSlice(handle_encoding));
   108           : [38;5;250m    [39mr[38;5;241m-[39m[38;5;241m>[39mpending_index_entry[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’  109 [2324 â†’ 2303]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  110 [2324 â†’ 2303]:[0m [91m[0m
[91mâ†’  111 [2324 â†’ 2303]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;241m-[39m[38;5;241m>[39mfilter_block[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   112           : [38;5;250m    [39mr[38;5;241m-[39m[38;5;241m>[39mfilter_block[38;5;241m-[39m[38;5;241m>[39mAddKey(key);
[91mâ†’  113 [2324 â†’ 2303]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  114 [2324 â†’ 2303]:[0m [91m[0m
   115           : [38;5;250m  [39mr[38;5;241m-[39m[38;5;241m>[39mlast_key.assign(key.data(),[38;5;250m [39mkey.size());
   116           : [38;5;250m  [39mr[38;5;241m-[39m[38;5;241m>[39mnum_entries[38;5;241m+[39m[38;5;241m+[39m;
   117           : [38;5;250m  [39mr[38;5;241m-[39m[38;5;241m>[39mdata_block.Add(key,[38;5;250m [39mvalue);
[91mâ†’  118 [2324 â†’ 2303]:[0m [91m[0m
   119           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mestimated_block_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mr[38;5;241m-[39m[38;5;241m>[39mdata_block.CurrentSizeEstimate();
   120           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(estimated_block_size[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mr[38;5;241m-[39m[38;5;241m>[39moptions.block_size)[38;5;250m [39m{
   121           : [38;5;250m    [39mFlush();
[91mâ†’  122 [2324 â†’ 2303]:[0m [91m[38;5;250m  [39m}[0m
   123           : }
   124           : 
[91mâ†’  125 [2452 â†’ 2450]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTableBuilder::Flush[39m()[38;5;250m [39m{[0m
   126           : [38;5;250m  [39mRep[38;5;241m*[39m[38;5;250m [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mrep_;
[91mâ†’  127 [2452 â†’ 2450]:[0m [91m[38;5;250m  [39massert([38;5;241m![39mr[38;5;241m-[39m[38;5;241m>[39mclosed);[0m
[91mâ†’  128 [2452 â†’ 2450]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mok())[38;5;250m [39m[38;5;28;01mreturn[39;00m;[0m
[91mâ†’  129 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;241m-[39m[38;5;241m>[39mdata_block.empty())[38;5;250m [39m[38;5;28;01mreturn[39;00m;[0m
[91mâ†’  130 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39massert([38;5;241m![39mr[38;5;241m-[39m[38;5;241m>[39mpending_index_entry);[0m
[91mâ†’  131 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39mWriteBlock([38;5;241m&[39mr[38;5;241m-[39m[38;5;241m>[39mdata_block,[38;5;250m [39m[38;5;241m&[39mr[38;5;241m-[39m[38;5;241m>[39mpending_handle);[0m
[91mâ†’  132 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(ok())[38;5;250m [39m{[0m
   133           : [38;5;250m    [39mr[38;5;241m-[39m[38;5;241m>[39mpending_index_entry[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   134           : [38;5;250m    [39mr[38;5;241m-[39m[38;5;241m>[39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mr[38;5;241m-[39m[38;5;241m>[39mfile[38;5;241m-[39m[38;5;241m>[39mFlush();
[91mâ†’  135 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  136 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;241m-[39m[38;5;241m>[39mfilter_block[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   137           : [38;5;250m    [39mr[38;5;241m-[39m[38;5;241m>[39mfilter_block[38;5;241m-[39m[38;5;241m>[39mStartBlock(r[38;5;241m-[39m[38;5;241m>[39moffset);
[91mâ†’  138 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m}[0m
   139           : }
   140           : 
[91mâ†’  141 [5210 â†’ 5200]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTableBuilder::WriteBlock[39m(BlockBuilder[38;5;241m*[39m[38;5;250m [39mblock,[38;5;250m [39mBlockHandle[38;5;241m*[39m[38;5;250m [39mhandle)[38;5;250m [39m{[0m
   142           : [38;5;250m  [39m[38;5;66;03m// File format contains a sequence of blocks where each block has:[39;00m
   143           : [38;5;250m  [39m[38;5;66;03m//    block_data: uint8[n][39;00m
   144           : [38;5;250m  [39m[38;5;66;03m//    type: uint8[39;00m
[91mâ†’  145 [5210 â†’ 5200]:[0m [91m[38;5;250m  [39m[38;5;66;03m//    crc: uint32[39;00m[0m
   146           : [38;5;250m  [39massert(ok());
[91mâ†’  147 [5210 â†’ 5200]:[0m [91m[38;5;250m  [39mRep[38;5;241m*[39m[38;5;250m [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mrep_;[0m
   148           : [38;5;250m  [39mSlice[38;5;250m [39mraw[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mblock[38;5;241m-[39m[38;5;241m>[39mFinish();
[91mâ†’  149 [5210 â†’ 5200]:[0m [91m[0m
   150           : [38;5;250m  [39mSlice[38;5;250m [39mblock_contents;
   151           : [38;5;250m  [39mCompressionType[38;5;250m [39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mr[38;5;241m-[39m[38;5;241m>[39moptions.compression;
[91mâ†’  152 [5210 â†’ 5200]:[0m [91m[38;5;250m  [39m[38;5;66;03m// TODO(postrelease): Support more compression options: zlib?[39;00m[0m
   153           : [38;5;250m  [39m[38;5;28;01mswitch[39;00m[38;5;250m [39m(type)[38;5;250m [39m{
[91mâ†’  154 [5210 â†’ 5200]:[0m [91m[38;5;250m    [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkNoCompression[39m:[0m
   155           : [38;5;250m      [39mblock_contents[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mraw;
   156           : [38;5;250m      [39m[38;5;28;01mbreak[39;00m;
   157           : 
   158           : [38;5;250m    [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;88mkSnappyCompression[39m:[38;5;250m [39m{
   159           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mcompressed[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mr[38;5;241m-[39m[38;5;241m>[39mcompressed_output;

........................................

   165           : [38;5;250m        [39m[38;5;66;03m// store uncompressed form[39;00m
   166           : [38;5;250m        [39mblock_contents[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mraw;
   167           : [38;5;250m        [39mtype[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkNoCompression;
   168           : [38;5;250m      [39m}
   169           : [38;5;250m      [39m[38;5;28;01mbreak[39;00m;
[91mâ†’  170 [5210 â†’ 5200]:[0m [91m[38;5;250m    [39m}[0m
   171           : [38;5;250m  [39m}
[91mâ†’  172 [5210 â†’ 5200]:[0m [91m[38;5;250m  [39mWriteRawBlock(block_contents,[38;5;250m [39mtype,[38;5;250m [39mhandle);[0m
   173           : [38;5;250m  [39mr[38;5;241m-[39m[38;5;241m>[39mcompressed_output.clear();
   174           : [38;5;250m  [39mblock[38;5;241m-[39m[38;5;241m>[39mReset();
   175           : }
   176           : 
   177           : [38;5;125mvoid[39m[38;5;250m [39mTableBuilder[38;5;241m:[39m[38;5;241m:[39mWriteRawBlock([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mblock_contents,
[91mâ†’  178 [6907 â†’ 6895]:[0m [91m[38;5;250m                                 [39mCompressionType[38;5;250m [39mtype,[38;5;250m [39mBlockHandle[38;5;241m*[39m[38;5;250m [39mhandle)[38;5;250m [39m{[0m
   179           : [38;5;250m  [39mRep[38;5;241m*[39m[38;5;250m [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mrep_;
   180           : [38;5;250m  [39mhandle[38;5;241m-[39m[38;5;241m>[39mset_offset(r[38;5;241m-[39m[38;5;241m>[39moffset);
   181           : [38;5;250m  [39mhandle[38;5;241m-[39m[38;5;241m>[39mset_size(block_contents.size());
   182           : [38;5;250m  [39mr[38;5;241m-[39m[38;5;241m>[39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mr[38;5;241m-[39m[38;5;241m>[39mfile[38;5;241m-[39m[38;5;241m>[39mAppend(block_contents);
[91mâ†’  183 [6907 â†’ 6895]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;241m-[39m[38;5;241m>[39mstatus.ok())[38;5;250m [39m{[0m
   184           : [38;5;250m    [39m[38;5;125mchar[39m[38;5;250m [39mtrailer[kBlockTrailerSize];
   185           : [38;5;250m    [39mtrailer[[38;5;241m0[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mtype;
   186           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mcrc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc32c[38;5;241m:[39m[38;5;241m:[39mValue(block_contents.data(),[38;5;250m [39mblock_contents.size());
   187           : [38;5;250m    [39mcrc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc32c[38;5;241m:[39m[38;5;241m:[39mExtend(crc,[38;5;250m [39mtrailer,[38;5;250m [39m[38;5;241m1[39m);[38;5;250m  [39m[38;5;66;03m// Extend crc to cover block type[39;00m
   188           : [38;5;250m    [39mEncodeFixed32(trailer[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m,[38;5;250m [39mcrc32c[38;5;241m:[39m[38;5;241m:[39mMask(crc));
   189           : [38;5;250m    [39mr[38;5;241m-[39m[38;5;241m>[39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mr[38;5;241m-[39m[38;5;241m>[39mfile[38;5;241m-[39m[38;5;241m>[39mAppend(Slice(trailer,[38;5;250m [39mkBlockTrailerSize));
[91mâ†’  190 [6907 â†’ 6895]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;241m-[39m[38;5;241m>[39mstatus.ok())[38;5;250m [39m{[0m
   191           : [38;5;250m      [39mr[38;5;241m-[39m[38;5;241m>[39moffset[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mblock_contents.size()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkBlockTrailerSize;
[91mâ†’  192 [6907 â†’ 6895]:[0m [91m[38;5;250m    [39m}[0m
   193           : [38;5;250m  [39m}
   194           : }
   195           : 
   196           : Status[38;5;250m [39m[38;5;21mTableBuilder::status[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mrep_[38;5;241m-[39m[38;5;241m>[39mstatus;[38;5;250m [39m}
   197           : 
[91mâ†’  198 [1697 â†’ 1695]:[0m [91mStatus[38;5;250m [39m[38;5;21mTableBuilder::Finish[39m()[38;5;250m [39m{[0m
   199           : [38;5;250m  [39mRep[38;5;241m*[39m[38;5;250m [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mrep_;
   200           : [38;5;250m  [39mFlush();
[91mâ†’  201 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39massert([38;5;241m![39mr[38;5;241m-[39m[38;5;241m>[39mclosed);[0m
[91mâ†’  202 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39mr[38;5;241m-[39m[38;5;241m>[39mclosed[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;[0m
[91mâ†’  203 [1697 â†’ 1695]:[0m [91m[0m
   204           : [38;5;250m  [39mBlockHandle[38;5;250m [39mfilter_block_handle,[38;5;250m [39mmetaindex_block_handle,[38;5;250m [39mindex_block_handle;
   205           : 
[91mâ†’  206 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Write filter block[39;00m[0m
[91mâ†’  207 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(ok()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mr[38;5;241m-[39m[38;5;241m>[39mfilter_block[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   208           : [38;5;250m    [39mWriteRawBlock(r[38;5;241m-[39m[38;5;241m>[39mfilter_block[38;5;241m-[39m[38;5;241m>[39mFinish(),[38;5;250m [39mkNoCompression,
   209           : [38;5;250m                  [39m[38;5;241m&[39mfilter_block_handle);
[91mâ†’  210 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m}[0m
   211           : 
[91mâ†’  212 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Write metaindex block[39;00m[0m
[91mâ†’  213 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(ok())[38;5;250m [39m{[0m
   214           : [38;5;250m    [39mBlockBuilder[38;5;250m [39m[38;5;21mmeta_index_block[39m([38;5;241m&[39mr[38;5;241m-[39m[38;5;241m>[39moptions);
[91mâ†’  215 [1697 â†’ 1695]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;241m-[39m[38;5;241m>[39mfilter_block[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
[91mâ†’  216 [1697 â†’ 1695]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Add mapping from "filter.Name" to location of filter data[39;00m[0m
   217           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mkey[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m"[39m[38;5;124mfilter.[39m[38;5;124m"[39m;
   218           : [38;5;250m      [39mkey.append(r[38;5;241m-[39m[38;5;241m>[39moptions.filter_policy[38;5;241m-[39m[38;5;241m>[39mName());
   219           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mhandle_encoding;
   220           : [38;5;250m      [39mfilter_block_handle.EncodeTo([38;5;241m&[39mhandle_encoding);
   221           : [38;5;250m      [39mmeta_index_block.Add(key,[38;5;250m [39mhandle_encoding);
   222           : [38;5;250m    [39m}
   223           : 
[91mâ†’  224 [1697 â†’ 1695]:[0m [91m[38;5;250m    [39m[38;5;66;03m// TODO(postrelease): Add stats and other meta blocks[39;00m[0m
   225           : [38;5;250m    [39mWriteBlock([38;5;241m&[39mmeta_index_block,[38;5;250m [39m[38;5;241m&[39mmetaindex_block_handle);
   226           : [38;5;250m  [39m}
   227           : 
[91mâ†’  228 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Write index block[39;00m[0m
[91mâ†’  229 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(ok())[38;5;250m [39m{[0m
[91mâ†’  230 [1697 â†’ 1695]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;241m-[39m[38;5;241m>[39mpending_index_entry)[38;5;250m [39m{[0m
   231           : [38;5;250m      [39mr[38;5;241m-[39m[38;5;241m>[39moptions.comparator[38;5;241m-[39m[38;5;241m>[39mFindShortSuccessor([38;5;241m&[39mr[38;5;241m-[39m[38;5;241m>[39mlast_key);
   232           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mhandle_encoding;
   233           : [38;5;250m      [39mr[38;5;241m-[39m[38;5;241m>[39mpending_handle.EncodeTo([38;5;241m&[39mhandle_encoding);
   234           : [38;5;250m      [39mr[38;5;241m-[39m[38;5;241m>[39mindex_block.Add(r[38;5;241m-[39m[38;5;241m>[39mlast_key,[38;5;250m [39mSlice(handle_encoding));
   235           : [38;5;250m      [39mr[38;5;241m-[39m[38;5;241m>[39mpending_index_entry[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’  236 [1697 â†’ 1695]:[0m [91m[38;5;250m    [39m}[0m
   237           : [38;5;250m    [39mWriteBlock([38;5;241m&[39mr[38;5;241m-[39m[38;5;241m>[39mindex_block,[38;5;250m [39m[38;5;241m&[39mindex_block_handle);
   238           : [38;5;250m  [39m}
   239           : 
[91mâ†’  240 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Write footer[39;00m[0m
[91mâ†’  241 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(ok())[38;5;250m [39m{[0m
   242           : [38;5;250m    [39mFooter[38;5;250m [39mfooter;
   243           : [38;5;250m    [39mfooter.set_metaindex_handle(metaindex_block_handle);
   244           : [38;5;250m    [39mfooter.set_index_handle(index_block_handle);
   245           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mfooter_encoding;
   246           : [38;5;250m    [39mfooter.EncodeTo([38;5;241m&[39mfooter_encoding);
   247           : [38;5;250m    [39mr[38;5;241m-[39m[38;5;241m>[39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mr[38;5;241m-[39m[38;5;241m>[39mfile[38;5;241m-[39m[38;5;241m>[39mAppend(footer_encoding);
[91mâ†’  248 [1697 â†’ 1695]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(r[38;5;241m-[39m[38;5;241m>[39mstatus.ok())[38;5;250m [39m{[0m
   249           : [38;5;250m      [39mr[38;5;241m-[39m[38;5;241m>[39moffset[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mfooter_encoding.size();
[91mâ†’  250 [1697 â†’ 1695]:[0m [91m[38;5;250m    [39m}[0m
   251           : [38;5;250m  [39m}
   252           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mr[38;5;241m-[39m[38;5;241m>[39mstatus;
   253           : }
   254           : 
   255           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTableBuilder::Abandon[39m()[38;5;250m [39m{

=== File: /root/leveldb-fuzzing/leveldb-subtree/table/two_level_iterator.cc ===
Lines with coverage differences:

Lines with different hit counts: 32, 33, 34, 36, 37, 38, 40, 41, 46, 48, 52, 53, 89, 92, 103, 104, 105, 115, 116, 117, 118, 121, 122, 124, 125, 141, 142, 146, 147, 149, 151, 155, 159, 160, 167

Detailed differences with context:
============================================================
    27           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSeekToLast[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m;
    28           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mNext[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m;
    29           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPrev[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m;
    30           : 
    31           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mValid[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mdata_iter_.Valid();[38;5;250m [39m}
[91mâ†’   32 [3942 â†’ 3925]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mkey[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’   33 [3942 â†’ 3925]:[0m [91m[38;5;250m    [39massert(Valid());[0m
[91mâ†’   34 [3942 â†’ 3925]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mdata_iter_.key();[0m
    35           : [38;5;250m  [39m}
[91mâ†’   36 [3780 â†’ 3773]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mvalue[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’   37 [3780 â†’ 3773]:[0m [91m[38;5;250m    [39massert(Valid());[0m
[91mâ†’   38 [3780 â†’ 3773]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mdata_iter_.value();[0m
    39           : [38;5;250m  [39m}
[91mâ†’   40 [3726 â†’ 3718]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mstatus[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’   41 [3726 â†’ 3718]:[0m [91m[38;5;250m    [39m[38;5;66;03m// It'd be nice if status() returned a const Status& instead of a Status[39;00m[0m
    42           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mindex_iter_.status().ok())[38;5;250m [39m{
    43           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mindex_iter_.status();
    44           : [38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(data_iter_.iter()[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m![39mdata_iter_.status().ok())[38;5;250m [39m{
    45           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mdata_iter_.status();
[91mâ†’   46 [3726 â†’ 3718]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
    47           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus_;
[91mâ†’   48 [3726 â†’ 3718]:[0m [91m[38;5;250m    [39m}[0m
    49           : [38;5;250m  [39m}
    50           : 
    51           : [38;5;250m [39m[38;5;28;01mprivate[39;00m[38;5;241m:[39m
[91mâ†’   52 [3017 â†’ 3012]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSaveError[39m([38;5;28;01mconst[39;00m[38;5;250m [39mStatus[38;5;241m&[39m[38;5;250m [39ms)[38;5;250m [39m{[0m
[91mâ†’   53 [3017 â†’ 3012]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(status_.ok()[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m![39ms.ok())[38;5;250m [39mstatus_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39ms;[0m
    54           : [38;5;250m  [39m}
    55           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSkipEmptyDataBlocksForward[39m();
    56           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSkipEmptyDataBlocksBackward[39m();
    57           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mSetDataIterator[39m(Iterator[38;5;241m*[39m[38;5;250m [39mdata_iter);
    58           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mInitDataBlock[39m();

........................................

    84           : [38;5;250m  [39mInitDataBlock();
    85           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(data_iter_.iter()[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39mdata_iter_.Seek(target);
    86           : [38;5;250m  [39mSkipEmptyDataBlocksForward();
    87           : }
    88           : 
[91mâ†’   89 [2867 â†’ 2851]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTwoLevelIterator::SeekToFirst[39m()[38;5;250m [39m{[0m
    90           : [38;5;250m  [39mindex_iter_.SeekToFirst();
    91           : [38;5;250m  [39mInitDataBlock();
[91mâ†’   92 [2867 â†’ 2851]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(data_iter_.iter()[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39mdata_iter_.SeekToFirst();[0m
    93           : [38;5;250m  [39mSkipEmptyDataBlocksForward();
    94           : }
    95           : 
    96           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTwoLevelIterator::SeekToLast[39m()[38;5;250m [39m{
    97           : [38;5;250m  [39mindex_iter_.SeekToLast();

........................................

    98           : [38;5;250m  [39mInitDataBlock();
    99           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(data_iter_.iter()[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39mdata_iter_.SeekToLast();
   100           : [38;5;250m  [39mSkipEmptyDataBlocksBackward();
   101           : }
   102           : 
[91mâ†’  103 [3823 â†’ 3818]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTwoLevelIterator::Next[39m()[38;5;250m [39m{[0m
[91mâ†’  104 [3823 â†’ 3818]:[0m [91m[38;5;250m  [39massert(Valid());[0m
[91mâ†’  105 [3823 â†’ 3818]:[0m [91m[38;5;250m  [39mdata_iter_.Next();[0m
   106           : [38;5;250m  [39mSkipEmptyDataBlocksForward();
   107           : }
   108           : 
   109           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTwoLevelIterator::Prev[39m()[38;5;250m [39m{
   110           : [38;5;250m  [39massert(Valid());
   111           : [38;5;250m  [39mdata_iter_.Prev();
   112           : [38;5;250m  [39mSkipEmptyDataBlocksBackward();
   113           : }
   114           : 
[91mâ†’  115 [6690 â†’ 6669]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTwoLevelIterator::SkipEmptyDataBlocksForward[39m()[38;5;250m [39m{[0m
[91mâ†’  116 [5765 â†’ 5756]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(data_iter_.iter()[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39m[38;5;241m![39mdata_iter_.Valid())[38;5;250m [39m{[0m
[91mâ†’  117 [5765 â†’ 5756]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Move to next block[39;00m[0m
[91mâ†’  118 [2748 â†’ 2744]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mindex_iter_.Valid())[38;5;250m [39m{[0m
   119           : [38;5;250m      [39mSetDataIterator([38;5;28;01mnullptr[39;00m);
   120           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m;
[91mâ†’  121 [3017 â†’ 3012]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  122 [3017 â†’ 3012]:[0m [91m[38;5;250m    [39mindex_iter_.Next();[0m
   123           : [38;5;250m    [39mInitDataBlock();
[91mâ†’  124 [3017 â†’ 3012]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(data_iter_.iter()[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39mdata_iter_.SeekToFirst();[0m
[91mâ†’  125 [6690 â†’ 6669]:[0m [91m[38;5;250m  [39m}[0m
   126           : }
   127           : 
   128           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTwoLevelIterator::SkipEmptyDataBlocksBackward[39m()[38;5;250m [39m{
   129           : [38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(data_iter_.iter()[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39m[38;5;241m![39mdata_iter_.Valid())[38;5;250m [39m{
   130           : [38;5;250m    [39m[38;5;66;03m// Move to next block[39;00m

........................................

   136           : [38;5;250m    [39mInitDataBlock();
   137           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(data_iter_.iter()[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39mdata_iter_.SeekToLast();
   138           : [38;5;250m  [39m}
   139           : }
   140           : 
[91mâ†’  141 [8632 â†’ 8607]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTwoLevelIterator::SetDataIterator[39m(Iterator[38;5;241m*[39m[38;5;250m [39mdata_iter)[38;5;250m [39m{[0m
[91mâ†’  142 [8632 â†’ 8607]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(data_iter_.iter()[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39mSaveError(data_iter_.status());[0m
   143           : [38;5;250m  [39mdata_iter_.Set(data_iter);
   144           : }
   145           : 
[91mâ†’  146 [5884 â†’ 5863]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mTwoLevelIterator::InitDataBlock[39m()[38;5;250m [39m{[0m
[91mâ†’  147 [2748 â†’ 2744]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mindex_iter_.Valid())[38;5;250m [39m{[0m
   148           : [38;5;250m    [39mSetDataIterator([38;5;28;01mnullptr[39;00m);
[91mâ†’  149 [3136 â†’ 3119]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   150           : [38;5;250m    [39mSlice[38;5;250m [39mhandle[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mindex_iter_.value();
[91mâ†’  151 [3136 â†’ 3119]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(data_iter_.iter()[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
   152           : [38;5;250m        [39mhandle.compare(data_block_handle_)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   153           : [38;5;250m      [39m[38;5;66;03m// data_iter_ is already constructed with this iterator, so[39;00m
   154           : [38;5;250m      [39m[38;5;66;03m// no need to change anything[39;00m
[91mâ†’  155 [3136 â†’ 3119]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   156           : [38;5;250m      [39mIterator[38;5;241m*[39m[38;5;250m [39miter[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m([38;5;241m*[39mblock_function_)(arg_,[38;5;250m [39moptions_,[38;5;250m [39mhandle);
   157           : [38;5;250m      [39mdata_block_handle_.assign(handle.data(),[38;5;250m [39mhandle.size());
   158           : [38;5;250m      [39mSetDataIterator(iter);
[91mâ†’  159 [3136 â†’ 3119]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  160 [5884 â†’ 5863]:[0m [91m[38;5;250m  [39m}[0m
   161           : }
   162           : 
   163           : }[38;5;250m  [39m[38;5;66;03m// namespace[39;00m
   164           : 
   165           : Iterator[38;5;241m*[39m[38;5;250m [39mNewTwoLevelIterator(Iterator[38;5;241m*[39m[38;5;250m [39mindex_iter,
   166           : [38;5;250m                              [39mBlockFunction[38;5;250m [39mblock_function,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39marg,
[91mâ†’  167 [4955 â†’ 4936]:[0m [91m[38;5;250m                              [39m[38;5;28;01mconst[39;00m[38;5;250m [39mReadOptions[38;5;241m&[39m[38;5;250m [39moptions)[38;5;250m [39m{[0m
   168           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mTwoLevelIterator(index_iter,[38;5;250m [39mblock_function,[38;5;250m [39marg,[38;5;250m [39moptions);
   169           : }
   170           : 
   171           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/arena.cc ===
Lines with coverage differences:

Lines with different hit counts: 14, 15, 17, 20, 21, 23, 26, 28, 29, 31, 35, 38, 39, 43, 46, 50, 51, 53, 55, 58

Detailed differences with context:
============================================================
     9           : [38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mkBlockSize[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m4096[39m;
    10           : 
    11           : Arena[38;5;241m:[39m[38;5;241m:[39mArena()
    12           : [38;5;250m    [39m[38;5;241m:[39m[38;5;250m [39malloc_ptr_([38;5;28;01mnullptr[39;00m),[38;5;250m [39malloc_bytes_remaining_([38;5;241m0[39m),[38;5;250m [39mmemory_usage_([38;5;241m0[39m)[38;5;250m [39m{}
    13           : 
[91mâ†’   14 [3654 â†’ 3656]:[0m [91mArena[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mArena()[38;5;250m [39m{[0m
[91mâ†’   15 [4597 â†’ 4601]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mblocks_.size();[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    16           : [38;5;250m    [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mblocks_[i];
[91mâ†’   17 [3654 â†’ 3656]:[0m [91m[38;5;250m  [39m}[0m
    18           : }
    19           : 
[91mâ†’   20 [4597 â†’ 4601]:[0m [91m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mArena::AllocateFallback[39m([38;5;125msize_t[39m[38;5;250m [39mbytes)[38;5;250m [39m{[0m
[91mâ†’   21 [942 â†’ 944]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(bytes[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mkBlockSize[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39m[38;5;241m4[39m)[38;5;250m [39m{[0m
    22           : [38;5;250m    [39m[38;5;66;03m// Object is more than a quarter of our block size.  Allocate it separately[39;00m
[91mâ†’   23 [942 â†’ 944]:[0m [91m[38;5;250m    [39m[38;5;66;03m// to avoid wasting too much space in leftover bytes.[39;00m[0m
    24           : [38;5;250m    [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mAllocateNewBlock(bytes);
    25           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;
[91mâ†’   26 [3655 â†’ 3657]:[0m [91m[38;5;250m  [39m}[0m
    27           : 
[91mâ†’   28 [3655 â†’ 3657]:[0m [91m[38;5;250m  [39m[38;5;66;03m// We waste the remaining space in the current block.[39;00m[0m
[91mâ†’   29 [3655 â†’ 3657]:[0m [91m[38;5;250m  [39malloc_ptr_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mAllocateNewBlock(kBlockSize);[0m
    30           : [38;5;250m  [39malloc_bytes_remaining_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkBlockSize;
[91mâ†’   31 [3655 â†’ 3657]:[0m [91m[0m
    32           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39malloc_ptr_;
    33           : [38;5;250m  [39malloc_ptr_[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mbytes;
    34           : [38;5;250m  [39malloc_bytes_remaining_[38;5;250m [39m[38;5;241m-[39m[38;5;241m=[39m[38;5;250m [39mbytes;
[91mâ†’   35 [4597 â†’ 4601]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;[0m
    36           : }
    37           : 
[91mâ†’   38 [7433 â†’ 7437]:[0m [91m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mArena::AllocateAligned[39m([38;5;125msize_t[39m[38;5;250m [39mbytes)[38;5;250m [39m{[0m
[91mâ†’   39 [7433 â†’ 7437]:[0m [91m[38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39malign[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m([38;5;28;01msizeof[39;00m([38;5;125mvoid[39m[38;5;241m*[39m)[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m8[39m)[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m([38;5;125mvoid[39m[38;5;241m*[39m)[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;241m8[39m;[0m
    40           : [38;5;250m  [39m[38;5;28;01mstatic_assert[39;00m((align[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m(align[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m))[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m,
    41           : [38;5;250m                [39m[38;5;124m"[39m[38;5;124mPointer size should be a power of 2[39m[38;5;124m"[39m);
    42           : [38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39mcurrent_mod[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;125muintptr_t[39m[38;5;241m>[39m(alloc_ptr_)[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m(align[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m);
[91mâ†’   43 [7433 â†’ 7437]:[0m [91m[38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39mslop[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(current_mod[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39malign[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mcurrent_mod);[0m
    44           : [38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39mneeded[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbytes[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mslop;
    45           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mresult;
[91mâ†’   46 [3778 â†’ 3780]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(needed[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39malloc_bytes_remaining_)[38;5;250m [39m{[0m
    47           : [38;5;250m    [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39malloc_ptr_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mslop;
    48           : [38;5;250m    [39malloc_ptr_[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mneeded;
    49           : [38;5;250m    [39malloc_bytes_remaining_[38;5;250m [39m[38;5;241m-[39m[38;5;241m=[39m[38;5;250m [39mneeded;
[91mâ†’   50 [3655 â†’ 3657]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
[91mâ†’   51 [3655 â†’ 3657]:[0m [91m[38;5;250m    [39m[38;5;66;03m// AllocateFallback always returned aligned memory[39;00m[0m
    52           : [38;5;250m    [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mAllocateFallback(bytes);
[91mâ†’   53 [7433 â†’ 7437]:[0m [91m[38;5;250m  [39m}[0m
    54           : [38;5;250m  [39massert(([38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;125muintptr_t[39m[38;5;241m>[39m(result)[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m(align[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m))[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m);
[91mâ†’   55 [7433 â†’ 7437]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;[0m
    56           : }
    57           : 
[91mâ†’   58 [4597 â†’ 4601]:[0m [91m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mArena::AllocateNewBlock[39m([38;5;125msize_t[39m[38;5;250m [39mblock_bytes)[38;5;250m [39m{[0m
    59           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39m[38;5;125mchar[39m[block_bytes];
    60           : [38;5;250m  [39mblocks_.push_back(result);
    61           : [38;5;250m  [39mmemory_usage_.fetch_add(block_bytes[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;28;01msizeof[39;00m([38;5;125mchar[39m[38;5;241m*[39m),
    62           : [38;5;250m                          [39mstd[38;5;241m:[39m[38;5;241m:[39mmemory_order_relaxed);
    63           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/arena.h ===
Lines with coverage differences:

Lines with different hit counts: 33, 55, 58, 65, 66

Detailed differences with context:
============================================================
    28           : [38;5;250m  [39m[38;5;66;03m// Allocate memory with the normal alignment guarantees provided by malloc.[39;00m
    29           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mAllocateAligned[39m([38;5;125msize_t[39m[38;5;250m [39mbytes);
    30           : 
    31           : [38;5;250m  [39m[38;5;66;03m// Returns an estimate of the total memory usage of data allocated[39;00m
    32           : [38;5;250m  [39m[38;5;66;03m// by the arena.[39;00m
[91mâ†’   33 [4972 â†’ 4978]:[0m [91m[38;5;250m  [39m[38;5;125msize_t[39m[38;5;250m [39m[38;5;21mMemoryUsage[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
    34           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mmemory_usage_.load(std[38;5;241m:[39m[38;5;241m:[39mmemory_order_relaxed);
    35           : [38;5;250m  [39m}
    36           : 
    37           : [38;5;250m [39mprivate[38;5;241m:[39m
    38           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mAllocateFallback[39m([38;5;125msize_t[39m[38;5;250m [39mbytes);

........................................

    50           : [38;5;250m  [39m[38;5;66;03m// TODO(costan): This member is accessed via atomics, but the others are[39;00m
    51           : [38;5;250m  [39m[38;5;66;03m//               accessed without any locking. Is this OK?[39;00m
    52           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39matomic[38;5;241m<[39m[38;5;125msize_t[39m[38;5;241m>[39m[38;5;250m [39mmemory_usage_;
    53           : };
    54           : 
[91mâ†’   55 [3779 â†’ 3781]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mArena::Allocate[39m([38;5;125msize_t[39m[38;5;250m [39mbytes)[38;5;250m [39m{[0m
    56           : [38;5;250m  [39m[38;5;66;03m// The semantics of what to return are a bit messy if we allow[39;00m
    57           : [38;5;250m  [39m[38;5;66;03m// 0-byte allocations, so we disallow them here (we don't need[39;00m
[91mâ†’   58 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m[38;5;66;03m// them for our internal use).[39;00m[0m
    59           : [38;5;250m  [39massert(bytes[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);
    60           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(bytes[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39malloc_bytes_remaining_)[38;5;250m [39m{
    61           : [38;5;250m    [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39malloc_ptr_;
    62           : [38;5;250m    [39malloc_ptr_[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mbytes;
    63           : [38;5;250m    [39malloc_bytes_remaining_[38;5;250m [39m[38;5;241m-[39m[38;5;241m=[39m[38;5;250m [39mbytes;
    64           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;
[91mâ†’   65 [942 â†’ 944]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   66 [3779 â†’ 3781]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mAllocateFallback(bytes);[0m
    67           : }
    68           : 
    69           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m
    70           : 
    71           : [38;5;130m#[39m[38;5;130mendif  [39m[38;5;66;03m// STORAGE_LEVELDB_UTIL_ARENA_H_[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/bloom.cc ===
Lines with coverage differences:

Lines with different hit counts: 13, 28, 29, 33, 34, 35, 38, 43, 45, 48, 52, 53

Detailed differences with context:
============================================================
     8           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/hash.h"[39;00m
     9           : 
    10           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
    11           : 
    12           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m{
[91mâ†’   13 [2869 â†’ 2848]:[0m [91m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mBloomHash[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m{[0m
    14           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mHash(key.data(),[38;5;250m [39mkey.size(),[38;5;250m [39m[38;5;241m0xbc9f1d34[39m);
    15           : }
    16           : 
    17           : [38;5;28;01mclass[39;00m[38;5;250m [39m[38;5;21;01mBloomFilterPolicy[39;00m[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;250m [39mFilterPolicy[38;5;250m [39m{
    18           : [38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;241m:[39m

........................................

    23           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(k_[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m30[39m)[38;5;250m [39mk_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m30[39m;
    24           : [38;5;250m  [39m}
    25           : 
    26           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mName[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;124m"[39m[38;5;124mleveldb.BuiltinBloomFilter2[39m[38;5;124m"[39m;[38;5;250m [39m}
    27           : 
[91mâ†’   28 [1816 â†’ 1810]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mCreateFilter[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39mkeys,[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mn,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mdst)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’   29 [1816 â†’ 1810]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Compute bloom filter size (in both bits and bytes)[39;00m[0m
    30           : [38;5;250m    [39m[38;5;125msize_t[39m[38;5;250m [39mbits[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mn[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39mbits_per_key_;
    31           : 
    32           : [38;5;250m    [39m[38;5;66;03m// For small n, we can see a very high false positive rate.  Fix it[39;00m
[91mâ†’   33 [1816 â†’ 1810]:[0m [91m[38;5;250m    [39m[38;5;66;03m// by enforcing a minimum bloom filter length.[39;00m[0m
[91mâ†’   34 [1816 â†’ 1810]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(bits[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m64[39m)[38;5;250m [39mbits[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m64[39m;[0m
[91mâ†’   35 [1816 â†’ 1810]:[0m [91m[0m
    36           : [38;5;250m    [39m[38;5;125msize_t[39m[38;5;250m [39mbytes[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(bits[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m7[39m)[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39m[38;5;241m8[39m;
    37           : [38;5;250m    [39mbits[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbytes[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;241m8[39m;
[91mâ†’   38 [1816 â†’ 1810]:[0m [91m[0m
    39           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39minit_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdst[38;5;241m-[39m[38;5;241m>[39msize();
    40           : [38;5;250m    [39mdst[38;5;241m-[39m[38;5;241m>[39mresize(init_size[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mbytes,[38;5;250m [39m[38;5;241m0[39m);
    41           : [38;5;250m    [39mdst[38;5;241m-[39m[38;5;241m>[39mpush_back([38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mchar[39m[38;5;241m>[39m(k_));[38;5;250m  [39m[38;5;66;03m// Remember # of probes in filter[39;00m
    42           : [38;5;250m    [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39marray[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39m([38;5;241m*[39mdst)[init_size];
[91mâ†’   43 [2324 â†’ 2303]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mn;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    44           : [38;5;250m      [39m[38;5;66;03m// Use double-hashing to generate a sequence of hash values.[39;00m
[91mâ†’   45 [2324 â†’ 2303]:[0m [91m[38;5;250m      [39m[38;5;66;03m// See analysis in [Kirsch,Mitzenmacher 2006].[39;00m[0m
    46           : [38;5;250m      [39m[38;5;125muint32_t[39m[38;5;250m [39mh[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mBloomHash(keys[i]);
    47           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mdelta[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(h[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m17[39m)[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39m(h[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m15[39m);[38;5;250m  [39m[38;5;66;03m// Rotate right 17 bits[39;00m
[91mâ†’   48 [13944 â†’ 13818]:[0m [91m[38;5;250m      [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mj[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mj[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mk_;[38;5;250m [39mj[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    49           : [38;5;250m        [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mbitpos[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mh[38;5;250m [39m[38;5;241m%[39m[38;5;250m [39mbits;
    50           : [38;5;250m        [39marray[bitpos[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39m[38;5;241m8[39m][38;5;250m [39m[38;5;241m|[39m[38;5;241m=[39m[38;5;250m [39m([38;5;241m1[39m[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m(bitpos[38;5;250m [39m[38;5;241m%[39m[38;5;250m [39m[38;5;241m8[39m));
    51           : [38;5;250m        [39mh[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mdelta;
[91mâ†’   52 [2324 â†’ 2303]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’   53 [1816 â†’ 1810]:[0m [91m[38;5;250m    [39m}[0m
    54           : [38;5;250m  [39m}
    55           : 
    56           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mKeyMayMatch[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mbloom_filter)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
    57           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mlen[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbloom_filter.size();
    58           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(len[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m2[39m)[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/cache.cc ===
Lines with coverage differences:

Lines with different hit counts: 55, 57, 59, 60, 74, 78, 81, 83, 89, 90, 94, 97, 100, 114, 118, 207, 209, 210, 211, 212, 217, 221, 225, 226, 227, 228, 229, 230, 232, 233, 236, 239, 244, 245, 252, 255, 257, 261, 269, 271, 282, 283, 292, 300, 301, 302, 307, 308, 309, 310, 314, 315, 318, 344, 359, 363, 367, 371, 375, 378

Detailed differences with context:
============================================================
    50           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39min_cache;[38;5;250m     [39m[38;5;66;03m// Whether entry is in the cache.[39;00m
    51           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mrefs;[38;5;250m     [39m[38;5;66;03m// References, including cache reference, if present.[39;00m
    52           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mhash;[38;5;250m     [39m[38;5;66;03m// Hash of key(); used for fast sharding and comparisons[39;00m
    53           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;250m [39mkey_data[[38;5;241m1[39m];[38;5;250m  [39m[38;5;66;03m// Beginning of key[39;00m
    54           : 
[91mâ†’   55 [7110 â†’ 7099]:[0m [91m[38;5;250m  [39mSlice[38;5;250m [39m[38;5;21mkey[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
    56           : [38;5;250m    [39m[38;5;66;03m// next_ is only equal to this if the LRU handle is the list head of an[39;00m
[91mâ†’   57 [7110 â†’ 7099]:[0m [91m[38;5;250m    [39m[38;5;66;03m// empty list. List heads never have meaningful keys.[39;00m[0m
    58           : [38;5;250m    [39massert(next[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mthis[39;00m);
[91mâ†’   59 [7110 â†’ 7099]:[0m [91m[0m
[91mâ†’   60 [7110 â†’ 7099]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mSlice(key_data,[38;5;250m [39mkey_length);[0m
    61           : [38;5;250m  [39m}
    62           : };
    63           : 
    64           : [38;5;66;03m// We provide our own simple hash table since it removes a whole bunch[39;00m
    65           : [38;5;66;03m// of porting hacks and is also faster than some of the built-in hash[39;00m

........................................

    69           : [38;5;28;01mclass[39;00m[38;5;250m [39m[38;5;21;01mHandleTable[39;00m[38;5;250m [39m{
    70           : [38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;241m:[39m
    71           : [38;5;250m  [39mHandleTable()[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mlength_([38;5;241m0[39m),[38;5;250m [39melems_([38;5;241m0[39m),[38;5;250m [39mlist_([38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[38;5;250m [39mResize();[38;5;250m [39m}
    72           : [38;5;250m  [39m[38;5;241m~[39mHandleTable()[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mdelete[39;00m[][38;5;250m [39mlist_;[38;5;250m [39m}
    73           : 
[91mâ†’   74 [7016 â†’ 7001]:[0m [91m[38;5;250m  [39mLRUHandle[38;5;241m*[39m[38;5;250m [39m[38;5;21mLookup[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mhash)[38;5;250m [39m{[0m
    75           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;241m*[39mFindPointer(key,[38;5;250m [39mhash);
    76           : [38;5;250m  [39m}
    77           : 
[91mâ†’   78 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39mLRUHandle[38;5;241m*[39m[38;5;250m [39m[38;5;21mInsert[39m(LRUHandle[38;5;241m*[39m[38;5;250m [39mh)[38;5;250m [39m{[0m
    79           : [38;5;250m    [39mLRUHandle[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFindPointer(h[38;5;241m-[39m[38;5;241m>[39mkey(),[38;5;250m [39mh[38;5;241m-[39m[38;5;241m>[39mhash);
    80           : [38;5;250m    [39mLRUHandle[38;5;241m*[39m[38;5;250m [39mold[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m*[39mptr;
[91mâ†’   81 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39mh[38;5;241m-[39m[38;5;241m>[39mnext_hash[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(old[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mold[38;5;241m-[39m[38;5;241m>[39mnext_hash);[0m
    82           : [38;5;250m    [39m[38;5;241m*[39mptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mh;
[91mâ†’   83 [2134 â†’ 2130]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(old[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
    84           : [38;5;250m      [39m[38;5;241m+[39m[38;5;241m+[39melems_;
    85           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(elems_[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mlength_)[38;5;250m [39m{
    86           : [38;5;250m        [39m[38;5;66;03m// Since each cache entry is fairly large, we aim for a small[39;00m
    87           : [38;5;250m        [39m[38;5;66;03m// average linked list length (<= 1).[39;00m
    88           : [38;5;250m        [39mResize();
[91mâ†’   89 [2134 â†’ 2130]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’   90 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m}[0m
    91           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mold;
    92           : [38;5;250m  [39m}
    93           : 
[91mâ†’   94 [553 â†’ 556]:[0m [91m[38;5;250m  [39mLRUHandle[38;5;241m*[39m[38;5;250m [39m[38;5;21mRemove[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mhash)[38;5;250m [39m{[0m
    95           : [38;5;250m    [39mLRUHandle[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFindPointer(key,[38;5;250m [39mhash);
    96           : [38;5;250m    [39mLRUHandle[38;5;241m*[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m*[39mptr;
[91mâ†’   97 [553 â†’ 556]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(result[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
    98           : [38;5;250m      [39m[38;5;241m*[39mptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mresult[38;5;241m-[39m[38;5;241m>[39mnext_hash;
    99           : [38;5;250m      [39m[38;5;241m-[39m[38;5;241m-[39melems_;
[91mâ†’  100 [553 â†’ 556]:[0m [91m[38;5;250m    [39m}[0m
   101           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;
   102           : [38;5;250m  [39m}
   103           : 
   104           : [38;5;250m [39m[38;5;28;01mprivate[39;00m[38;5;241m:[39m
   105           : [38;5;250m  [39m[38;5;66;03m// The table consists of an array of buckets where each bucket is[39;00m

........................................

   109           : [38;5;250m  [39mLRUHandle[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mlist_;
   110           : 
   111           : [38;5;250m  [39m[38;5;66;03m// Return a pointer to slot that points to a cache entry that[39;00m
   112           : [38;5;250m  [39m[38;5;66;03m// matches key/hash.  If there is no such cache entry, return a[39;00m
   113           : [38;5;250m  [39m[38;5;66;03m// pointer to the trailing slot in the corresponding linked list.[39;00m
[91mâ†’  114 [9705 â†’ 9688]:[0m [91m[38;5;250m  [39mLRUHandle[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mFindPointer[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mhash)[38;5;250m [39m{[0m
   115           : [38;5;250m    [39mLRUHandle[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mlist_[hash[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m(length_[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m)];
   116           : [38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;241m*[39mptr[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39m(([38;5;241m*[39mptr)[38;5;241m-[39m[38;5;241m>[39mhash[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mhash[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39mkey[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m([38;5;241m*[39mptr)[38;5;241m-[39m[38;5;241m>[39mkey()))[38;5;250m [39m{
   117           : [38;5;250m      [39mptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39m([38;5;241m*[39mptr)[38;5;241m-[39m[38;5;241m>[39mnext_hash;
[91mâ†’  118 [9705 â†’ 9688]:[0m [91m[38;5;250m    [39m}[0m
   119           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mptr;
   120           : [38;5;250m  [39m}
   121           : 
   122           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mResize[39m()[38;5;250m [39m{
   123           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mnew_length[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m4[39m;

........................................

   202           : [38;5;250m  [39min_use_.prev[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39min_use_;
   203           : }
   204           : 
   205           : LRUCache[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mLRUCache()[38;5;250m [39m{
   206           : [38;5;250m  [39massert(in_use_.next[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39min_use_);[38;5;250m  [39m[38;5;66;03m// Error if caller has an unreleased handle[39;00m
[91mâ†’  207 [1581 â†’ 1574]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m(LRUHandle[38;5;241m*[39m[38;5;250m [39me[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlru_.next;[38;5;250m [39me[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mlru_;)[38;5;250m [39m{[0m
   208           : [38;5;250m    [39mLRUHandle[38;5;241m*[39m[38;5;250m [39mnext[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39me[38;5;241m-[39m[38;5;241m>[39mnext;
[91mâ†’  209 [1581 â†’ 1574]:[0m [91m[38;5;250m    [39massert(e[38;5;241m-[39m[38;5;241m>[39min_cache);[0m
[91mâ†’  210 [1581 â†’ 1574]:[0m [91m[38;5;250m    [39me[38;5;241m-[39m[38;5;241m>[39min_cache[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;[0m
[91mâ†’  211 [1581 â†’ 1574]:[0m [91m[38;5;250m    [39massert(e[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m);[38;5;250m  [39m[38;5;66;03m// Invariant of lru_ list.[39;00m[0m
[91mâ†’  212 [1581 â†’ 1574]:[0m [91m[38;5;250m    [39mUnref(e);[0m
   213           : [38;5;250m    [39me[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnext;
   214           : [38;5;250m  [39m}
   215           : }
   216           : 
[91mâ†’  217 [2283 â†’ 2280]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mLRUCache::Ref[39m(LRUHandle[38;5;241m*[39m[38;5;250m [39me)[38;5;250m [39m{[0m
   218           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(e[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39me[38;5;241m-[39m[38;5;241m>[39min_cache)[38;5;250m [39m{[38;5;250m  [39m[38;5;66;03m// If on lru_ list, move to in_use_ list.[39;00m
   219           : [38;5;250m    [39mLRU_Remove(e);
   220           : [38;5;250m    [39mLRU_Append([38;5;241m&[39min_use_,[38;5;250m [39me);
[91mâ†’  221 [2283 â†’ 2280]:[0m [91m[38;5;250m  [39m}[0m
   222           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;241m+[39m[38;5;241m+[39m;
   223           : }
   224           : 
[91mâ†’  225 [6555 â†’ 6542]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mLRUCache::Unref[39m(LRUHandle[38;5;241m*[39m[38;5;250m [39me)[38;5;250m [39m{[0m
[91mâ†’  226 [6555 â†’ 6542]:[0m [91m[38;5;250m  [39massert(e[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m);[0m
[91mâ†’  227 [6555 â†’ 6542]:[0m [91m[38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;241m-[39m[38;5;241m-[39m;[0m
[91mâ†’  228 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(e[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[38;5;250m  [39m[38;5;66;03m// Deallocate.[39;00m[0m
[91mâ†’  229 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39massert([38;5;241m![39me[38;5;241m-[39m[38;5;241m>[39min_cache);[0m
[91mâ†’  230 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m([38;5;241m*[39me[38;5;241m-[39m[38;5;241m>[39mdeleter)(e[38;5;241m-[39m[38;5;241m>[39mkey(),[38;5;250m [39me[38;5;241m-[39m[38;5;241m>[39mvalue);[0m
   231           : [38;5;250m    [39mfree(e);
[91mâ†’  232 [4353 â†’ 4349]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(e[38;5;241m-[39m[38;5;241m>[39min_cache[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39me[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m)[38;5;250m [39m{[0m
[91mâ†’  233 [4353 â†’ 4349]:[0m [91m[38;5;250m    [39m[38;5;66;03m// No longer in use; move to lru_ list.[39;00m[0m
   234           : [38;5;250m    [39mLRU_Remove(e);
   235           : [38;5;250m    [39mLRU_Append([38;5;241m&[39mlru_,[38;5;250m [39me);
[91mâ†’  236 [6555 â†’ 6542]:[0m [91m[38;5;250m  [39m}[0m
   237           : }
   238           : 
[91mâ†’  239 [7127 â†’ 7125]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mLRUCache::LRU_Remove[39m(LRUHandle[38;5;241m*[39m[38;5;250m [39me)[38;5;250m [39m{[0m
   240           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mnext[38;5;241m-[39m[38;5;241m>[39mprev[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39me[38;5;241m-[39m[38;5;241m>[39mprev;
   241           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mprev[38;5;241m-[39m[38;5;241m>[39mnext[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39me[38;5;241m-[39m[38;5;241m>[39mnext;
   242           : }
   243           : 
[91mâ†’  244 [8708 â†’ 8699]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mLRUCache::LRU_Append[39m(LRUHandle[38;5;241m*[39m[38;5;250m [39mlist,[38;5;250m [39mLRUHandle[38;5;241m*[39m[38;5;250m [39me)[38;5;250m [39m{[0m
[91mâ†’  245 [8708 â†’ 8699]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Make "e" newest entry by inserting just before *list[39;00m[0m
   246           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mnext[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlist;
   247           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mprev[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlist[38;5;241m-[39m[38;5;241m>[39mprev;
   248           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mprev[38;5;241m-[39m[38;5;241m>[39mnext[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39me;
   249           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mnext[38;5;241m-[39m[38;5;241m>[39mprev[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39me;
   250           : }
   251           : 
[91mâ†’  252 [7016 â†’ 7001]:[0m [91mCache[38;5;241m:[39m[38;5;241m:[39mHandle[38;5;241m*[39m[38;5;250m [39m[38;5;21mLRUCache::Lookup[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mhash)[38;5;250m [39m{[0m
   253           : [38;5;250m  [39mMutexLock[38;5;250m [39m[38;5;21ml[39m([38;5;241m&[39mmutex_);
   254           : [38;5;250m  [39mLRUHandle[38;5;241m*[39m[38;5;250m [39me[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mtable_.Lookup(key,[38;5;250m [39mhash);
[91mâ†’  255 [2283 â†’ 2280]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(e[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   256           : [38;5;250m    [39mRef(e);
[91mâ†’  257 [7016 â†’ 7001]:[0m [91m[38;5;250m  [39m}[0m
   258           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mCache[38;5;241m:[39m[38;5;241m:[39mHandle[38;5;241m*[39m[38;5;241m>[39m(e);
   259           : }
   260           : 
[91mâ†’  261 [4419 â†’ 4411]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mLRUCache::Release[39m(Cache[38;5;241m:[39m[38;5;241m:[39mHandle[38;5;241m*[39m[38;5;250m [39mhandle)[38;5;250m [39m{[0m
   262           : [38;5;250m  [39mMutexLock[38;5;250m [39m[38;5;21ml[39m([38;5;241m&[39mmutex_);
   263           : [38;5;250m  [39mUnref([38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mLRUHandle[38;5;241m*[39m[38;5;241m>[39m(handle));
   264           : }
   265           : 
   266           : Cache[38;5;241m:[39m[38;5;241m:[39mHandle[38;5;241m*[39m[38;5;250m [39mLRUCache[38;5;241m:[39m[38;5;241m:[39mInsert([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mhash,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mvalue,
   267           : [38;5;250m                                [39m[38;5;125msize_t[39m[38;5;250m [39mcharge,
   268           : [38;5;250m                                [39m[38;5;125mvoid[39m[38;5;250m [39m([38;5;241m*[39mdeleter)([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,
[91mâ†’  269 [2136 â†’ 2131]:[0m [91m[38;5;250m                                                [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mvalue))[38;5;250m [39m{[0m
   270           : [38;5;250m  [39mMutexLock[38;5;250m [39m[38;5;21ml[39m([38;5;241m&[39mmutex_);
[91mâ†’  271 [2136 â†’ 2131]:[0m [91m[0m
   272           : [38;5;250m  [39mLRUHandle[38;5;241m*[39m[38;5;250m [39me[38;5;250m [39m[38;5;241m=[39m
   273           : [38;5;250m      [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mLRUHandle[38;5;241m*[39m[38;5;241m>[39m(malloc([38;5;28;01msizeof[39;00m(LRUHandle)[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkey.size()));
   274           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mvalue[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mvalue;
   275           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mdeleter[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdeleter;
   276           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mcharge[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcharge;

........................................

   277           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mkey_length[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkey.size();
   278           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mhash[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mhash;
   279           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39min_cache[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
   280           : [38;5;250m  [39me[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;[38;5;250m  [39m[38;5;66;03m// for the returned handle.[39;00m
   281           : [38;5;250m  [39mmemcpy(e[38;5;241m-[39m[38;5;241m>[39mkey_data,[38;5;250m [39mkey.data(),[38;5;250m [39mkey.size());
[91mâ†’  282 [2136 â†’ 2131]:[0m [91m[0m
[91mâ†’  283 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(capacity_[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   284           : [38;5;250m    [39me[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;241m+[39m[38;5;241m+[39m;[38;5;250m  [39m[38;5;66;03m// for the cache's reference.[39;00m
   285           : [38;5;250m    [39me[38;5;241m-[39m[38;5;241m>[39min_cache[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   286           : [38;5;250m    [39mLRU_Append([38;5;241m&[39min_use_,[38;5;250m [39me);
   287           : [38;5;250m    [39musage_[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mcharge;
   288           : [38;5;250m    [39mFinishErase(table_.Insert(e));
   289           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[38;5;250m  [39m[38;5;66;03m// don't cache. (capacity_==0 is supported and turns off caching.)[39;00m
   290           : [38;5;250m    [39m[38;5;66;03m// next is read by key() in an assert, so it must be initialized[39;00m
   291           : [38;5;250m    [39me[38;5;241m-[39m[38;5;241m>[39mnext[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
[91mâ†’  292 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
   293           : [38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(usage_[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mcapacity_[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mlru_.next[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m&[39mlru_)[38;5;250m [39m{
   294           : [38;5;250m    [39mLRUHandle[38;5;241m*[39m[38;5;250m [39mold[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlru_.next;
   295           : [38;5;250m    [39massert(old[38;5;241m-[39m[38;5;241m>[39mrefs[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m);
   296           : [38;5;250m    [39m[38;5;125mbool[39m[38;5;250m [39merased[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFinishErase(table_.Remove(old[38;5;241m-[39m[38;5;241m>[39mkey(),[38;5;250m [39mold[38;5;241m-[39m[38;5;241m>[39mhash));
   297           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39merased)[38;5;250m [39m{[38;5;250m  [39m[38;5;66;03m// to avoid unused variable when compiled NDEBUG[39;00m
   298           : [38;5;250m      [39massert(erased);
   299           : [38;5;250m    [39m}
[91mâ†’  300 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  301 [2136 â†’ 2131]:[0m [91m[0m
[91mâ†’  302 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mCache[38;5;241m:[39m[38;5;241m:[39mHandle[38;5;241m*[39m[38;5;241m>[39m(e);[0m
   303           : }
   304           : 
   305           : [38;5;66;03m// If e != nullptr, finish removing *e from the cache; it has already been[39;00m
   306           : [38;5;66;03m// removed from the hash table.  Return whether e != nullptr.[39;00m
[91mâ†’  307 [2689 â†’ 2687]:[0m [91m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mLRUCache::FinishErase[39m(LRUHandle[38;5;241m*[39m[38;5;250m [39me)[38;5;250m [39m{[0m
[91mâ†’  308 [555 â†’ 557]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(e[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
[91mâ†’  309 [555 â†’ 557]:[0m [91m[38;5;250m    [39massert(e[38;5;241m-[39m[38;5;241m>[39min_cache);[0m
[91mâ†’  310 [555 â†’ 557]:[0m [91m[38;5;250m    [39mLRU_Remove(e);[0m
   311           : [38;5;250m    [39me[38;5;241m-[39m[38;5;241m>[39min_cache[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mfalse[39m;
   312           : [38;5;250m    [39musage_[38;5;250m [39m[38;5;241m-[39m[38;5;241m=[39m[38;5;250m [39me[38;5;241m-[39m[38;5;241m>[39mcharge;
   313           : [38;5;250m    [39mUnref(e);
[91mâ†’  314 [2689 â†’ 2687]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  315 [2689 â†’ 2687]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39me[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;[0m
   316           : }
   317           : 
[91mâ†’  318 [553 â†’ 556]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mLRUCache::Erase[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mhash)[38;5;250m [39m{[0m
   319           : [38;5;250m  [39mMutexLock[38;5;250m [39m[38;5;21ml[39m([38;5;241m&[39mmutex_);
   320           : [38;5;250m  [39mFinishErase(table_.Remove(key,[38;5;250m [39mhash));
   321           : }
   322           : 
   323           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mLRUCache::Prune[39m()[38;5;250m [39m{

........................................

   339           : [38;5;250m [39m[38;5;28;01mprivate[39;00m[38;5;241m:[39m
   340           : [38;5;250m  [39mLRUCache[38;5;250m [39mshard_[kNumShards];
   341           : [38;5;250m  [39mport[38;5;241m:[39m[38;5;241m:[39mMutex[38;5;250m [39mid_mutex_;
   342           : [38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39mlast_id_;
   343           : 
[91mâ†’  344 [9705 â†’ 9688]:[0m [91m[38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mHashSlice[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39ms)[38;5;250m [39m{[0m
   345           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mHash(s.data(),[38;5;250m [39ms.size(),[38;5;250m [39m[38;5;241m0[39m);
   346           : [38;5;250m  [39m}
   347           : 
   348           : [38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mShard[39m([38;5;125muint32_t[39m[38;5;250m [39mhash)[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mhash[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m([38;5;241m32[39m[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mkNumShardBits);[38;5;250m [39m}
   349           : 

........................................

   354           : [38;5;250m      [39mshard_[s].SetCapacity(per_shard);
   355           : [38;5;250m    [39m}
   356           : [38;5;250m  [39m}
   357           : [38;5;250m  [39m[38;5;241m~[39mShardedLRUCache()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{}
   358           : [38;5;250m  [39mHandle[38;5;241m*[39m[38;5;250m [39mInsert([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mvalue,[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mcharge,
[91mâ†’  359 [2136 â†’ 2131]:[0m [91m[38;5;250m                 [39m[38;5;125mvoid[39m[38;5;250m [39m([38;5;241m*[39mdeleter)([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey,[38;5;250m [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mvalue))[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   360           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mhash[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mHashSlice(key);
   361           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mshard_[Shard(hash)].Insert(key,[38;5;250m [39mhash,[38;5;250m [39mvalue,[38;5;250m [39mcharge,[38;5;250m [39mdeleter);
   362           : [38;5;250m  [39m}
[91mâ†’  363 [7016 â†’ 7001]:[0m [91m[38;5;250m  [39mHandle[38;5;241m*[39m[38;5;250m [39m[38;5;21mLookup[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   364           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mhash[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mHashSlice(key);
   365           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mshard_[Shard(hash)].Lookup(key,[38;5;250m [39mhash);
   366           : [38;5;250m  [39m}
[91mâ†’  367 [4419 â†’ 4411]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mRelease[39m(Handle[38;5;241m*[39m[38;5;250m [39mhandle)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   368           : [38;5;250m    [39mLRUHandle[38;5;241m*[39m[38;5;250m [39mh[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mLRUHandle[38;5;241m*[39m[38;5;241m>[39m(handle);
   369           : [38;5;250m    [39mshard_[Shard(h[38;5;241m-[39m[38;5;241m>[39mhash)].Release(handle);
   370           : [38;5;250m  [39m}
[91mâ†’  371 [553 â†’ 556]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mErase[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mkey)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   372           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mhash[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mHashSlice(key);
   373           : [38;5;250m    [39mshard_[Shard(hash)].Erase(key,[38;5;250m [39mhash);
   374           : [38;5;250m  [39m}
[91mâ†’  375 [4419 â†’ 4411]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mValue[39m(Handle[38;5;241m*[39m[38;5;250m [39mhandle)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   376           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39mLRUHandle[38;5;241m*[39m[38;5;241m>[39m(handle)[38;5;241m-[39m[38;5;241m>[39mvalue;
   377           : [38;5;250m  [39m}
[91mâ†’  378 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39m[38;5;21mNewId[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   379           : [38;5;250m    [39mMutexLock[38;5;250m [39m[38;5;21ml[39m([38;5;241m&[39mid_mutex_);
   380           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;241m+[39m[38;5;241m+[39m(last_id_);
   381           : [38;5;250m  [39m}
   382           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPrune[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   383           : [38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39ms[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39ms[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mkNumShards;[38;5;250m [39ms[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/coding.cc ===
Lines with coverage differences:

Lines with different hit counts: 9, 15, 21, 22, 25, 30, 45, 49, 55, 58, 61, 66, 72, 77, 79, 82, 87, 89, 92, 93, 95, 99, 100, 101, 104, 108, 110, 113, 116, 118, 121, 122, 124, 128, 130, 133, 139, 142

Detailed differences with context:
============================================================
     4           : 
     5           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"util/coding.h"[39;00m
     6           : 
     7           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
     8           : 
[91mâ†’    9 [4519453 â†’ 4538663]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPutFixed32[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mdst,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
    10           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;250m [39mbuf[[38;5;28;01msizeof[39;00m(value)];
    11           : [38;5;250m  [39mEncodeFixed32(buf,[38;5;250m [39mvalue);
    12           : [38;5;250m  [39mdst[38;5;241m-[39m[38;5;241m>[39mappend(buf,[38;5;250m [39m[38;5;28;01msizeof[39;00m(buf));
    13           : }
    14           : 
[91mâ†’   15 [9810 â†’ 9802]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPutFixed64[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mdst,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
    16           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;250m [39mbuf[[38;5;28;01msizeof[39;00m(value)];
    17           : [38;5;250m  [39mEncodeFixed64(buf,[38;5;250m [39mvalue);
    18           : [38;5;250m  [39mdst[38;5;241m-[39m[38;5;241m>[39mappend(buf,[38;5;250m [39m[38;5;28;01msizeof[39;00m(buf));
    19           : }
    20           : 
[91mâ†’   21 [63051 â†’ 62956]:[0m [91m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mEncodeVarint32[39m([38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mdst,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mv)[38;5;250m [39m{[0m
[91mâ†’   22 [63051 â†’ 62956]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Operate on characters as unsigneds[39;00m[0m
    23           : [38;5;250m  [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39mptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(dst);
    24           : [38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mB[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m128[39m;
[91mâ†’   25 [60622 â†’ 60525]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(v[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m([38;5;241m1[39m[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m7[39m))[38;5;250m [39m{[0m
    26           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv;
    27           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(v[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m([38;5;241m1[39m[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m14[39m))[38;5;250m [39m{
    28           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mB;
    29           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m7[39m;
[91mâ†’   30 [289 â†’ 291]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(v[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m([38;5;241m1[39m[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m21[39m))[38;5;250m [39m{[0m
    31           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mB;
    32           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(v[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m7[39m)[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mB;
    33           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m14[39m;
    34           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m[38;5;28;01mif[39;00m[38;5;250m [39m(v[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m([38;5;241m1[39m[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m28[39m))[38;5;250m [39m{
    35           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mB;

........................................

    40           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mB;
    41           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(v[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m7[39m)[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mB;
    42           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(v[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m14[39m)[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mB;
    43           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(v[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m21[39m)[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mB;
    44           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m28[39m;
[91mâ†’   45 [63051 â†’ 62956]:[0m [91m[38;5;250m  [39m}[0m
    46           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;241m>[39m(ptr);
    47           : }
    48           : 
[91mâ†’   49 [54336 â†’ 54238]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPutVarint32[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mdst,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mv)[38;5;250m [39m{[0m
    50           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;250m [39mbuf[[38;5;241m5[39m];
    51           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mEncodeVarint32(buf,[38;5;250m [39mv);
    52           : [38;5;250m  [39mdst[38;5;241m-[39m[38;5;241m>[39mappend(buf,[38;5;250m [39mptr[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mbuf);
    53           : }
    54           : 
[91mâ†’   55 [34595 â†’ 34560]:[0m [91m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mEncodeVarint64[39m([38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mdst,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mv)[38;5;250m [39m{[0m
    56           : [38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mB[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m128[39m;
    57           : [38;5;250m  [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39mptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(dst);
[91mâ†’   58 [13813 â†’ 13770]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(v[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mB)[38;5;250m [39m{[0m
    59           : [38;5;250m    [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mv[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mB;
    60           : [38;5;250m    [39mv[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m7[39m;
[91mâ†’   61 [34595 â†’ 34560]:[0m [91m[38;5;250m  [39m}[0m
    62           : [38;5;250m  [39m[38;5;241m*[39m(ptr[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(v);
    63           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;241m>[39m(ptr);
    64           : }
    65           : 
[91mâ†’   66 [34595 â†’ 34560]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPutVarint64[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mdst,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mv)[38;5;250m [39m{[0m
    67           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;250m [39mbuf[[38;5;241m10[39m];
    68           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mptr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mEncodeVarint64(buf,[38;5;250m [39mv);
    69           : [38;5;250m  [39mdst[38;5;241m-[39m[38;5;241m>[39mappend(buf,[38;5;250m [39mptr[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mbuf);
    70           : }
    71           : 
[91mâ†’   72 [11653 â†’ 11648]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPutLengthPrefixedSlice[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mdst,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
    73           : [38;5;250m  [39mPutVarint32(dst,[38;5;250m [39mvalue.size());
    74           : [38;5;250m  [39mdst[38;5;241m-[39m[38;5;241m>[39mappend(value.data(),[38;5;250m [39mvalue.size());
    75           : }
    76           : 
[91mâ†’   77 [7558 â†’ 7562]:[0m [91m[38;5;125mint[39m[38;5;250m [39m[38;5;21mVarintLength[39m([38;5;125muint64_t[39m[38;5;250m [39mv)[38;5;250m [39m{[0m
    78           : [38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39mlen[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;
[91mâ†’   79 [2663 â†’ 2669]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(v[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m128[39m)[38;5;250m [39m{[0m
    80           : [38;5;250m    [39mv[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m7[39m;
    81           : [38;5;250m    [39mlen[38;5;241m+[39m[38;5;241m+[39m;
[91mâ†’   82 [7558 â†’ 7562]:[0m [91m[38;5;250m  [39m}[0m
    83           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mlen;
    84           : }
    85           : 
    86           : [38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mGetVarint32PtrFallback([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mp,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mlimit,
[91mâ†’   87 [6248 â†’ 6243]:[0m [91m[38;5;250m                                   [39m[38;5;125muint32_t[39m[38;5;241m*[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
    88           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’   89 [12744 â†’ 12731]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125muint32_t[39m[38;5;250m [39mshift[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mshift[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m28[39m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mp[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mlimit;[38;5;250m [39mshift[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m7[39m)[38;5;250m [39m{[0m
    90           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mbyte[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m*[39m([38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(p));
    91           : [38;5;250m    [39mp[38;5;241m+[39m[38;5;241m+[39m;
[91mâ†’   92 [9377 â†’ 9367]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(byte[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m128[39m)[38;5;250m [39m{[0m
[91mâ†’   93 [9377 â†’ 9367]:[0m [91m[38;5;250m      [39m[38;5;66;03m// More bytes are present[39;00m[0m
    94           : [38;5;250m      [39mresult[38;5;250m [39m[38;5;241m|[39m[38;5;241m=[39m[38;5;250m [39m((byte[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m127[39m)[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39mshift);
[91mâ†’   95 [3367 â†’ 3364]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
    96           : [38;5;250m      [39mresult[38;5;250m [39m[38;5;241m|[39m[38;5;241m=[39m[38;5;250m [39m(byte[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39mshift);
    97           : [38;5;250m      [39m[38;5;241m*[39mvalue[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mresult;
    98           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;241m>[39m(p);
[91mâ†’   99 [12744 â†’ 12731]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  100 [2881 â†’ 2879]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  101 [6248 â†’ 6243]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;[0m
   102           : }
   103           : 
[91mâ†’  104 [22302 â†’ 22288]:[0m [91m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mGetVarint32[39m(Slice[38;5;241m*[39m[38;5;250m [39minput,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;241m*[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
   105           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minput[38;5;241m-[39m[38;5;241m>[39mdata();
   106           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mlimit[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mp[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39minput[38;5;241m-[39m[38;5;241m>[39msize();
   107           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mq[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetVarint32Ptr(p,[38;5;250m [39mlimit,[38;5;250m [39mvalue);
[91mâ†’  108 [2881 â†’ 2879]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(q[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   109           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’  110 [19421 â†’ 19409]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   111           : [38;5;250m    [39m[38;5;241m*[39minput[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(q,[38;5;250m [39mlimit[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mq);
   112           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  113 [22302 â†’ 22288]:[0m [91m[38;5;250m  [39m}[0m
   114           : }
   115           : 
[91mâ†’  116 [27904 â†’ 27848]:[0m [91m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mGetVarint64Ptr[39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mp,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mlimit,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;241m*[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
   117           : [38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’  118 [42834 â†’ 42700]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125muint32_t[39m[38;5;250m [39mshift[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mshift[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m63[39m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mp[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mlimit;[38;5;250m [39mshift[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m7[39m)[38;5;250m [39m{[0m
   119           : [38;5;250m    [39m[38;5;125muint64_t[39m[38;5;250m [39mbyte[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m*[39m([38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(p));
   120           : [38;5;250m    [39mp[38;5;241m+[39m[38;5;241m+[39m;
[91mâ†’  121 [14930 â†’ 14852]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(byte[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m128[39m)[38;5;250m [39m{[0m
[91mâ†’  122 [14930 â†’ 14852]:[0m [91m[38;5;250m      [39m[38;5;66;03m// More bytes are present[39;00m[0m
   123           : [38;5;250m      [39mresult[38;5;250m [39m[38;5;241m|[39m[38;5;241m=[39m[38;5;250m [39m((byte[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m127[39m)[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39mshift);
[91mâ†’  124 [27904 â†’ 27848]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   125           : [38;5;250m      [39mresult[38;5;250m [39m[38;5;241m|[39m[38;5;241m=[39m[38;5;250m [39m(byte[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39mshift);
   126           : [38;5;250m      [39m[38;5;241m*[39mvalue[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mresult;
   127           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;241m>[39m(p);
[91mâ†’  128 [42834 â†’ 42700]:[0m [91m[38;5;250m    [39m}[0m
   129           : [38;5;250m  [39m}
[91mâ†’  130 [27904 â†’ 27848]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;[0m
   131           : }
   132           : 
[91mâ†’  133 [27904 â†’ 27848]:[0m [91m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mGetVarint64[39m(Slice[38;5;241m*[39m[38;5;250m [39minput,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;241m*[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
   134           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39minput[38;5;241m-[39m[38;5;241m>[39mdata();
   135           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mlimit[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mp[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39minput[38;5;241m-[39m[38;5;241m>[39msize();
   136           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mq[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetVarint64Ptr(p,[38;5;250m [39mlimit,[38;5;250m [39mvalue);
   137           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(q[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
   138           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’  139 [27904 â†’ 27848]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   140           : [38;5;250m    [39m[38;5;241m*[39minput[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(q,[38;5;250m [39mlimit[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mq);
   141           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
[91mâ†’  142 [27904 â†’ 27848]:[0m [91m[38;5;250m  [39m}[0m
   143           : }
   144           : 
   145           : [38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mGetLengthPrefixedSlice([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mp,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mlimit,
   146           : [38;5;250m                                   [39mSlice[38;5;241m*[39m[38;5;250m [39mresult)[38;5;250m [39m{
   147           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mlen;

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/coding.h ===
Lines with coverage differences:

Lines with different hit counts: 54, 57, 64, 67, 81, 84, 91, 94, 109, 110, 112, 115, 116, 117

Detailed differences with context:
============================================================
    49           : [38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mEncodeVarint64[39m([38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mdst,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mvalue);
    50           : 
    51           : [38;5;66;03m// Lower-level versions of Put... that write directly into a character buffer[39;00m
    52           : [38;5;66;03m// REQUIRES: dst has enough space for the value being written[39;00m
    53           : 
[91mâ†’   54 [4779080 â†’ 4798372]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mEncodeFixed32[39m([38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mdst,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
    55           : [38;5;250m  [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mbuffer[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mreinterpret_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(dst);
    56           : 
[91mâ†’   57 [4779080 â†’ 4798372]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Recent clang and gcc optimize this to a single mov / str instruction.[39;00m[0m
    58           : [38;5;250m  [39mbuffer[[38;5;241m0[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(value);
    59           : [38;5;250m  [39mbuffer[[38;5;241m1[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(value[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m8[39m);
    60           : [38;5;250m  [39mbuffer[[38;5;241m2[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(value[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m16[39m);
    61           : [38;5;250m  [39mbuffer[[38;5;241m3[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(value[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m24[39m);
    62           : }
    63           : 
[91mâ†’   64 [29780 â†’ 29735]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mEncodeFixed64[39m([38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mdst,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
    65           : [38;5;250m  [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mbuffer[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mreinterpret_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(dst);
    66           : 
[91mâ†’   67 [29780 â†’ 29735]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Recent clang and gcc optimize this to a single mov / str instruction.[39;00m[0m
    68           : [38;5;250m  [39mbuffer[[38;5;241m0[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(value);
    69           : [38;5;250m  [39mbuffer[[38;5;241m1[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(value[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m8[39m);
    70           : [38;5;250m  [39mbuffer[[38;5;241m2[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(value[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m16[39m);
    71           : [38;5;250m  [39mbuffer[[38;5;241m3[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(value[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m24[39m);
    72           : [38;5;250m  [39mbuffer[[38;5;241m4[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(value[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m32[39m);

........................................

    76           : }
    77           : 
    78           : [38;5;66;03m// Lower-level versions of Get... that read directly from a character buffer[39;00m
    79           : [38;5;66;03m// without any bounds checking.[39;00m
    80           : 
[91mâ†’   81 [5744100683 â†’ 5749833296]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mDecodeFixed32[39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mptr)[38;5;250m [39m{[0m
    82           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mbuffer[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mreinterpret_cast[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(ptr);
    83           : 
[91mâ†’   84 [5744100683 â†’ 5749833296]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Recent clang and gcc optimize this to a single mov / ldr instruction.[39;00m[0m
    85           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(static_cast[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m(buffer[[38;5;241m0[39m]))[38;5;250m [39m[38;5;241m|[39m
    86           : [38;5;250m         [39m(static_cast[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m(buffer[[38;5;241m1[39m])[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m8[39m)[38;5;250m [39m[38;5;241m|[39m
    87           : [38;5;250m         [39m(static_cast[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m(buffer[[38;5;241m2[39m])[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m16[39m)[38;5;250m [39m[38;5;241m|[39m
    88           : [38;5;250m         [39m(static_cast[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m(buffer[[38;5;241m3[39m])[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m24[39m);
    89           : }
    90           : 
[91mâ†’   91 [47983 â†’ 47520]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39m[38;5;21mDecodeFixed64[39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mptr)[38;5;250m [39m{[0m
    92           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mbuffer[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mreinterpret_cast[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(ptr);
    93           : 
[91mâ†’   94 [47983 â†’ 47520]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Recent clang and gcc optimize this to a single mov / ldr instruction.[39;00m[0m
    95           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m(static_cast[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m(buffer[[38;5;241m0[39m]))[38;5;250m [39m[38;5;241m|[39m
    96           : [38;5;250m         [39m(static_cast[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m(buffer[[38;5;241m1[39m])[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m8[39m)[38;5;250m [39m[38;5;241m|[39m
    97           : [38;5;250m         [39m(static_cast[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m(buffer[[38;5;241m2[39m])[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m16[39m)[38;5;250m [39m[38;5;241m|[39m
    98           : [38;5;250m         [39m(static_cast[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m(buffer[[38;5;241m3[39m])[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m24[39m)[38;5;250m [39m[38;5;241m|[39m
    99           : [38;5;250m         [39m(static_cast[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m(buffer[[38;5;241m4[39m])[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m32[39m)[38;5;250m [39m[38;5;241m|[39m

........................................

   104           : 
   105           : [38;5;66;03m// Internal routine for use by fallback path of GetVarint32Ptr[39;00m
   106           : [38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mGetVarint32PtrFallback([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mp,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mlimit,
   107           : [38;5;250m                                   [39m[38;5;125muint32_t[39m[38;5;241m*[39m[38;5;250m [39mvalue);
   108           : [38;5;28;01minline[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mGetVarint32Ptr([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mp,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mlimit,
[91mâ†’  109 [51341 â†’ 51249]:[0m [91m[38;5;250m                                  [39m[38;5;125muint32_t[39m[38;5;241m*[39m[38;5;250m [39mvalue)[38;5;250m [39m{[0m
[91mâ†’  110 [48460 â†’ 48370]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(p[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mlimit)[38;5;250m [39m{[0m
   111           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m*[39m(reinterpret_cast[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(p));
[91mâ†’  112 [45094 â†’ 45007]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m((result[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m128[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   113           : [38;5;250m      [39m[38;5;241m*[39mvalue[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mresult;
   114           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mp[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m;
[91mâ†’  115 [48460 â†’ 48370]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  116 [6247 â†’ 6242]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  117 [51341 â†’ 51249]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mGetVarint32PtrFallback(p,[38;5;250m [39mlimit,[38;5;250m [39mvalue);[0m
   118           : }
   119           : 
   120           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m
   121           : 
   122           : [38;5;130m#[39m[38;5;130mendif  [39m[38;5;66;03m// STORAGE_LEVELDB_UTIL_CODING_H_[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/comparator.cc ===
Lines with coverage differences:

Lines with different hit counts: 27, 32, 33, 36, 39, 40, 41, 42, 43, 45, 46, 50, 51, 54, 55, 57, 59, 63, 64, 65, 70

Detailed differences with context:
============================================================
    22           : [38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;241m:[39m
    23           : [38;5;250m  [39mBytewiseComparatorImpl()[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mdefault[39;00m;
    24           : 
    25           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mName[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;124m"[39m[38;5;124mleveldb.BytewiseComparator[39m[38;5;124m"[39m;[38;5;250m [39m}
    26           : 
[91mâ†’   27 [51364 â†’ 51191]:[0m [91m[38;5;250m  [39m[38;5;125mint[39m[38;5;250m [39m[38;5;21mCompare[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39ma,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mb)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
    28           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ma.compare(b);
    29           : [38;5;250m  [39m}
    30           : 
    31           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39mFindShortestSeparator(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mstart,
[91mâ†’   32 [118 â†’ 114]:[0m [91m[38;5;250m                             [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mlimit)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’   33 [118 â†’ 114]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Find length of common prefix[39;00m[0m
    34           : [38;5;250m    [39m[38;5;125msize_t[39m[38;5;250m [39mmin_length[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmin(start[38;5;241m-[39m[38;5;241m>[39msize(),[38;5;250m [39mlimit.size());
    35           : [38;5;250m    [39m[38;5;125msize_t[39m[38;5;250m [39mdiff_index[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’   36 [141 â†’ 137]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m((diff_index[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mmin_length)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
    37           : [38;5;250m           [39m(([38;5;241m*[39mstart)[diff_index][38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mlimit[diff_index]))[38;5;250m [39m{
    38           : [38;5;250m      [39mdiff_index[38;5;241m+[39m[38;5;241m+[39m;
[91mâ†’   39 [118 â†’ 114]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   40 [118 â†’ 114]:[0m [91m[0m
[91mâ†’   41 [ 82 â†’  77]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(diff_index[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mmin_length)[38;5;250m [39m{[0m
[91mâ†’   42 [ 82 â†’  77]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Do not shorten if one string is a prefix of the other[39;00m[0m
[91mâ†’   43 [ 36 â†’  37]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
    44           : [38;5;250m      [39m[38;5;125muint8_t[39m[38;5;250m [39mdiff_byte[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(([38;5;241m*[39mstart)[diff_index]);
[91mâ†’   45 [ 36 â†’  37]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(diff_byte[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m([38;5;241m0xff[39m)[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[0m
[91mâ†’   46 [ 32 â†’  33]:[0m [91m[38;5;250m          [39mdiff_byte[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(limit[diff_index]))[38;5;250m [39m{[0m
    47           : [38;5;250m        [39m([38;5;241m*[39mstart)[diff_index][38;5;241m+[39m[38;5;241m+[39m;
    48           : [38;5;250m        [39mstart[38;5;241m-[39m[38;5;241m>[39mresize(diff_index[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m);
    49           : [38;5;250m        [39massert(Compare([38;5;241m*[39mstart,[38;5;250m [39mlimit)[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m);
[91mâ†’   50 [ 36 â†’  37]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’   51 [118 â†’ 114]:[0m [91m[38;5;250m    [39m}[0m
    52           : [38;5;250m  [39m}
    53           : 
[91mâ†’   54 [1697 â†’ 1695]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mFindShortSuccessor[39m(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m*[39m[38;5;250m [39mkey)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
[91mâ†’   55 [1697 â†’ 1695]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Find first character that can be incremented[39;00m[0m
    56           : [38;5;250m    [39m[38;5;125msize_t[39m[38;5;250m [39mn[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkey[38;5;241m-[39m[38;5;241m>[39msize();
[91mâ†’   57 [919 â†’ 915]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mn;[38;5;250m [39mi[38;5;241m+[39m[38;5;241m+[39m)[38;5;250m [39m{[0m
    58           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;250m [39mbyte[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m([38;5;241m*[39mkey)[i];
[91mâ†’   59 [790 â†’ 786]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(byte[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m([38;5;241m0xff[39m))[38;5;250m [39m{[0m
    60           : [38;5;250m        [39m([38;5;241m*[39mkey)[i][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbyte[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m;
    61           : [38;5;250m        [39mkey[38;5;241m-[39m[38;5;241m>[39mresize(i[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m);
    62           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m;
[91mâ†’   63 [919 â†’ 915]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’   64 [1697 â†’ 1695]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   65 [1697 â†’ 1695]:[0m [91m[38;5;250m    [39m[38;5;66;03m// *key is a run of 0xffs.  Leave it alone.[39;00m[0m
    66           : [38;5;250m  [39m}
    67           : };
    68           : }[38;5;250m  [39m[38;5;66;03m// namespace[39;00m
    69           : 
[91mâ†’   70 [6107 â†’ 6097]:[0m [91m[38;5;28;01mconst[39;00m[38;5;250m [39mComparator[38;5;241m*[39m[38;5;250m [39m[38;5;21mBytewiseComparator[39m()[38;5;250m [39m{[0m
    71           : [38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39mNoDestructor[38;5;241m<[39mBytewiseComparatorImpl[38;5;241m>[39m[38;5;250m [39msingleton;
    72           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39msingleton.get();
    73           : }
    74           : 
    75           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/crc32c.cc ===
Lines with coverage differences:

Lines with different hit counts: 249, 257, 276, 280, 281, 282, 286, 288, 291, 293, 295, 300, 302, 304, 305, 306, 307, 308, 310, 312, 314, 316, 318, 320, 323, 325, 326, 327, 328, 329, 330, 331, 332, 333, 344, 345, 346, 347, 349, 350, 351, 358, 360, 362, 363, 364, 365, 366, 368, 369, 370, 371

Detailed differences with context:
============================================================
   244           : 
   245           : [38;5;66;03m// CRCs are pre- and post- conditioned by xoring with all ones.[39;00m
   246           : [38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01mconstexpr[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mkCRC32Xor[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m([38;5;241m0xffffffffU[39m);
   247           : 
   248           : [38;5;66;03m// Reads a little-endian 32-bit integer from a 32-bit-aligned buffer.[39;00m
[91mâ†’  249 [5743938700 â†’ 5749670340]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mReadUint32LE[39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39mbuffer)[38;5;250m [39m{[0m
   250           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mDecodeFixed32([38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;241m>[39m(buffer));
   251           : }
   252           : 
   253           : [38;5;66;03m// Returns the smallest address >= the given address that is aligned to N bytes.[39;00m
   254           : [38;5;66;03m//[39;00m
   255           : [38;5;66;03m// N must be a power of two.[39;00m
   256           : [38;5;28;01mtemplate[39;00m[38;5;250m [39m[38;5;241m<[39m[38;5;125mint[39m[38;5;250m [39mN[38;5;241m>[39m
[91mâ†’  257 [384004 â†’ 385099]:[0m [91m[38;5;28;01mconstexpr[39;00m[38;5;250m [39m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mRoundUp[39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39mpointer)[38;5;250m [39m{[0m
   258           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(
   259           : [38;5;250m      [39m([38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;125muintptr_t[39m[38;5;241m>[39m(pointer)[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m(N[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m))[38;5;250m [39m[38;5;241m&[39m
   260           : [38;5;250m      [39m[38;5;241m~[39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muintptr_t[39m[38;5;241m>[39m(N[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m));
   261           : }
   262           : 

........................................

   271           : [38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mkTestCRCValue[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0xdcbc59fa[39m;
   272           : 
   273           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mport[38;5;241m:[39m[38;5;241m:[39mAcceleratedCRC32C([38;5;241m0[39m,[38;5;250m [39mkTestCRCBuffer,[38;5;250m [39mkBufSize)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mkTestCRCValue;
   274           : }
   275           : 
[91mâ†’  276 [384004 â†’ 385099]:[0m [91m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mExtend[39m([38;5;125muint32_t[39m[38;5;250m [39mcrc,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mdata,[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mn)[38;5;250m [39m{[0m
   277           : [38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39maccelerate[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mCanAccelerateCRC32C();
   278           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(accelerate)[38;5;250m [39m{
   279           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mport[38;5;241m:[39m[38;5;241m:[39mAcceleratedCRC32C(crc,[38;5;250m [39mdata,[38;5;250m [39mn);
[91mâ†’  280 [384004 â†’ 385099]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  281 [384004 â†’ 385099]:[0m [91m[0m
[91mâ†’  282 [384004 â†’ 385099]:[0m [91m[38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39mp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(data);[0m
   283           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39me[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mp[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mn;
   284           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39ml[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc[38;5;250m [39m[38;5;241m^[39m[38;5;250m [39mkCRC32Xor;
   285           : 
[91mâ†’  286 [384004 â†’ 385099]:[0m [91m[38;5;66;03m// Process one byte at a time.[39;00m[0m
   287           : [38;5;130m#[39m[38;5;130mdefine STEP1                              \[39m
[91mâ†’  288 [1015172 â†’ 1017353]:[0m [91m[38;5;250m  [39m[38;5;28;01mdo[39;00m[38;5;250m [39m{[38;5;250m                                     [39m\[0m
   289           : [38;5;250m    [39m[38;5;125mint[39m[38;5;250m [39mc[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(l[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m0xff[39m)[38;5;250m [39m[38;5;241m^[39m[38;5;250m [39m[38;5;241m*[39mp[38;5;241m+[39m[38;5;241m+[39m;[38;5;250m             [39m\
   290           : [38;5;250m    [39ml[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mkByteExtensionTable[c][38;5;250m [39m[38;5;241m^[39m[38;5;250m [39m(l[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m8[39m);[38;5;250m [39m\
[91mâ†’  291 [384004 â†’ 385099]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;241m0[39m)[0m
   292           : 
[91mâ†’  293 [384004 â†’ 385099]:[0m [91m[38;5;66;03m// Process one of the 4 strides of 4-byte data.[39;00m[0m
   294           : [38;5;130m#[39m[38;5;130mdefine STEP4(s)                                                               \[39m
[91mâ†’  295 [5742650199 â†’ 5748376772]:[0m [91m[38;5;250m  [39m[38;5;28;01mdo[39;00m[38;5;250m [39m{[38;5;250m                                                                         [39m\[0m
   296           : [38;5;250m    [39mcrc##s[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mReadUint32LE(p[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39ms[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;241m4[39m)[38;5;250m [39m[38;5;241m^[39m[38;5;250m [39mkStrideExtensionTable3[crc##s[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m0xff[39m][38;5;250m [39m[38;5;241m^[39m[38;5;250m [39m\
   297           : [38;5;250m             [39mkStrideExtensionTable2[(crc##s[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m8[39m)[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m0xff[39m][38;5;250m [39m[38;5;241m^[39m[38;5;250m                    [39m\
   298           : [38;5;250m             [39mkStrideExtensionTable1[(crc##s[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m16[39m)[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m0xff[39m][38;5;250m [39m[38;5;241m^[39m[38;5;250m                   [39m\
   299           : [38;5;250m             [39mkStrideExtensionTable0[crc##s[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m24[39m];[38;5;250m                             [39m\
[91mâ†’  300 [384004 â†’ 385099]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;241m0[39m)[0m
   301           : 
[91mâ†’  302 [384004 â†’ 385099]:[0m [91m[38;5;66;03m// Process a 16-byte swath of 4 strides, each of which has 4 bytes of data.[39;00m[0m
   303           : [38;5;130m#[39m[38;5;130mdefine STEP16 \[39m
[91mâ†’  304 [1435525506 â†’ 1436956589]:[0m [91m[38;5;250m  [39m[38;5;28;01mdo[39;00m[38;5;250m [39m{[38;5;250m         [39m\[0m
[91mâ†’  305 [1435525506 â†’ 1436956589]:[0m [91m[38;5;250m    [39mSTEP4([38;5;241m0[39m);[38;5;250m  [39m\[0m
[91mâ†’  306 [1435525506 â†’ 1436956589]:[0m [91m[38;5;250m    [39mSTEP4([38;5;241m1[39m);[38;5;250m  [39m\[0m
[91mâ†’  307 [1435525506 â†’ 1436956589]:[0m [91m[38;5;250m    [39mSTEP4([38;5;241m2[39m);[38;5;250m  [39m\[0m
[91mâ†’  308 [1435525506 â†’ 1436956589]:[0m [91m[38;5;250m    [39mSTEP4([38;5;241m3[39m);[38;5;250m  [39m\[0m
   309           : [38;5;250m    [39mp[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m16[39m;[38;5;250m   [39m\
[91mâ†’  310 [384004 â†’ 385099]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;241m0[39m)[0m
   311           : 
[91mâ†’  312 [384004 â†’ 385099]:[0m [91m[38;5;66;03m// Process 4 bytes that were already loaded into a word.[39;00m[0m
   313           : [38;5;130m#[39m[38;5;130mdefine STEP4W(w)                                   \[39m
[91mâ†’  314 [1371792 â†’ 1376220]:[0m [91m[38;5;250m  [39m[38;5;28;01mdo[39;00m[38;5;250m [39m{[38;5;250m                                              [39m\[0m
   315           : [38;5;250m    [39mw[38;5;250m [39m[38;5;241m^[39m[38;5;241m=[39m[38;5;250m [39ml;[38;5;250m                                         [39m\
[91mâ†’  316 [5487132 â†’ 5504832]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125msize_t[39m[38;5;250m [39mi[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39mi[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m4[39m;[38;5;250m [39m[38;5;241m+[39m[38;5;241m+[39mi)[38;5;250m [39m{[38;5;250m                [39m\[0m
   317           : [38;5;250m      [39mw[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(w[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m8[39m)[38;5;250m [39m[38;5;241m^[39m[38;5;250m [39mkByteExtensionTable[w[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m0xff[39m];[38;5;250m [39m\
[91mâ†’  318 [1371792 â†’ 1376220]:[0m [91m[38;5;250m    [39m}[38;5;250m                                               [39m\[0m
   319           : [38;5;250m    [39ml[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mw;[38;5;250m                                          [39m\
[91mâ†’  320 [384004 â†’ 385099]:[0m [91m[38;5;250m  [39m}[38;5;250m [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;241m0[39m)[0m
   321           : 
   322           : [38;5;250m  [39m[38;5;66;03m// Point x at first 4-byte aligned byte in the buffer. This might be past the[39;00m
[91mâ†’  323 [384004 â†’ 385099]:[0m [91m[38;5;250m  [39m[38;5;66;03m// end of the buffer.[39;00m[0m
   324           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39mx[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mRoundUp[38;5;241m<[39m[38;5;241m4[39m[38;5;241m>[39m(p);
[91mâ†’  325 [384003 â†’ 385098]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(x[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39me)[38;5;250m [39m{[0m
[91mâ†’  326 [384003 â†’ 385098]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Process bytes p is 4-byte aligned.[39;00m[0m
[91mâ†’  327 [573322 â†’ 575584]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(p[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mx)[38;5;250m [39m{[0m
[91mâ†’  328 [573322 â†’ 575584]:[0m [91m[38;5;250m      [39mSTEP1;[0m
[91mâ†’  329 [384003 â†’ 385098]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  330 [384004 â†’ 385099]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  331 [384004 â†’ 385099]:[0m [91m[0m
[91mâ†’  332 [342948 â†’ 344055]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m((e[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mp)[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m16[39m)[38;5;250m [39m{[0m
[91mâ†’  333 [342948 â†’ 344055]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Load a 16-byte swath into the stride partial results.[39;00m[0m
   334           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mcrc0[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mReadUint32LE(p[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;241m4[39m)[38;5;250m [39m[38;5;241m^[39m[38;5;250m [39ml;
   335           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mcrc1[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mReadUint32LE(p[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;241m4[39m);
   336           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mcrc2[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mReadUint32LE(p[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m2[39m[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;241m4[39m);
   337           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mcrc3[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mReadUint32LE(p[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m3[39m[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;241m4[39m);
   338           : [38;5;250m    [39mp[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m16[39m;

........................................

   339           : 
   340           : [38;5;250m    [39m[38;5;66;03m// It is possible to get better speeds (at least on x86) by interleaving[39;00m
   341           : [38;5;250m    [39m[38;5;66;03m// prefetching 256 bytes ahead with processing 64 bytes at a time. See the[39;00m
   342           : [38;5;250m    [39m[38;5;66;03m// portable implementation in https://github.com/google/crc32c/.[39;00m
   343           : 
[91mâ†’  344 [342948 â†’ 344055]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Process one 16-byte swath at a time.[39;00m[0m
[91mâ†’  345 [1435525506 â†’ 1436956589]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m((e[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mp)[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m16[39m)[38;5;250m [39m{[0m
[91mâ†’  346 [1435525506 â†’ 1436956589]:[0m [91m[38;5;250m      [39mSTEP16;[0m
[91mâ†’  347 [342948 â†’ 344055]:[0m [91m[38;5;250m    [39m}[0m
   348           : 
[91mâ†’  349 [342948 â†’ 344055]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Advance one word at a time as far as possible.[39;00m[0m
[91mâ†’  350 [548175 â†’ 550416]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m((e[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mp)[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m4[39m)[38;5;250m [39m{[0m
[91mâ†’  351 [548175 â†’ 550416]:[0m [91m[38;5;250m      [39mSTEP4([38;5;241m0[39m);[0m
   352           : [38;5;250m      [39m[38;5;125muint32_t[39m[38;5;250m [39mtmp[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc0;
   353           : [38;5;250m      [39mcrc0[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc1;
   354           : [38;5;250m      [39mcrc1[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc2;
   355           : [38;5;250m      [39mcrc2[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcrc3;
   356           : [38;5;250m      [39mcrc3[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mtmp;
   357           : [38;5;250m      [39mp[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m4[39m;
[91mâ†’  358 [342948 â†’ 344055]:[0m [91m[38;5;250m    [39m}[0m
   359           : 
[91mâ†’  360 [342948 â†’ 344055]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Combine the 4 partial stride results.[39;00m[0m
   361           : [38;5;250m    [39ml[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
[91mâ†’  362 [342948 â†’ 344055]:[0m [91m[38;5;250m    [39mSTEP4W(crc0);[0m
[91mâ†’  363 [342948 â†’ 344055]:[0m [91m[38;5;250m    [39mSTEP4W(crc1);[0m
[91mâ†’  364 [342948 â†’ 344055]:[0m [91m[38;5;250m    [39mSTEP4W(crc2);[0m
[91mâ†’  365 [342948 â†’ 344055]:[0m [91m[38;5;250m    [39mSTEP4W(crc3);[0m
[91mâ†’  366 [384004 â†’ 385099]:[0m [91m[38;5;250m  [39m}[0m
   367           : 
[91mâ†’  368 [384004 â†’ 385099]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Process the last few bytes.[39;00m[0m
[91mâ†’  369 [441850 â†’ 441769]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(p[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39me)[38;5;250m [39m{[0m
[91mâ†’  370 [441850 â†’ 441769]:[0m [91m[38;5;250m    [39mSTEP1;[0m
[91mâ†’  371 [384004 â†’ 385099]:[0m [91m[38;5;250m  [39m}[0m
   372           : [38;5;130m#[39m[38;5;130mundef STEP4W[39m
   373           : [38;5;130m#[39m[38;5;130mundef STEP16[39m
   374           : [38;5;130m#[39m[38;5;130mundef STEP4[39m
   375           : [38;5;130m#[39m[38;5;130mundef STEP1[39m
   376           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39ml[38;5;250m [39m[38;5;241m^[39m[38;5;250m [39mkCRC32Xor;

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/crc32c.h ===
Lines with coverage differences:

Lines with different hit counts: 29, 30, 35

Detailed differences with context:
============================================================
    24           : [38;5;66;03m// Return a masked representation of crc.[39;00m
    25           : [38;5;66;03m//[39;00m
    26           : [38;5;66;03m// Motivation: it is problematic to compute the CRC of a string that[39;00m
    27           : [38;5;66;03m// contains embedded CRCs.  Therefore we recommend that CRCs stored[39;00m
    28           : [38;5;66;03m// somewhere (e.g., in files) should be masked before being stored.[39;00m
[91mâ†’   29 [256902 â†’ 256888]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mMask[39m([38;5;125muint32_t[39m[38;5;250m [39mcrc)[38;5;250m [39m{[0m
[91mâ†’   30 [256902 â†’ 256888]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Rotate right by 15 bits and add a constant.[39;00m[0m
    31           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m((crc[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m15[39m)[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39m(crc[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m17[39m))[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkMaskDelta;
    32           : }
    33           : 
    34           : [38;5;66;03m// Return the crc whose masked representation is masked_crc.[39;00m
[91mâ†’   35 [90390 â†’ 91511]:[0m [91m[38;5;28;01minline[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mUnmask[39m([38;5;125muint32_t[39m[38;5;250m [39mmasked_crc)[38;5;250m [39m{[0m
    36           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mrot[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mmasked_crc[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mkMaskDelta;
    37           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m((rot[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m17[39m)[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39m(rot[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m15[39m));
    38           : }
    39           : 
    40           : }[38;5;250m  [39m[38;5;66;03m// namespace crc32c[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/env.cc ===
Lines with coverage differences:

Lines with different hit counts: 25, 26, 31

Detailed differences with context:
============================================================
    20           : 
    21           : Logger[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mLogger()[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mdefault[39;00m;
    22           : 
    23           : FileLock[38;5;241m:[39m[38;5;241m:[39m[38;5;241m~[39mFileLock()[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mdefault[39;00m;
    24           : 
[91mâ†’   25 [11210 â†’ 11204]:[0m [91m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mLog[39m(Logger[38;5;241m*[39m[38;5;250m [39minfo_log,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mformat,[38;5;250m [39m...)[38;5;250m [39m{[0m
[91mâ†’   26 [11210 â†’ 11204]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(info_log[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
    27           : [38;5;250m    [39m[38;5;125mva_list[39m[38;5;250m [39map;
    28           : [38;5;250m    [39mva_start(ap,[38;5;250m [39mformat);
    29           : [38;5;250m    [39minfo_log[38;5;241m-[39m[38;5;241m>[39mLogv(format,[38;5;250m [39map);
    30           : [38;5;250m    [39mva_end(ap);
[91mâ†’   31 [11210 â†’ 11204]:[0m [91m[38;5;250m  [39m}[0m
    32           : }
    33           : 
    34           : [38;5;28;01mstatic[39;00m[38;5;250m [39mStatus[38;5;250m [39mDoWriteStringToFile(Env[38;5;241m*[39m[38;5;250m [39menv,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mdata,
    35           : [38;5;250m                                  [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfname,[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39mshould_sync)[38;5;250m [39m{
    36           : [38;5;250m  [39mWritableFile[38;5;241m*[39m[38;5;250m [39mfile;

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/env_posix.cc ===
Lines with coverage differences:

Lines with different hit counts: 82, 85, 89, 114, 116, 124, 125, 126, 230, 236, 240, 241, 242, 243, 264, 268, 271, 275, 281, 283, 285, 286, 289, 291, 292, 296, 297, 300, 305, 312, 317, 321, 322, 323, 326, 327, 328, 332, 338, 339, 346, 347, 349, 350, 353, 355, 357, 358, 359, 362, 365, 366, 375, 385, 391, 392, 406, 410, 412, 413, 414, 415, 422, 426, 428, 429, 430, 431, 432, 436, 514, 519, 520, 521, 522, 526, 531, 532, 536, 537, 538, 540, 543, 549, 554, 559, 565, 566, 567, 568, 589, 594, 595, 596, 598, 603, 606, 607, 624, 629, 630, 631, 721, 796, 799, 804, 806, 807, 809, 810, 816, 819, 820, 822, 823, 824, 825, 828, 901

Detailed differences with context:
============================================================
    77           : [38;5;250m  [39mLimiter([38;5;28;01mconst[39;00m[38;5;250m [39mLimiter[38;5;241m&[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mdelete[39;00m;
    78           : [38;5;250m  [39mLimiter[38;5;250m [39m[38;5;28;01moperator[39;00m[38;5;241m=[39m([38;5;28;01mconst[39;00m[38;5;250m [39mLimiter[38;5;241m&[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mdelete[39;00m;
    79           : 
    80           : [38;5;250m  [39m[38;5;66;03m// If another resource is available, acquire it and return true.[39;00m
    81           : [38;5;250m  [39m[38;5;66;03m// Else return false.[39;00m
[91mâ†’   82 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mAcquire[39m()[38;5;250m [39m{[0m
    83           : [38;5;250m    [39m[38;5;125mint[39m[38;5;250m [39mold_acquires_allowed[38;5;250m [39m[38;5;241m=[39m
    84           : [38;5;250m        [39macquires_allowed_.fetch_sub([38;5;241m1[39m,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmemory_order_relaxed);
[91mâ†’   85 [2136 â†’ 2131]:[0m [91m[0m
    86           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(old_acquires_allowed[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mtrue[39m;
    87           : 
    88           : [38;5;250m    [39macquires_allowed_.fetch_add([38;5;241m1[39m,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmemory_order_relaxed);
[91mâ†’   89 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;[0m
    90           : [38;5;250m  [39m}
    91           : 
    92           : [38;5;250m  [39m[38;5;66;03m// Release a resource acquired by a previous call to Acquire() that returned[39;00m
    93           : [38;5;250m  [39m[38;5;66;03m// true.[39;00m
    94           : [38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mRelease[39m()[38;5;250m [39m{[38;5;250m [39macquires_allowed_.fetch_add([38;5;241m1[39m,[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmemory_order_relaxed);[38;5;250m [39m}

........................................

   109           : [38;5;250m [39m[38;5;28;01mpublic[39;00m[38;5;241m:[39m
   110           : [38;5;250m  [39mPosixSequentialFile(std[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mfilename,[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mfd)
   111           : [38;5;250m      [39m[38;5;241m:[39m[38;5;250m [39mfd_(fd),[38;5;250m [39mfilename_(filename)[38;5;250m [39m{}
   112           : [38;5;250m  [39m[38;5;241m~[39mPosixSequentialFile()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39mclose(fd_);[38;5;250m [39m}
   113           : 
[91mâ†’  114 [85802 â†’ 86946]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mRead[39m([38;5;125msize_t[39m[38;5;250m [39mn,[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39mresult,[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mscratch)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   115           : [38;5;250m    [39mStatus[38;5;250m [39mstatus;
[91mâ†’  116 [85802 â†’ 86946]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;28mtrue[39m)[38;5;250m [39m{[0m
   117           : [38;5;250m      [39m[38;5;241m:[39m[38;5;241m:[39m[38;5;125mssize_t[39m[38;5;250m [39mread_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mread(fd_,[38;5;250m [39mscratch,[38;5;250m [39mn);
   118           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(read_size[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[38;5;250m  [39m[38;5;66;03m// Read error.[39;00m
   119           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(errno[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mEINTR)[38;5;250m [39m{
   120           : [38;5;250m          [39m[38;5;28;01mcontinue[39;00m;[38;5;250m  [39m[38;5;66;03m// Retry[39;00m
   121           : [38;5;250m        [39m}
   122           : [38;5;250m        [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mPosixError(filename_,[38;5;250m [39merrno);
   123           : [38;5;250m        [39m[38;5;28;01mbreak[39;00m;
[91mâ†’  124 [85802 â†’ 86946]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  125 [85802 â†’ 86946]:[0m [91m[38;5;250m      [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(scratch,[38;5;250m [39mread_size);[0m
[91mâ†’  126 [85802 â†’ 86946]:[0m [91m[38;5;250m      [39m[38;5;28;01mbreak[39;00m;[0m
   127           : [38;5;250m    [39m}
   128           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
   129           : [38;5;250m  [39m}
   130           : 
   131           : [38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mSkip[39m([38;5;125muint64_t[39m[38;5;250m [39mn)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{

........................................

   225           : [38;5;250m      [39m[38;5;241m:[39m[38;5;250m [39mmmap_base_(mmap_base),
   226           : [38;5;250m        [39mlength_(length),
   227           : [38;5;250m        [39mmmap_limiter_(mmap_limiter),
   228           : [38;5;250m        [39mfilename_(std[38;5;241m:[39m[38;5;241m:[39mmove(filename))[38;5;250m [39m{}
   229           : 
[91mâ†’  230 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39m[38;5;241m~[39mPosixMmapReadableFile()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   231           : [38;5;250m    [39m[38;5;241m:[39m[38;5;241m:[39mmunmap([38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;241m>[39m(mmap_base_),[38;5;250m [39mlength_);
   232           : [38;5;250m    [39mmmap_limiter_[38;5;241m-[39m[38;5;241m>[39mRelease();
   233           : [38;5;250m  [39m}
   234           : 
   235           : [38;5;250m  [39mStatus[38;5;250m [39mRead([38;5;125muint64_t[39m[38;5;250m [39moffset,[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mn,[38;5;250m [39mSlice[38;5;241m*[39m[38;5;250m [39mresult,
[91mâ†’  236 [11141 â†’ 11114]:[0m [91m[38;5;250m              [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mscratch)[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   237           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(offset[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mn[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mlength_)[38;5;250m [39m{
   238           : [38;5;250m      [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice();
   239           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mPosixError(filename_,[38;5;250m [39mEINVAL);
[91mâ†’  240 [11141 â†’ 11114]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  241 [11141 â†’ 11114]:[0m [91m[0m
[91mâ†’  242 [11141 â†’ 11114]:[0m [91m[38;5;250m    [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSlice(mmap_base_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39moffset,[38;5;250m [39mn);[0m
[91mâ†’  243 [11141 â†’ 11114]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();[0m
   244           : [38;5;250m  [39m}
   245           : 
   246           : [38;5;250m  [39m[38;5;28;01mvirtual[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mGetName[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mfilename_;[38;5;250m [39m}
   247           : 
   248           : [38;5;250m [39m[38;5;28;01mprivate[39;00m[38;5;241m:[39m

........................................

   259           : [38;5;250m        [39mfd_(fd),
   260           : [38;5;250m        [39mis_manifest_(IsManifest(filename)),
   261           : [38;5;250m        [39mfilename_(std[38;5;241m:[39m[38;5;241m:[39mmove(filename)),
   262           : [38;5;250m        [39mdirname_(Dirname(filename_))[38;5;250m [39m{}
   263           : 
[91mâ†’  264 [10605 â†’ 10603]:[0m [91m[38;5;250m  [39m[38;5;241m~[39mPosixWritableFile()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   265           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(fd_[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   266           : [38;5;250m      [39m[38;5;66;03m// Ignoring any potential errors[39;00m
   267           : [38;5;250m      [39mClose();
[91mâ†’  268 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39m}[0m
   269           : [38;5;250m  [39m}
   270           : 
[91mâ†’  271 [518452 â†’ 518421]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mAppend[39m([38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mdata)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   272           : [38;5;250m    [39m[38;5;125msize_t[39m[38;5;250m [39mwrite_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdata.size();
   273           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mwrite_data[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdata.data();
   274           : 
[91mâ†’  275 [518452 â†’ 518421]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Fit as much as possible into buffer.[39;00m[0m
   276           : [38;5;250m    [39m[38;5;125msize_t[39m[38;5;250m [39mcopy_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mmin(write_size,[38;5;250m [39mkWritableFileBufferSize[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mpos_);
   277           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mmemcpy(buf_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mpos_,[38;5;250m [39mwrite_data,[38;5;250m [39mcopy_size);
   278           : [38;5;250m    [39mwrite_data[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mcopy_size;
   279           : [38;5;250m    [39mwrite_size[38;5;250m [39m[38;5;241m-[39m[38;5;241m=[39m[38;5;250m [39mcopy_size;
   280           : [38;5;250m    [39mpos_[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mcopy_size;
[91mâ†’  281 [517719 â†’ 517687]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(write_size[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   282           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
[91mâ†’  283 [733 â†’ 734]:[0m [91m[38;5;250m    [39m}[0m
   284           : 
[91mâ†’  285 [733 â†’ 734]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Can't fit in buffer, so need to do at least one write.[39;00m[0m
[91mâ†’  286 [733 â†’ 734]:[0m [91m[38;5;250m    [39mStatus[38;5;250m [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFlushBuffer();[0m
   287           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   288           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
[91mâ†’  289 [733 â†’ 734]:[0m [91m[38;5;250m    [39m}[0m
   290           : 
[91mâ†’  291 [733 â†’ 734]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Small writes go to buffer, large writes are written directly.[39;00m[0m
[91mâ†’  292 [ 16 â†’  15]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(write_size[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mkWritableFileBufferSize)[38;5;250m [39m{[0m
   293           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mmemcpy(buf_,[38;5;250m [39mwrite_data,[38;5;250m [39mwrite_size);
   294           : [38;5;250m      [39mpos_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mwrite_size;
   295           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
[91mâ†’  296 [717 â†’ 719]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  297 [733 â†’ 734]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mWriteUnbuffered(write_data,[38;5;250m [39mwrite_size);[0m
   298           : [38;5;250m  [39m}
   299           : 
[91mâ†’  300 [10605 â†’ 10603]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mClose[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   301           : [38;5;250m    [39mStatus[38;5;250m [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFlushBuffer();
   302           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mclose_result[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mclose(fd_);
   303           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(close_result[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mstatus.ok())[38;5;250m [39m{
   304           : [38;5;250m      [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mPosixError(filename_,[38;5;250m [39merrno);
[91mâ†’  305 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39m}[0m
   306           : [38;5;250m    [39mfd_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m-1[39m;
   307           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
   308           : [38;5;250m  [39m}
   309           : 
   310           : [38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mFlush[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mFlushBuffer();[38;5;250m [39m}
   311           : 
[91mâ†’  312 [7870 â†’ 7866]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mSync[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   313           : [38;5;250m    [39m[38;5;66;03m// Ensure new files referred to by the manifest are in the filesystem.[39;00m
   314           : [38;5;250m    [39m[38;5;66;03m//[39;00m
   315           : [38;5;250m    [39m[38;5;66;03m// This needs to happen before the manifest file is flushed to disk, to[39;00m
   316           : [38;5;250m    [39m[38;5;66;03m// avoid crashing in a state where the manifest refers to files that are not[39;00m
[91mâ†’  317 [7870 â†’ 7866]:[0m [91m[38;5;250m    [39m[38;5;66;03m// yet on disk.[39;00m[0m
   318           : [38;5;250m    [39mStatus[38;5;250m [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSyncDirIfManifest();
   319           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   320           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
[91mâ†’  321 [7870 â†’ 7866]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  322 [7870 â†’ 7866]:[0m [91m[0m
[91mâ†’  323 [7870 â†’ 7866]:[0m [91m[38;5;250m    [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mFlushBuffer();[0m
   324           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   325           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
[91mâ†’  326 [7870 â†’ 7866]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  327 [7870 â†’ 7866]:[0m [91m[0m
[91mâ†’  328 [7870 â†’ 7866]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mSyncFd(fd_,[38;5;250m [39mfilename_,[38;5;250m [39m[38;5;28mfalse[39m);[0m
   329           : [38;5;250m  [39m}
   330           : 
   331           : [38;5;250m [39m[38;5;28;01mprivate[39;00m[38;5;241m:[39m
[91mâ†’  332 [271018 â†’ 271006]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mFlushBuffer[39m()[38;5;250m [39m{[0m
   333           : [38;5;250m    [39mStatus[38;5;250m [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mWriteUnbuffered(buf_,[38;5;250m [39mpos_);
   334           : [38;5;250m    [39mpos_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
   335           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
   336           : [38;5;250m  [39m}
   337           : 
[91mâ†’  338 [271736 â†’ 271725]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mWriteUnbuffered[39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mdata,[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39msize)[38;5;250m [39m{[0m
[91mâ†’  339 [257904 â†’ 257897]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(size[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{[0m
   340           : [38;5;250m      [39m[38;5;125mssize_t[39m[38;5;250m [39mwrite_result[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mwrite(fd_,[38;5;250m [39mdata,[38;5;250m [39msize);
   341           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(write_result[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   342           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(errno[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mEINTR)[38;5;250m [39m{
   343           : [38;5;250m          [39m[38;5;28;01mcontinue[39;00m;[38;5;250m  [39m[38;5;66;03m// Retry[39;00m
   344           : [38;5;250m        [39m}
   345           : [38;5;250m        [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mPosixError(filename_,[38;5;250m [39merrno);
[91mâ†’  346 [257904 â†’ 257897]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  347 [257904 â†’ 257897]:[0m [91m[38;5;250m      [39mdata[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mwrite_result;[0m
   348           : [38;5;250m      [39msize[38;5;250m [39m[38;5;241m-[39m[38;5;241m=[39m[38;5;250m [39mwrite_result;
[91mâ†’  349 [271736 â†’ 271725]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  350 [271736 â†’ 271725]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();[0m
   351           : [38;5;250m  [39m}
   352           : 
[91mâ†’  353 [7870 â†’ 7866]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mSyncDirIfManifest[39m()[38;5;250m [39m{[0m
   354           : [38;5;250m    [39mStatus[38;5;250m [39mstatus;
[91mâ†’  355 [4697 â†’ 4695]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mis_manifest_)[38;5;250m [39m{[0m
   356           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
[91mâ†’  357 [3173 â†’ 3171]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  358 [3173 â†’ 3171]:[0m [91m[0m
[91mâ†’  359 [3173 â†’ 3171]:[0m [91m[38;5;250m    [39m[38;5;125mint[39m[38;5;250m [39mfd[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mopen(dirname_.c_str(),[38;5;250m [39mO_RDONLY[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mkOpenBaseFlags);[0m
   360           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(fd[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   361           : [38;5;250m      [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mPosixError(dirname_,[38;5;250m [39merrno);
[91mâ†’  362 [3173 â†’ 3171]:[0m [91m[38;5;250m    [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{[0m
   363           : [38;5;250m      [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mSyncFd(fd,[38;5;250m [39mdirname_,[38;5;250m [39m[38;5;28mtrue[39m);
   364           : [38;5;250m      [39m[38;5;241m:[39m[38;5;241m:[39mclose(fd);
[91mâ†’  365 [3173 â†’ 3171]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  366 [7870 â†’ 7866]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;[0m
   367           : [38;5;250m  [39m}
   368           : 
   369           : [38;5;250m  [39m[38;5;66;03m// Ensures that all the caches associated with the given file descriptor's[39;00m
   370           : [38;5;250m  [39m[38;5;66;03m// data are flushed all the way to durable media, and can withstand power[39;00m
   371           : [38;5;250m  [39m[38;5;66;03m// failures.[39;00m
   372           : [38;5;250m  [39m[38;5;66;03m//[39;00m
   373           : [38;5;250m  [39m[38;5;66;03m// The path argument is only used to populate the description string in the[39;00m
   374           : [38;5;250m  [39m[38;5;66;03m// returned Status if an error occurs.[39;00m
[91mâ†’  375 [11043 â†’ 11037]:[0m [91m[38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39mStatus[38;5;250m [39m[38;5;21mSyncFd[39m([38;5;125mint[39m[38;5;250m [39mfd,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfd_path,[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39msyncing_dir)[38;5;250m [39m{[0m
   376           : [38;5;130m#[39m[38;5;130mif HAVE_FULLFSYNC[39m
   377           : [38;5;250m    [39m[38;5;66;03m// On macOS and iOS, fsync() doesn't guarantee durability past power[39;00m
   378           : [38;5;250m    [39m[38;5;66;03m// failures. fcntl(F_FULLFSYNC) is required for that purpose. Some[39;00m
   379           : [38;5;250m    [39m[38;5;66;03m// filesystems don't support fcntl(F_FULLFSYNC), and require a fallback to[39;00m
   380           : [38;5;250m    [39m[38;5;66;03m// fsync().[39;00m
   381           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m:[39m[38;5;241m:[39mfcntl(fd,[38;5;250m [39mF_FULLFSYNC)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   382           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
   383           : [38;5;250m    [39m}
   384           : [38;5;130m#[39m[38;5;130mendif  [39m[38;5;66;03m// HAVE_FULLFSYNC[39;00m
[91mâ†’  385 [11043 â†’ 11037]:[0m [91m[0m
   386           : [38;5;130m#[39m[38;5;130mif HAVE_FDATASYNC[39m
   387           : [38;5;250m    [39m[38;5;125mbool[39m[38;5;250m [39msync_success[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mfdatasync(fd)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
   388           : [38;5;130m#[39m[38;5;130melse[39m
   389           : [38;5;250m    [39m[38;5;125mbool[39m[38;5;250m [39msync_success[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mfsync(fd)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
   390           : [38;5;130m#[39m[38;5;130mendif  [39m[38;5;66;03m// HAVE_FDATASYNC[39;00m
[91mâ†’  391 [11043 â†’ 11037]:[0m [91m[0m
[91mâ†’  392 [11043 â†’ 11037]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(sync_success)[38;5;250m [39m{[0m
   393           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
   394           : [38;5;250m    [39m}
   395           : [38;5;250m    [39m[38;5;66;03m// Do not crash if filesystem can't fsync directories[39;00m
   396           : [38;5;250m    [39m[38;5;66;03m// (see https://github.com/bitcoin/bitcoin/pull/10000)[39;00m
   397           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(syncing_dir[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39merrno[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mEINVAL)[38;5;250m [39m{

........................................

   401           : [38;5;250m  [39m}
   402           : 
   403           : [38;5;250m  [39m[38;5;66;03m// Returns the directory name in a path pointing to a file.[39;00m
   404           : [38;5;250m  [39m[38;5;66;03m//[39;00m
   405           : [38;5;250m  [39m[38;5;66;03m// Returns "." if the path does not contain any directory separator.[39;00m
[91mâ†’  406 [10605 â†’ 10603]:[0m [91m[38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mDirname[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename)[38;5;250m [39m{[0m
   407           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m:[39m[38;5;241m:[39msize_type[38;5;250m [39mseparator_pos[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfilename.rfind([38;5;124m'[39m[38;5;124m/[39m[38;5;124m'[39m);
   408           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(separator_pos[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m:[39m[38;5;241m:[39mnpos)[38;5;250m [39m{
   409           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring([38;5;124m"[39m[38;5;124m.[39m[38;5;124m"[39m);
[91mâ†’  410 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39m}[0m
   411           : [38;5;250m    [39m[38;5;66;03m// The filename component should not contain a path separator. If it does,[39;00m
[91mâ†’  412 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39m[38;5;66;03m// the splitting was done incorrectly.[39;00m[0m
[91mâ†’  413 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39massert(filename.find([38;5;124m'[39m[38;5;124m/[39m[38;5;124m'[39m,[38;5;250m [39mseparator_pos[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m:[39m[38;5;241m:[39mnpos);[0m
[91mâ†’  414 [10605 â†’ 10603]:[0m [91m[0m
[91mâ†’  415 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mfilename.substr([38;5;241m0[39m,[38;5;250m [39mseparator_pos);[0m
   416           : [38;5;250m  [39m}
   417           : 
   418           : [38;5;250m  [39m[38;5;66;03m// Extracts the file name from a path pointing to a file.[39;00m
   419           : [38;5;250m  [39m[38;5;66;03m//[39;00m
   420           : [38;5;250m  [39m[38;5;66;03m// The returned Slice points to |filename|'s data buffer, so it is only valid[39;00m
   421           : [38;5;250m  [39m[38;5;66;03m// while |filename| is alive and unchanged.[39;00m
[91mâ†’  422 [10605 â†’ 10603]:[0m [91m[38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39mSlice[38;5;250m [39m[38;5;21mBasename[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename)[38;5;250m [39m{[0m
   423           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m:[39m[38;5;241m:[39msize_type[38;5;250m [39mseparator_pos[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfilename.rfind([38;5;124m'[39m[38;5;124m/[39m[38;5;124m'[39m);
   424           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(separator_pos[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m:[39m[38;5;241m:[39mnpos)[38;5;250m [39m{
   425           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mSlice(filename);
[91mâ†’  426 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39m}[0m
   427           : [38;5;250m    [39m[38;5;66;03m// The filename component should not contain a path separator. If it does,[39;00m
[91mâ†’  428 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39m[38;5;66;03m// the splitting was done incorrectly.[39;00m[0m
[91mâ†’  429 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39massert(filename.find([38;5;124m'[39m[38;5;124m/[39m[38;5;124m'[39m,[38;5;250m [39mseparator_pos[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m:[39m[38;5;241m:[39mnpos);[0m
[91mâ†’  430 [10605 â†’ 10603]:[0m [91m[0m
[91mâ†’  431 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mSlice(filename.data()[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mseparator_pos[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m,[0m
[91mâ†’  432 [10605 â†’ 10603]:[0m [91m[38;5;250m                 [39mfilename.length()[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mseparator_pos[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m);[0m
   433           : [38;5;250m  [39m}
   434           : 
   435           : [38;5;250m  [39m[38;5;66;03m// True if the given file is a manifest file.[39;00m
[91mâ†’  436 [10605 â†’ 10603]:[0m [91m[38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mIsManifest[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename)[38;5;250m [39m{[0m
   437           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mBasename(filename).starts_with([38;5;124m"[39m[38;5;124mMANIFEST[39m[38;5;124m"[39m);
   438           : [38;5;250m  [39m}
   439           : 
   440           : [38;5;250m  [39m[38;5;28;01mvirtual[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mGetName[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mfilename_;[38;5;250m [39m}
   441           : 

........................................

   509           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mfwrite(msg,[38;5;250m [39m[38;5;241m1[39m,[38;5;250m [39m[38;5;28;01msizeof[39;00m(msg),[38;5;250m [39mstderr);
   510           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mabort();
   511           : [38;5;250m  [39m}
   512           : 
   513           : [38;5;250m  [39mStatus[38;5;250m [39mNewSequentialFile([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename,
[91mâ†’  514 [4519 â†’ 4521]:[0m [91m[38;5;250m                           [39mSequentialFile[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mresult)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   515           : [38;5;250m    [39m[38;5;125mint[39m[38;5;250m [39mfd[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mopen(filename.c_str(),[38;5;250m [39mO_RDONLY[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mkOpenBaseFlags);
   516           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(fd[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   517           : [38;5;250m      [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
   518           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mPosixError(filename,[38;5;250m [39merrno);
[91mâ†’  519 [4519 â†’ 4521]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  520 [4519 â†’ 4521]:[0m [91m[0m
[91mâ†’  521 [4519 â†’ 4521]:[0m [91m[38;5;250m    [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mPosixSequentialFile(filename,[38;5;250m [39mfd);[0m
[91mâ†’  522 [4519 â†’ 4521]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();[0m
   523           : [38;5;250m  [39m}
   524           : 
   525           : [38;5;250m  [39mStatus[38;5;250m [39mNewRandomAccessFile([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename,
[91mâ†’  526 [2136 â†’ 2131]:[0m [91m[38;5;250m                             [39mRandomAccessFile[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mresult)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   527           : [38;5;250m    [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
   528           : [38;5;250m    [39m[38;5;125mint[39m[38;5;250m [39mfd[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mopen(filename.c_str(),[38;5;250m [39mO_RDONLY[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mkOpenBaseFlags);
   529           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(fd[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   530           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mPosixError(filename,[38;5;250m [39merrno);
[91mâ†’  531 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  532 [2136 â†’ 2131]:[0m [91m[0m
   533           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mmmap_limiter_.Acquire())[38;5;250m [39m{
   534           : [38;5;250m      [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mPosixRandomAccessFile(filename,[38;5;250m [39mfd,[38;5;250m [39m[38;5;241m&[39mfd_limiter_);
   535           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
[91mâ†’  536 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  537 [2136 â†’ 2131]:[0m [91m[0m
[91mâ†’  538 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m[38;5;125muint64_t[39m[38;5;250m [39mfile_size;[0m
   539           : [38;5;250m    [39mStatus[38;5;250m [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mGetFileSize(filename,[38;5;250m [39m[38;5;241m&[39mfile_size);
[91mâ†’  540 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(status.ok())[38;5;250m [39m{[0m
   541           : [38;5;250m      [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mmmap_base[38;5;250m [39m[38;5;241m=[39m
   542           : [38;5;250m          [39m[38;5;241m:[39m[38;5;241m:[39mmmap([38;5;66;03m/*addr=*/[39;00m[38;5;28;01mnullptr[39;00m,[38;5;250m [39mfile_size,[38;5;250m [39mPROT_READ,[38;5;250m [39mMAP_SHARED,[38;5;250m [39mfd,[38;5;250m [39m[38;5;241m0[39m);
[91mâ†’  543 [2136 â†’ 2131]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(mmap_base[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mMAP_FAILED)[38;5;250m [39m{[0m
   544           : [38;5;250m        [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mPosixMmapReadableFile(filename,
   545           : [38;5;250m                                            [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;241m>[39m(mmap_base),
   546           : [38;5;250m                                            [39mfile_size,[38;5;250m [39m[38;5;241m&[39mmmap_limiter_);
   547           : [38;5;250m      [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
   548           : [38;5;250m        [39mstatus[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mPosixError(filename,[38;5;250m [39merrno);
[91mâ†’  549 [2136 â†’ 2131]:[0m [91m[38;5;250m      [39m}[0m
   550           : [38;5;250m    [39m}
   551           : [38;5;250m    [39m[38;5;241m:[39m[38;5;241m:[39mclose(fd);
   552           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstatus.ok())[38;5;250m [39m{
   553           : [38;5;250m      [39mmmap_limiter_.Release();
[91mâ†’  554 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m}[0m
   555           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mstatus;
   556           : [38;5;250m  [39m}
   557           : 
   558           : [38;5;250m  [39mStatus[38;5;250m [39mNewWritableFile([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename,
[91mâ†’  559 [10605 â†’ 10603]:[0m [91m[38;5;250m                         [39mWritableFile[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mresult)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   560           : [38;5;250m    [39m[38;5;125mint[39m[38;5;250m [39mfd[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mopen(filename.c_str(),
   561           : [38;5;250m                    [39mO_TRUNC[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mO_WRONLY[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mO_CREAT[38;5;250m [39m[38;5;241m|[39m[38;5;250m [39mkOpenBaseFlags,[38;5;250m [39m[38;5;241m0644[39m);
   562           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(fd[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   563           : [38;5;250m      [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m;
   564           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mPosixError(filename,[38;5;250m [39merrno);
[91mâ†’  565 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  566 [10605 â†’ 10603]:[0m [91m[0m
[91mâ†’  567 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mPosixWritableFile(filename,[38;5;250m [39mfd);[0m
[91mâ†’  568 [10605 â†’ 10603]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();[0m
   569           : [38;5;250m  [39m}
   570           : 
   571           : [38;5;250m  [39mStatus[38;5;250m [39mNewAppendableFile([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename,
   572           : [38;5;250m                           [39mWritableFile[38;5;241m*[39m[38;5;241m*[39m[38;5;250m [39mresult)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   573           : [38;5;250m    [39m[38;5;125mint[39m[38;5;250m [39mfd[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mopen(filename.c_str(),

........................................

   584           : [38;5;250m  [39m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mFileExists[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   585           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39maccess(filename.c_str(),[38;5;250m [39mF_OK)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
   586           : [38;5;250m  [39m}
   587           : 
   588           : [38;5;250m  [39mStatus[38;5;250m [39mGetChildren([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mdirectory_path,
[91mâ†’  589 [4978 â†’ 4976]:[0m [91m[38;5;250m                     [39mstd[38;5;241m:[39m[38;5;241m:[39mvector[38;5;241m<[39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m>[39m[38;5;241m*[39m[38;5;250m [39mresult)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   590           : [38;5;250m    [39mresult[38;5;241m-[39m[38;5;241m>[39mclear();
   591           : [38;5;250m    [39m[38;5;241m:[39m[38;5;241m:[39m[38;5;125mDIR[39m[38;5;241m*[39m[38;5;250m [39mdir[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mopendir(directory_path.c_str());
   592           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(dir[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{
   593           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mPosixError(directory_path,[38;5;250m [39merrno);
[91mâ†’  594 [4978 â†’ 4976]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  595 [4978 â†’ 4976]:[0m [91m[38;5;250m    [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mdirent[38;5;241m*[39m[38;5;250m [39mentry;[0m
[91mâ†’  596 [43421 â†’ 43406]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m((entry[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mreaddir(dir))[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
   597           : [38;5;250m      [39mresult[38;5;241m-[39m[38;5;241m>[39memplace_back(entry[38;5;241m-[39m[38;5;241m>[39md_name);
[91mâ†’  598 [4978 â†’ 4976]:[0m [91m[38;5;250m    [39m}[0m
   599           : [38;5;250m    [39m[38;5;241m:[39m[38;5;241m:[39mclosedir(dir);
   600           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
   601           : [38;5;250m  [39m}
   602           : 
[91mâ†’  603 [4504 â†’ 4506]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mDeleteFile[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   604           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m:[39m[38;5;241m:[39munlink(filename.c_str())[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   605           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mPosixError(filename,[38;5;250m [39merrno);
[91mâ†’  606 [4223 â†’ 4225]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  607 [4504 â†’ 4506]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();[0m
   608           : [38;5;250m  [39m}
   609           : 
   610           : [38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mCreateDir[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mdirname)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   611           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m:[39m[38;5;241m:[39mmkdir(dirname.c_str(),[38;5;250m [39m[38;5;241m0755[39m)[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   612           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mPosixError(dirname,[38;5;250m [39merrno);

........................................

   619           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mPosixError(dirname,[38;5;250m [39merrno);
   620           : [38;5;250m    [39m}
   621           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
   622           : [38;5;250m  [39m}
   623           : 
[91mâ†’  624 [2136 â†’ 2131]:[0m [91m[38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mGetFileSize[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfilename,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;241m*[39m[38;5;250m [39msize)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   625           : [38;5;250m    [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mstat[38;5;250m [39mfile_stat;
   626           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m:[39m[38;5;241m:[39mstat(filename.c_str(),[38;5;250m [39m[38;5;241m&[39mfile_stat)[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   627           : [38;5;250m      [39m[38;5;241m*[39msize[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
   628           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mPosixError(filename,[38;5;250m [39merrno);
[91mâ†’  629 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  630 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m[38;5;241m*[39msize[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mfile_stat.st_size;[0m
[91mâ†’  631 [2136 â†’ 2131]:[0m [91m[38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();[0m
   632           : [38;5;250m  [39m}
   633           : 
   634           : [38;5;250m  [39mStatus[38;5;250m [39m[38;5;21mRenameFile[39m([38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mfrom,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;241m&[39m[38;5;250m [39mto)[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{
   635           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(std[38;5;241m:[39m[38;5;241m:[39mrename(from.c_str(),[38;5;250m [39mto.c_str())[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   636           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mPosixError(from,[38;5;250m [39merrno);

........................................

   716           : [38;5;250m      [39m[38;5;241m*[39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39mPosixLogger(fp);
   717           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mStatus[38;5;241m:[39m[38;5;241m:[39mOK();
   718           : [38;5;250m    [39m}
   719           : [38;5;250m  [39m}
   720           : 
[91mâ†’  721 [4208 â†’ 4200]:[0m [91m[38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39m[38;5;21mNowMicros[39m()[38;5;250m [39m[38;5;28;01moverride[39;00m[38;5;250m [39m{[0m
   722           : [38;5;250m    [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01mconstexpr[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mkUsecondsPerSecond[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1000000[39m;
   723           : [38;5;250m    [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mtimeval[38;5;250m [39mtv;
   724           : [38;5;250m    [39m[38;5;241m:[39m[38;5;241m:[39mgettimeofday([38;5;241m&[39mtv,[38;5;250m [39m[38;5;28;01mnullptr[39;00m);
   725           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m(tv.tv_sec)[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39mkUsecondsPerSecond[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mtv.tv_usec;
   726           : [38;5;250m  [39m}

........................................

   791           : [38;5;250m      [39mmmap_limiter_(MaxMmaps()),
   792           : [38;5;250m      [39mfd_limiter_(MaxOpenFiles())[38;5;250m [39m{}
   793           : 
   794           : [38;5;125mvoid[39m[38;5;250m [39mPosixEnv[38;5;241m:[39m[38;5;241m:[39mSchedule(
   795           : [38;5;250m    [39m[38;5;125mvoid[39m[38;5;250m [39m([38;5;241m*[39mbackground_work_function)([38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mbackground_work_arg),
[91mâ†’  796 [2509 â†’ 2505]:[0m [91m[38;5;250m    [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mbackground_work_arg)[38;5;250m [39m{[0m
   797           : [38;5;250m  [39mbackground_work_mutex_.Lock();
   798           : 
[91mâ†’  799 [2509 â†’ 2505]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Start the background thread, if we haven't done so already.[39;00m[0m
   800           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m([38;5;241m![39mstarted_background_thread_)[38;5;250m [39m{
   801           : [38;5;250m    [39mstarted_background_thread_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28mtrue[39m;
   802           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39m[38;5;28;01mthread[39;00m[38;5;250m [39m[38;5;21mbackground_thread[39m(PosixEnv[38;5;241m:[39m[38;5;241m:[39mBackgroundThreadEntryPoint,[38;5;250m [39m[38;5;28;01mthis[39;00m);
   803           : [38;5;250m    [39mbackground_thread.detach();
[91mâ†’  804 [2509 â†’ 2505]:[0m [91m[38;5;250m  [39m}[0m
   805           : 
[91mâ†’  806 [2509 â†’ 2505]:[0m [91m[38;5;250m  [39m[38;5;66;03m// If the queue is empty, the background thread may be waiting for work.[39;00m[0m
[91mâ†’  807 [2509 â†’ 2505]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(background_work_queue_.empty())[38;5;250m [39m{[0m
   808           : [38;5;250m    [39mbackground_work_cv_.Signal();
[91mâ†’  809 [2509 â†’ 2505]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’  810 [2509 â†’ 2505]:[0m [91m[0m
   811           : [38;5;250m  [39mbackground_work_queue_.emplace(background_work_function,[38;5;250m [39mbackground_work_arg);
   812           : [38;5;250m  [39mbackground_work_mutex_.Unlock();
   813           : }
   814           : 
   815           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mPosixEnv::BackgroundThreadMain[39m()[38;5;250m [39m{
[91mâ†’  816 [2510 â†’ 2506]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;28mtrue[39m)[38;5;250m [39m{[0m
   817           : [38;5;250m    [39mbackground_work_mutex_.Lock();
   818           : 
[91mâ†’  819 [2510 â†’ 2506]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Wait until there is work to be done.[39;00m[0m
[91mâ†’  820 [2339 â†’ 2347]:[0m [91m[38;5;250m    [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(background_work_queue_.empty())[38;5;250m [39m{[0m
   821           : [38;5;250m      [39mbackground_work_cv_.Wait();
[91mâ†’  822 [2510 â†’ 2506]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’  823 [2510 â†’ 2506]:[0m [91m[0m
[91mâ†’  824 [2509 â†’ 2505]:[0m [91m[38;5;250m    [39massert([38;5;241m![39mbackground_work_queue_.empty());[0m
[91mâ†’  825 [2509 â†’ 2505]:[0m [91m[38;5;250m    [39m[38;5;28;01mauto[39;00m[38;5;250m [39mbackground_work_function[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbackground_work_queue_.front().function;[0m
   826           : [38;5;250m    [39m[38;5;125mvoid[39m[38;5;241m*[39m[38;5;250m [39mbackground_work_arg[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbackground_work_queue_.front().arg;
   827           : [38;5;250m    [39mbackground_work_queue_.pop();
[91mâ†’  828 [2509 â†’ 2505]:[0m [91m[0m
   829           : [38;5;250m    [39mbackground_work_mutex_.Unlock();
   830           : [38;5;250m    [39mbackground_work_function(background_work_arg);
   831           : [38;5;250m  [39m}
   832           : }
   833           : 

........................................

   896           : [38;5;125mvoid[39m[38;5;250m [39m[38;5;21mEnvPosixTestHelper::SetReadOnlyMMapLimit[39m([38;5;125mint[39m[38;5;250m [39mlimit)[38;5;250m [39m{
   897           : [38;5;250m  [39mPosixDefaultEnv[38;5;241m:[39m[38;5;241m:[39mAssertEnvNotInitialized();
   898           : [38;5;250m  [39mg_mmap_limit[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlimit;
   899           : }
   900           : 
[91mâ†’  901 [3971 â†’ 3966]:[0m [91mEnv[38;5;241m*[39m[38;5;250m [39m[38;5;21mEnv::Default[39m()[38;5;250m [39m{[0m
   902           : [38;5;250m  [39m[38;5;28;01mstatic[39;00m[38;5;250m [39mPosixDefaultEnv[38;5;250m [39menv_container;
   903           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39menv_container.env();
   904           : }
   905           : 
   906           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/hash.cc ===
Lines with coverage differences:

Lines with different hit counts: 16, 22, 23, 29, 30, 36, 38, 40, 42, 43, 45, 46, 50, 52

Detailed differences with context:
============================================================
    11           : [38;5;66;03m// The FALLTHROUGH_INTENDED macro can be used to annotate implicit fall-through[39;00m
    12           : [38;5;66;03m// between switch labels. The real definition should be provided externally.[39;00m
    13           : [38;5;66;03m// This one is a fallback version for unsupported compilers.[39;00m
    14           : [38;5;130m#[39m[38;5;130mifndef FALLTHROUGH_INTENDED[39m
    15           : [38;5;130m#[39m[38;5;130mdefine FALLTHROUGH_INTENDED \[39m
[91mâ†’   16 [485 â†’ 484]:[0m [91m[38;5;250m  [39m[38;5;28;01mdo[39;00m[38;5;250m [39m{[38;5;250m                       [39m\[0m
    17           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m([38;5;241m0[39m)
    18           : [38;5;130m#[39m[38;5;130mendif[39m
    19           : 
    20           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
    21           : 
[91mâ†’   22 [12574 â†’ 12536]:[0m [91m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mHash[39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mdata,[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mn,[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mseed)[38;5;250m [39m{[0m
[91mâ†’   23 [12574 â†’ 12536]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Similar to murmur hash[39;00m[0m
    24           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mm[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0xc6a4a793[39m;
    25           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mr[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m24[39m;
    26           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mlimit[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdata[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mn;
    27           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mh[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mseed[38;5;250m [39m[38;5;241m^[39m[38;5;250m [39m(n[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39mm);
    28           : 
[91mâ†’   29 [12574 â†’ 12536]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Pick up four bytes at a time[39;00m[0m
[91mâ†’   30 [24874 â†’ 24826]:[0m [91m[38;5;250m  [39m[38;5;28;01mwhile[39;00m[38;5;250m [39m(data[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m4[39m[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39mlimit)[38;5;250m [39m{[0m
    31           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mw[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mDecodeFixed32(data);
    32           : [38;5;250m    [39mdata[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m4[39m;
    33           : [38;5;250m    [39mh[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39mw;
    34           : [38;5;250m    [39mh[38;5;250m [39m[38;5;241m*[39m[38;5;241m=[39m[38;5;250m [39mm;
    35           : [38;5;250m    [39mh[38;5;250m [39m[38;5;241m^[39m[38;5;241m=[39m[38;5;250m [39m(h[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m16[39m);
[91mâ†’   36 [12574 â†’ 12536]:[0m [91m[38;5;250m  [39m}[0m
    37           : 
[91mâ†’   38 [12574 â†’ 12536]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Pick up remaining bytes[39;00m[0m
    39           : [38;5;250m  [39m[38;5;28;01mswitch[39;00m[38;5;250m [39m(limit[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mdata)[38;5;250m [39m{
[91mâ†’   40 [ 92 â†’  93]:[0m [91m[38;5;250m    [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;241m3[39m:[0m
    41           : [38;5;250m      [39mh[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(data[[38;5;241m2[39m])[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m16[39m;
[91mâ†’   42 [ 92 â†’  93]:[0m [91m[38;5;250m      [39mFALLTHROUGH_INTENDED;[0m
[91mâ†’   43 [393 â†’ 391]:[0m [91m[38;5;250m    [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;241m2[39m:[0m
    44           : [38;5;250m      [39mh[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(data[[38;5;241m1[39m])[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m8[39m;
[91mâ†’   45 [393 â†’ 391]:[0m [91m[38;5;250m      [39mFALLTHROUGH_INTENDED;[0m
[91mâ†’   46 [1241 â†’ 1235]:[0m [91m[38;5;250m    [39m[38;5;28;01mcase[39;00m[38;5;250m [39m[38;5;241m1[39m:[0m
    47           : [38;5;250m      [39mh[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint8_t[39m[38;5;241m>[39m(data[[38;5;241m0[39m]);
    48           : [38;5;250m      [39mh[38;5;250m [39m[38;5;241m*[39m[38;5;241m=[39m[38;5;250m [39mm;
    49           : [38;5;250m      [39mh[38;5;250m [39m[38;5;241m^[39m[38;5;241m=[39m[38;5;250m [39m(h[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39mr);
[91mâ†’   50 [12574 â†’ 12536]:[0m [91m[38;5;250m      [39m[38;5;28;01mbreak[39;00m;[0m
    51           : [38;5;250m  [39m}
[91mâ†’   52 [12574 â†’ 12536]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mh;[0m
    53           : }
    54           : 
    55           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/logging.cc ===
Lines with coverage differences:

Lines with different hit counts: 51, 52, 56, 59, 61, 64, 66, 69, 70, 73, 74, 75, 76, 77, 78, 81

Detailed differences with context:
============================================================
    46           : [38;5;250m  [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mr;
    47           : [38;5;250m  [39mAppendEscapedStringTo([38;5;241m&[39mr,[38;5;250m [39mvalue);
    48           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mr;
    49           : }
    50           : 
[91mâ†’   51 [26764 â†’ 26754]:[0m [91m[38;5;125mbool[39m[38;5;250m [39m[38;5;21mConsumeDecimalNumber[39m(Slice[38;5;241m*[39m[38;5;250m [39min,[38;5;250m [39m[38;5;125muint64_t[39m[38;5;241m*[39m[38;5;250m [39mval)[38;5;250m [39m{[0m
[91mâ†’   52 [26764 â†’ 26754]:[0m [91m[38;5;250m  [39m[38;5;66;03m// Constants that will be optimized away.[39;00m[0m
    53           : [38;5;250m  [39m[38;5;28;01mconstexpr[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mkMaxUint64[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mnumeric_limits[38;5;241m<[39m[38;5;125muint64_t[39m[38;5;241m>[39m[38;5;241m:[39m[38;5;241m:[39mmax();
    54           : [38;5;250m  [39m[38;5;28;01mconstexpr[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;250m [39mkLastDigitOfMaxUint64[38;5;250m [39m[38;5;241m=[39m
    55           : [38;5;250m      [39m[38;5;124m'[39m[38;5;124m0[39m[38;5;124m'[39m[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mchar[39m[38;5;241m>[39m(kMaxUint64[38;5;250m [39m[38;5;241m%[39m[38;5;250m [39m[38;5;241m10[39m);
[91mâ†’   56 [26764 â†’ 26754]:[0m [91m[0m
    57           : [38;5;250m  [39m[38;5;125muint64_t[39m[38;5;250m [39mvalue[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;
    58           : 
[91mâ†’   59 [26764 â†’ 26754]:[0m [91m[38;5;250m  [39m[38;5;66;03m// reinterpret_cast-ing from char* to uint8_t* to avoid signedness.[39;00m[0m
    60           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39mstart[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mreinterpret_cast[39;00m[38;5;241m<[39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;241m>[39m(in[38;5;241m-[39m[38;5;241m>[39mdata());
[91mâ†’   61 [26764 â†’ 26754]:[0m [91m[0m
    62           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39mend[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstart[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39min[38;5;241m-[39m[38;5;241m>[39msize();
    63           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;241m*[39m[38;5;250m [39mcurrent[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstart;
[91mâ†’   64 [120781 â†’ 120737]:[0m [91m[38;5;250m  [39m[38;5;28;01mfor[39;00m[38;5;250m [39m(;[38;5;250m [39mcurrent[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mend;[38;5;250m [39m[38;5;241m+[39m[38;5;241m+[39mcurrent)[38;5;250m [39m{[0m
    65           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint8_t[39m[38;5;250m [39mch[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m*[39mcurrent;
[91mâ†’   66 [100831 â†’ 100795]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(ch[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;124m'[39m[38;5;124m0[39m[38;5;124m'[39m[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39mch[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39m[38;5;124m'[39m[38;5;124m9[39m[38;5;124m'[39m)[38;5;250m [39m[38;5;28;01mbreak[39;00m;[0m
    67           : 
    68           : [38;5;250m    [39m[38;5;66;03m// Overflow check.[39;00m
[91mâ†’   69 [100831 â†’ 100795]:[0m [91m[38;5;250m    [39m[38;5;66;03m// kMaxUint64 / 10 is also constant and will be optimized away.[39;00m[0m
[91mâ†’   70 [100831 â†’ 100795]:[0m [91m[38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(value[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mkMaxUint64[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39m[38;5;241m10[39m[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[0m
    71           : [38;5;250m        [39m(value[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mkMaxUint64[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39m[38;5;241m10[39m[38;5;250m [39m[38;5;241m&[39m[38;5;241m&[39m[38;5;250m [39mch[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mkLastDigitOfMaxUint64))[38;5;250m [39m{
    72           : [38;5;250m      [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;28mfalse[39m;
[91mâ†’   73 [100831 â†’ 100795]:[0m [91m[38;5;250m    [39m}[0m
[91mâ†’   74 [100831 â†’ 100795]:[0m [91m[0m
[91mâ†’   75 [100831 â†’ 100795]:[0m [91m[38;5;250m    [39mvalue[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m(value[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;241m10[39m)[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m(ch[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;124m'[39m[38;5;124m0[39m[38;5;124m'[39m);[0m
[91mâ†’   76 [26764 â†’ 26754]:[0m [91m[38;5;250m  [39m}[0m
[91mâ†’   77 [26764 â†’ 26754]:[0m [91m[0m
[91mâ†’   78 [26764 â†’ 26754]:[0m [91m[38;5;250m  [39m[38;5;241m*[39mval[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mvalue;[0m
    79           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125msize_t[39m[38;5;250m [39mdigits_consumed[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mcurrent[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mstart;
    80           : [38;5;250m  [39min[38;5;241m-[39m[38;5;241m>[39mremove_prefix(digits_consumed);
[91mâ†’   81 [26764 â†’ 26754]:[0m [91m[38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mdigits_consumed[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[0m
    82           : }
    83           : 
    84           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/mutexlock.h ===
Lines with coverage differences:

Lines with different hit counts: 25

Detailed differences with context:
============================================================
    20           : [38;5;66;03m//     ... some complex code, possibly with multiple return paths ...[39;00m
    21           : [38;5;66;03m//   }[39;00m
    22           : 
    23           : class[38;5;250m [39mSCOPED_LOCKABLE[38;5;250m [39mMutexLock[38;5;250m [39m{
    24           : [38;5;250m [39mpublic[38;5;241m:[39m
[91mâ†’   25 [36547 â†’ 36514]:[0m [91m[38;5;250m  [39mexplicit[38;5;250m [39m[38;5;21mMutexLock[39m(port[38;5;241m:[39m[38;5;241m:[39mMutex[38;5;241m*[39m[38;5;250m [39mmu)[38;5;250m [39mEXCLUSIVE_LOCK_FUNCTION(mu)[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mmu_(mu)[38;5;250m [39m{[0m
    26           : [38;5;250m    [39mthis[38;5;241m-[39m[38;5;241m>[39mmu_[38;5;241m-[39m[38;5;241m>[39mLock();
    27           : [38;5;250m  [39m}
    28           : [38;5;250m  [39m[38;5;241m~[39mMutexLock()[38;5;250m [39mUNLOCK_FUNCTION()[38;5;250m [39m{[38;5;250m [39mthis[38;5;241m-[39m[38;5;241m>[39mmu_[38;5;241m-[39m[38;5;241m>[39mUnlock();[38;5;250m [39m}
    29           : 
    30           : [38;5;250m  [39mMutexLock([38;5;28;01mconst[39;00m[38;5;250m [39mMutexLock[38;5;241m&[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdelete;

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/no_destructor.h ===
Lines with coverage differences:

Lines with different hit counts: 35

Detailed differences with context:
============================================================
    30           : [38;5;250m  [39m[38;5;241m~[39mNoDestructor()[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mdefault[39;00m;
    31           : 
    32           : [38;5;250m  [39mNoDestructor([38;5;28;01mconst[39;00m[38;5;250m [39mNoDestructor[38;5;241m&[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdelete;
    33           : [38;5;250m  [39mNoDestructor[38;5;241m&[39m[38;5;250m [39moperator[38;5;241m=[39m([38;5;28;01mconst[39;00m[38;5;250m [39mNoDestructor[38;5;241m&[39m)[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mdelete;
    34           : 
[91mâ†’   35 [6107 â†’ 6097]:[0m [91m[38;5;250m  [39mInstanceType[38;5;241m*[39m[38;5;250m [39m[38;5;21mget[39m()[38;5;250m [39m{[0m
    36           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mreinterpret_cast[38;5;241m<[39mInstanceType[38;5;241m*[39m[38;5;241m>[39m([38;5;241m&[39minstance_storage_);
    37           : [38;5;250m  [39m}
    38           : 
    39           : [38;5;250m [39mprivate[38;5;241m:[39m
    40           : [38;5;250m  [39mtypename[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39maligned_storage[38;5;241m<[39m[38;5;28;01msizeof[39;00m(InstanceType),

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/posix_logger.h ===
Lines with coverage differences:

Lines with different hit counts: 33, 34, 41, 48, 51, 56, 58, 60, 62, 64, 74, 76, 78, 80, 81, 89, 105, 107, 108, 111, 112, 114, 116, 119

Detailed differences with context:
============================================================
    28           : [38;5;250m  [39m[38;5;66;03m// The PosixLogger instance takes ownership of the file handle.[39;00m
    29           : [38;5;250m  [39mexplicit[38;5;250m [39m[38;5;21mPosixLogger[39m(std[38;5;241m:[39m[38;5;241m:[39m[38;5;125mFILE[39m[38;5;241m*[39m[38;5;250m [39mfp)[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mfp_(fp)[38;5;250m [39m{[38;5;250m [39massert(fp[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mnullptr);[38;5;250m [39m}
    30           : 
    31           : [38;5;250m  [39m[38;5;241m~[39mPosixLogger()[38;5;250m [39moverride[38;5;250m [39m{[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mfclose(fp_);[38;5;250m [39m}
    32           : 
[91mâ†’   33 [11210 â†’ 11204]:[0m [91m[38;5;250m  [39m[38;5;125mvoid[39m[38;5;250m [39m[38;5;21mLogv[39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mformat,[38;5;250m [39m[38;5;125mva_list[39m[38;5;250m [39marguments)[38;5;250m [39moverride[38;5;250m [39m{[0m
[91mâ†’   34 [11210 â†’ 11204]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Record the time as close to the Logv() call as possible.[39;00m[0m
    35           : [38;5;250m    [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;241m:[39m[38;5;241m:[39mtimeval[38;5;250m [39mnow_timeval;
    36           : [38;5;250m    [39m[38;5;241m:[39m[38;5;241m:[39mgettimeofday([38;5;241m&[39mnow_timeval,[38;5;250m [39mnullptr);
    37           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39m[38;5;125mtime_t[39m[38;5;250m [39mnow_seconds[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mnow_timeval.tv_sec;
    38           : [38;5;250m    [39m[38;5;28;01mstruct[39;00m[38;5;250m [39m[38;5;21;01mstd[39;00m[38;5;241m:[39m[38;5;241m:[39mtm[38;5;250m [39mnow_components;
    39           : [38;5;250m    [39m[38;5;241m:[39m[38;5;241m:[39mlocaltime_r([38;5;241m&[39mnow_seconds,[38;5;250m [39m[38;5;241m&[39mnow_components);
    40           : 
[91mâ†’   41 [11210 â†’ 11204]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Record the thread ID.[39;00m[0m
    42           : [38;5;250m    [39mconstexpr[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mkMaxThreadIdSize[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m32[39m;
    43           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mostringstream[38;5;250m [39mthread_stream;
    44           : [38;5;250m    [39mthread_stream[38;5;250m [39m[38;5;241m<[39m[38;5;241m<[39m[38;5;250m [39mstd[38;5;241m:[39m[38;5;241m:[39mthis_thread[38;5;241m:[39m[38;5;241m:[39mget_id();
    45           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39mthread_id[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mthread_stream.str();
    46           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(thread_id.size()[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mkMaxThreadIdSize)[38;5;250m [39m{
    47           : [38;5;250m      [39mthread_id.resize(kMaxThreadIdSize);
[91mâ†’   48 [11210 â†’ 11204]:[0m [91m[38;5;250m    [39m}[0m
    49           : 
    50           : [38;5;250m    [39m[38;5;66;03m// We first attempt to print into a stack-allocated buffer. If this attempt[39;00m
[91mâ†’   51 [11210 â†’ 11204]:[0m [91m[38;5;250m    [39m[38;5;66;03m// fails, we make a second attempt with a dynamically allocated buffer.[39;00m[0m
    52           : [38;5;250m    [39mconstexpr[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mkStackBufferSize[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m512[39m;
    53           : [38;5;250m    [39m[38;5;125mchar[39m[38;5;250m [39mstack_buffer[kStackBufferSize];
    54           : [38;5;250m    [39m[38;5;28;01mstatic_assert[39;00m([38;5;28;01msizeof[39;00m(stack_buffer)[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125msize_t[39m[38;5;241m>[39m(kStackBufferSize),
    55           : [38;5;250m                  [39m[38;5;124m"[39m[38;5;124msizeof(char) is expected to be 1 in C++[39m[38;5;124m"[39m);
[91mâ†’   56 [11210 â†’ 11204]:[0m [91m[0m
    57           : [38;5;250m    [39m[38;5;125mint[39m[38;5;250m [39mdynamic_buffer_size[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m  [39m[38;5;66;03m// Computed in the first iteration.[39;00m
[91mâ†’   58 [11210 â†’ 11204]:[0m [91m[38;5;250m    [39m[38;5;28;01mfor[39;00m[38;5;250m [39m([38;5;125mint[39m[38;5;250m [39miteration[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m;[38;5;250m [39miteration[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39m[38;5;241m2[39m;[38;5;250m [39m[38;5;241m+[39m[38;5;241m+[39miteration)[38;5;250m [39m{[0m
    59           : [38;5;250m      [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mint[39m[38;5;250m [39mbuffer_size[38;5;250m [39m[38;5;241m=[39m
[91mâ†’   60 [11210 â†’ 11204]:[0m [91m[38;5;250m          [39m(iteration[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39mkStackBufferSize[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mdynamic_buffer_size;[0m
    61           : [38;5;250m      [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mbuffer[38;5;250m [39m[38;5;241m=[39m
[91mâ†’   62 [11210 â†’ 11204]:[0m [91m[38;5;250m          [39m(iteration[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39mstack_buffer[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mnew[38;5;250m [39m[38;5;125mchar[39m[dynamic_buffer_size];[0m
    63           : 
[91mâ†’   64 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Print the header into the buffer.[39;00m[0m
    65           : [38;5;250m      [39m[38;5;125mint[39m[38;5;250m [39mbuffer_offset[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39msnprintf(
    66           : [38;5;250m          [39mbuffer,[38;5;250m [39mbuffer_size,[38;5;250m [39m[38;5;124m"[39m[38;5;124m%04d/%02d/%02d-%02d:%02d:%02d.%06d %s [39m[38;5;124m"[39m,
    67           : [38;5;250m          [39mnow_components.tm_year[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1900[39m,[38;5;250m [39mnow_components.tm_mon[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m,
    68           : [38;5;250m          [39mnow_components.tm_mday,[38;5;250m [39mnow_components.tm_hour,[38;5;250m [39mnow_components.tm_min,
    69           : [38;5;250m          [39mnow_components.tm_sec,[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125mint[39m[38;5;241m>[39m(now_timeval.tv_usec),
    70           : [38;5;250m          [39mthread_id.c_str());
    71           : 
    72           : [38;5;250m      [39m[38;5;66;03m// The header can be at most 28 characters (10 date + 15 time +[39;00m
    73           : [38;5;250m      [39m[38;5;66;03m// 3 delimiters) plus the thread ID, which should fit comfortably into the[39;00m
[91mâ†’   74 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39m[38;5;66;03m// static buffer.[39;00m[0m
    75           : [38;5;250m      [39massert(buffer_offset[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m28[39m[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkMaxThreadIdSize);
[91mâ†’   76 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39m[38;5;28;01mstatic_assert[39;00m([38;5;241m28[39m[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mkMaxThreadIdSize[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mkStackBufferSize,[0m
    77           : [38;5;250m                    [39m[38;5;124m"[39m[38;5;124mstack-allocated buffer may not fit the message header[39m[38;5;124m"[39m);
[91mâ†’   78 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39massert(buffer_offset[38;5;250m [39m[38;5;241m<[39m[38;5;250m [39mbuffer_size);[0m
    79           : 
[91mâ†’   80 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Print the message into the buffer.[39;00m[0m
[91mâ†’   81 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39m[38;5;125mva_list[39m[38;5;250m [39marguments_copy;[0m
    82           : [38;5;250m      [39mva_copy(arguments_copy,[38;5;250m [39marguments);
    83           : [38;5;250m      [39mbuffer_offset[38;5;250m [39m[38;5;241m+[39m[38;5;241m=[39m
    84           : [38;5;250m          [39mstd[38;5;241m:[39m[38;5;241m:[39mvsnprintf(buffer[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mbuffer_offset,[38;5;250m [39mbuffer_size[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39mbuffer_offset,
    85           : [38;5;250m                         [39mformat,[38;5;250m [39marguments_copy);
    86           : [38;5;250m      [39mva_end(arguments_copy);
    87           : 
    88           : [38;5;250m      [39m[38;5;66;03m// The code below may append a newline at the end of the buffer, which[39;00m
[91mâ†’   89 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39m[38;5;66;03m// requires an extra character.[39;00m[0m
    90           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(buffer_offset[38;5;250m [39m[38;5;241m>[39m[38;5;241m=[39m[38;5;250m [39mbuffer_size[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m)[38;5;250m [39m{
    91           : [38;5;250m        [39m[38;5;66;03m// The message did not fit into the buffer.[39;00m
    92           : [38;5;250m        [39m[38;5;28;01mif[39;00m[38;5;250m [39m(iteration[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
    93           : [38;5;250m          [39m[38;5;66;03m// Re-run the loop and use a dynamically-allocated buffer. The buffer[39;00m
    94           : [38;5;250m          [39m[38;5;66;03m// will be large enough for the log message, an extra newline and a[39;00m

........................................

   100           : [38;5;250m        [39m[38;5;66;03m// The dynamically-allocated buffer was incorrectly sized. This should[39;00m
   101           : [38;5;250m        [39m[38;5;66;03m// not happen, assuming a correct implementation of (v)snprintf. Fail[39;00m
   102           : [38;5;250m        [39m[38;5;66;03m// in tests, recover by truncating the log message in production.[39;00m
   103           : [38;5;250m        [39massert([38;5;28mfalse[39m);
   104           : [38;5;250m        [39mbuffer_offset[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mbuffer_size[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m;
[91mâ†’  105 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39m}[0m
   106           : 
[91mâ†’  107 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39m[38;5;66;03m// Add a newline if necessary.[39;00m[0m
[91mâ†’  108 [5588 â†’ 5582]:[0m [91m[38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(buffer[buffer_offset[38;5;250m [39m[38;5;241m-[39m[38;5;250m [39m[38;5;241m1[39m][38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m'[39m[38;5;124m\n[39m[38;5;124m'[39m)[38;5;250m [39m{[0m
   109           : [38;5;250m        [39mbuffer[buffer_offset][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m'[39m[38;5;124m\n[39m[38;5;124m'[39m;
   110           : [38;5;250m        [39m[38;5;241m+[39m[38;5;241m+[39mbuffer_offset;
[91mâ†’  111 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39m}[0m
[91mâ†’  112 [11210 â†’ 11204]:[0m [91m[0m
   113           : [38;5;250m      [39massert(buffer_offset[38;5;250m [39m[38;5;241m<[39m[38;5;241m=[39m[38;5;250m [39mbuffer_size);
[91mâ†’  114 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mfwrite(buffer,[38;5;250m [39m[38;5;241m1[39m,[38;5;250m [39mbuffer_offset,[38;5;250m [39mfp_);[0m
   115           : [38;5;250m      [39mstd[38;5;241m:[39m[38;5;241m:[39mfflush(fp_);
[91mâ†’  116 [11210 â†’ 11204]:[0m [91m[0m
   117           : [38;5;250m      [39m[38;5;28;01mif[39;00m[38;5;250m [39m(iteration[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m)[38;5;250m [39m{
   118           : [38;5;250m        [39mdelete[][38;5;250m [39mbuffer;
[91mâ†’  119 [11210 â†’ 11204]:[0m [91m[38;5;250m      [39m}[0m
   120           : [38;5;250m      [39m[38;5;28;01mbreak[39;00m;
   121           : [38;5;250m    [39m}
   122           : [38;5;250m  [39m}
   123           : 
   124           : [38;5;250m [39mprivate[38;5;241m:[39m

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/random.h ===
Lines with coverage differences:

Lines with different hit counts: 20, 21, 24, 26, 34, 37, 41, 44

Detailed differences with context:
============================================================
    15           : class[38;5;250m [39mRandom[38;5;250m [39m{
    16           : [38;5;250m [39mprivate[38;5;241m:[39m
    17           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39mseed_;
    18           : 
    19           : [38;5;250m [39mpublic[38;5;241m:[39m
[91mâ†’   20 [5802 â†’ 5804]:[0m [91m[38;5;250m  [39mexplicit[38;5;250m [39m[38;5;21mRandom[39m([38;5;125muint32_t[39m[38;5;250m [39ms)[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39mseed_(s[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39m[38;5;241m0x7fffffffu[39m)[38;5;250m [39m{[0m
[91mâ†’   21 [5802 â†’ 5804]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Avoid bad seeds.[39;00m[0m
    22           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(seed_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m0[39m[38;5;250m [39m[38;5;241m|[39m[38;5;241m|[39m[38;5;250m [39mseed_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m2147483647L[39m)[38;5;250m [39m{
    23           : [38;5;250m      [39mseed_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m1[39m;
[91mâ†’   24 [5802 â†’ 5804]:[0m [91m[38;5;250m    [39m}[0m
    25           : [38;5;250m  [39m}
[91mâ†’   26 [17562 â†’ 17566]:[0m [91m[38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mNext[39m()[38;5;250m [39m{[0m
    27           : [38;5;250m    [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mM[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m2147483647L[39m;[38;5;250m  [39m[38;5;66;03m// 2^31-1[39;00m
    28           : [38;5;250m    [39m[38;5;28;01mstatic[39;00m[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint64_t[39m[38;5;250m [39mA[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;241m16807[39m;[38;5;250m        [39m[38;5;66;03m// bits 14, 8, 7, 5, 2, 1, 0[39;00m
    29           : [38;5;250m    [39m[38;5;66;03m// We are computing[39;00m
    30           : [38;5;250m    [39m[38;5;66;03m//       seed_ = (seed_ * A) % M,    where M = 2^31-1[39;00m
    31           : [38;5;250m    [39m[38;5;66;03m//[39;00m
    32           : [38;5;250m    [39m[38;5;66;03m// seed_ must not be zero or M, or else all subsequent computed values[39;00m
    33           : [38;5;250m    [39m[38;5;66;03m// will be zero or M respectively.  For all other values, seed_ will end[39;00m
[91mâ†’   34 [17562 â†’ 17566]:[0m [91m[38;5;250m    [39m[38;5;66;03m// up cycling through every number in [1,M-1][39;00m[0m
    35           : [38;5;250m    [39m[38;5;125muint64_t[39m[38;5;250m [39mproduct[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mseed_[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39mA;
    36           : 
[91mâ†’   37 [17562 â†’ 17566]:[0m [91m[38;5;250m    [39m[38;5;66;03m// Compute (product % M) using the fact that ((x << 31) % M) == x.[39;00m[0m
    38           : [38;5;250m    [39mseed_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mstatic_cast[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m((product[38;5;250m [39m[38;5;241m>[39m[38;5;241m>[39m[38;5;250m [39m[38;5;241m31[39m)[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m(product[38;5;250m [39m[38;5;241m&[39m[38;5;250m [39mM));
    39           : [38;5;250m    [39m[38;5;66;03m// The first reduction may overflow by 1 bit, so we may need to[39;00m
    40           : [38;5;250m    [39m[38;5;66;03m// repeat.  mod == M is not possible; using > allows the faster[39;00m
[91mâ†’   41 [17562 â†’ 17566]:[0m [91m[38;5;250m    [39m[38;5;66;03m// sign-bit-based test.[39;00m[0m
    42           : [38;5;250m    [39m[38;5;28;01mif[39;00m[38;5;250m [39m(seed_[38;5;250m [39m[38;5;241m>[39m[38;5;250m [39mM)[38;5;250m [39m{
    43           : [38;5;250m      [39mseed_[38;5;250m [39m[38;5;241m-[39m[38;5;241m=[39m[38;5;250m [39mM;
[91mâ†’   44 [17562 â†’ 17566]:[0m [91m[38;5;250m    [39m}[0m
    45           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mseed_;
    46           : [38;5;250m  [39m}
    47           : [38;5;250m  [39m[38;5;66;03m// Returns a uniformly distributed value in the range [0..n-1][39;00m
    48           : [38;5;250m  [39m[38;5;66;03m// REQUIRES: n > 0[39;00m
    49           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39m[38;5;21mUniform[39m([38;5;125mint[39m[38;5;250m [39mn)[38;5;250m [39m{[38;5;250m [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mNext()[38;5;250m [39m[38;5;241m%[39m[38;5;250m [39mn;[38;5;250m [39m}

=== File: /root/leveldb-fuzzing/leveldb-subtree/util/status.cc ===
Lines with coverage differences:

Lines with different hit counts: 13, 21, 22, 23, 25, 34, 38, 39, 74

Detailed differences with context:
============================================================
     8           : 
     9           : [38;5;130m#[39m[38;5;130minclude[39m[38;5;250m [39m[38;5;66;03m"port/port.h"[39;00m
    10           : 
    11           : [38;5;28;01mnamespace[39;00m[38;5;250m [39m[38;5;21;01mleveldb[39;00m[38;5;250m [39m{
    12           : 
[91mâ†’   13 [136 â†’ 132]:[0m [91m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39m[38;5;21mStatus::CopyState[39m([38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mstate)[38;5;250m [39m{[0m
    14           : [38;5;250m  [39m[38;5;125muint32_t[39m[38;5;250m [39msize;
    15           : [38;5;250m  [39mmemcpy([38;5;241m&[39msize,[38;5;250m [39mstate,[38;5;250m [39m[38;5;28;01msizeof[39;00m(size));
    16           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39m[38;5;125mchar[39m[size[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m5[39m];
    17           : [38;5;250m  [39mmemcpy(result,[38;5;250m [39mstate,[38;5;250m [39msize[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m5[39m);
    18           : [38;5;250m  [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;
    19           : }
    20           : 
[91mâ†’   21 [4267 â†’ 4263]:[0m [91mStatus[38;5;241m:[39m[38;5;241m:[39mStatus(Code[38;5;250m [39mcode,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mmsg,[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39mSlice[38;5;241m&[39m[38;5;250m [39mmsg2)[38;5;250m [39m{[0m
[91mâ†’   22 [4267 â†’ 4263]:[0m [91m[38;5;250m  [39massert(code[38;5;250m [39m[38;5;241m![39m[38;5;241m=[39m[38;5;250m [39mkOk);[0m
[91mâ†’   23 [4267 â†’ 4263]:[0m [91m[38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mlen1[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m(msg.size());[0m
    24           : [38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39mlen2[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125muint32_t[39m[38;5;241m>[39m(msg2.size());
[91mâ†’   25 [4267 â†’ 4263]:[0m [91m[38;5;250m  [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125muint32_t[39m[38;5;250m [39msize[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mlen1[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m(len2[38;5;250m [39m[38;5;241m?[39m[38;5;250m [39m([38;5;241m2[39m[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mlen2)[38;5;250m [39m[38;5;241m:[39m[38;5;250m [39m[38;5;241m0[39m);[0m
    26           : [38;5;250m  [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mresult[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnew[39;00m[38;5;250m [39m[38;5;125mchar[39m[size[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m5[39m];
    27           : [38;5;250m  [39mmemcpy(result,[38;5;250m [39m[38;5;241m&[39msize,[38;5;250m [39m[38;5;28;01msizeof[39;00m(size));
    28           : [38;5;250m  [39mresult[[38;5;241m4[39m][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mstatic_cast[39;00m[38;5;241m<[39m[38;5;125mchar[39m[38;5;241m>[39m(code);
    29           : [38;5;250m  [39mmemcpy(result[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m5[39m,[38;5;250m [39mmsg.data(),[38;5;250m [39mlen1);
    30           : [38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(len2)[38;5;250m [39m{
    31           : [38;5;250m    [39mresult[[38;5;241m5[39m[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mlen1][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m'[39m[38;5;124m:[39m[38;5;124m'[39m;
    32           : [38;5;250m    [39mresult[[38;5;241m6[39m[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mlen1][38;5;250m [39m[38;5;241m=[39m[38;5;250m [39m[38;5;124m'[39m[38;5;124m [39m[38;5;124m'[39m;
    33           : [38;5;250m    [39mmemcpy(result[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m7[39m[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39mlen1,[38;5;250m [39mmsg2.data(),[38;5;250m [39mlen2);
[91mâ†’   34 [4267 â†’ 4263]:[0m [91m[38;5;250m  [39m}[0m
    35           : [38;5;250m  [39mstate_[38;5;250m [39m[38;5;241m=[39m[38;5;250m [39mresult;
    36           : }
    37           : 
[91mâ†’   38 [1757 â†’ 1756]:[0m [91mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mStatus::ToString[39m()[38;5;250m [39m[38;5;28;01mconst[39;00m[38;5;250m [39m{[0m
[91mâ†’   39 [1757 â†’ 1756]:[0m [91m[38;5;250m  [39m[38;5;28;01mif[39;00m[38;5;250m [39m(state_[38;5;250m [39m[38;5;241m=[39m[38;5;241m=[39m[38;5;250m [39m[38;5;28;01mnullptr[39;00m)[38;5;250m [39m{[0m
    40           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39m[38;5;124m"[39m[38;5;124mOK[39m[38;5;124m"[39m;
    41           : [38;5;250m  [39m}[38;5;250m [39m[38;5;28;01melse[39;00m[38;5;250m [39m{
    42           : [38;5;250m    [39m[38;5;125mchar[39m[38;5;250m [39mtmp[[38;5;241m30[39m];
    43           : [38;5;250m    [39m[38;5;28;01mconst[39;00m[38;5;250m [39m[38;5;125mchar[39m[38;5;241m*[39m[38;5;250m [39mtype;
    44           : [38;5;250m    [39m[38;5;28;01mswitch[39;00m[38;5;250m [39m(code())[38;5;250m [39m{

........................................

    69           : [38;5;250m    [39mstd[38;5;241m:[39m[38;5;241m:[39mstring[38;5;250m [39m[38;5;21mresult[39m(type);
    70           : [38;5;250m    [39m[38;5;125muint32_t[39m[38;5;250m [39mlength;
    71           : [38;5;250m    [39mmemcpy([38;5;241m&[39mlength,[38;5;250m [39mstate_,[38;5;250m [39m[38;5;28;01msizeof[39;00m(length));
    72           : [38;5;250m    [39mresult.append(state_[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m5[39m,[38;5;250m [39mlength);
    73           : [38;5;250m    [39m[38;5;28;01mreturn[39;00m[38;5;250m [39mresult;
[91mâ†’   74 [1757 â†’ 1756]:[0m [91m[38;5;250m  [39m}[0m
    75           : }
    76           : 
    77           : }[38;5;250m  [39m[38;5;66;03m// namespace leveldb[39;00m
